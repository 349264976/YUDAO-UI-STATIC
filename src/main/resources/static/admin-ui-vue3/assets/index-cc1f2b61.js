import{d as ke,u as Ce,r as b,f as q,af as De,A as Ne,O as Te,o as s,c as v,i as t,w as r,a as u,F as k,k as D,q as f,B as U,a3 as xe,j as p,t as m,g as S,a1 as L,M as Se,C as Ve,D as Ee,G as Ae,T as Ue,_ as Fe,H as Oe,I as Pe,J as Re,aG as Me,dB as Ie,K as Ye,L as qe,__tla as Le}from"./index-0f589822.js";import{E as He,__tla as ze}from"./el-image-viewer-863e3dd0.js";import{_ as Ge,__tla as je}from"./index.vue_vue_type_script_setup_true_lang-75e3d81d.js";import{E as Be,__tla as Je}from"./el-image-9c2dd802.js";import{_ as Ke,__tla as We}from"./DictTag.vue_vue_type_script_lang-9c2c480d.js";import{E as Ze,a as Qe,b as Xe,__tla as $e}from"./el-dropdown-item-a8b445c5.js";import{E as ea,a as aa,__tla as la}from"./el-descriptions-item-41445509.js";import{_ as ta,__tla as ra}from"./ContentWrap.vue_vue_type_script_setup_true_lang-0f1e3633.js";import{c as F,D as C,__tla as ua}from"./dict-f9a1a53b.js";import{a as oa,__tla as sa}from"./index-ff85fbb6.js";import{f as na,d as ae,__tla as ia}from"./formatTime-58783104.js";import{d as da}from"./download-20922b56.js";import{u as ca,__tla as pa}from"./useMessage-45ab706e.js";import{__tla as ma}from"./index-331b9b98.js";import"./color-a8b4eb58.js";import{__tla as _a}from"./el-card-bbdd700f.js";let le,fa=Promise.all([(()=>{try{return Le}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return Je}catch{}})(),(()=>{try{return We}catch{}})(),(()=>{try{return $e}catch{}})(),(()=>{try{return la}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return ua}catch{}})(),(()=>{try{return sa}catch{}})(),(()=>{try{return ia}catch{}})(),(()=>{try{return pa}catch{}})(),(()=>{try{return ma}catch{}})(),(()=>{try{return _a}catch{}})()]).then(async()=>{let H,z,G;H={key:1},z={class:"m-2"},G={key:1},le=ke({__name:"index",setup(va){const te=ca(),{push:re}=Ce(),O=b(!1),j=b([]),B=b(),P=b(!1),V=b(!1),R=b(0),n=b([]),o=q({queryParams:{},selectTotal:0,selectAllFlag:!1,selectData:new Map,unSelectList:new Set}),l=q({pageNo:1,pageSize:10}),h=q({k:"",v:""}),ue=b([{value:"no",label:"\u8BA2\u5355\u53F7"},{value:"userId",label:"\u7528\u6237UID"},{value:"userNickname",label:"\u7528\u6237\u6635\u79F0"},{value:"userMobile",label:"\u7528\u6237\u7535\u8BDD"},{value:"spuName",label:"\u5546\u54C1\u540D\u79F0TODO"},{value:"itemCount",label:"\u5546\u54C1\u4EF6\u6570TODO"}]),oe=i=>{var d,g,y;let a=0;if(i==="1")if(o.selectData&&o.selectData.has(l.pageNo)){for(a=0;a<n.value.length;a++)o.selectData.get(l.pageNo).has(n.value[a].id)&&(o.selectTotal-=1,E(n.value[a].id,"add")),n.value[a].itemSelect=!1;o.selectData.delete(l.pageNo)}else for(o.selectData.set(l.pageNo,new Set),a=0;a<n.value.length;a++)n.value[a].itemSelect=!0,o.selectData.get(l.pageNo).add(n.value[a].id),o.selectTotal+=1,E(n.value[a].id,"del");if(i==="2")if(o.selectAllFlag=!o.selectAllFlag,o.selectAllFlag){for((d=o.selectData)==null||d.set(l.pageNo,new Set),a=0;a<n.value.length;a++)n.value[a].itemSelect=!0,(y=(g=o.selectData)==null?void 0:g.get(l.pageNo))==null||y.add(n.value[a].id);o.selectTotal=R.value}else{for(;a<n.value.length;a++)n.value[a].itemSelect=!1;M()}},E=(i,a)=>{o.selectAllFlag&&(a=="add"?o.unSelectList.add(i):o.unSelectList.delete(i))},se=async()=>{try{await te.exportConfirm(),o.queryParams=l,V.value=!0,da.excel(o,"\u8BA2\u5355\u4FE1\u606F.xls")}catch{}finally{V.value=!1}V.value=!1},J=()=>{I()},ne=()=>{B.value.resetFields(),h.v="",h.k="",setTimeout(()=>{M(),J()},100)},M=()=>{var i,a;o.queryParams={},o.selectTotal=0,o.selectAllFlag=!1,(i=o.selectData)==null||i.clear(),(a=o.unSelectList)==null||a.clear()},I=async()=>{P.value=!0;try{const i=await oa(l);n.value=i.list,R.value=i.total;let a=0;if(o.selectData&&o.selectData.has(l.pageNo))for(a=0;a<n.value.length;a++)o.selectData.get(l.pageNo).has(n.value[a].id)?n.value[a].itemSelect=!0:n.value[a].itemSelect=!1;else if(o.selectAllFlag)for(o.selectData.set(l.pageNo,new Set),a=0;a<n.value.length;a++)n.value[a].itemSelect=!0,o.selectData.get(l.pageNo).add(n.value[a].id);else for(;a<n.value.length;a++)n.value[a].itemSelect=!1}finally{P.value=!1}},K=i=>{re({name:"TradeOrderDetail",query:{id:i.id}})};return De(()=>[h.k,h.v],([i,a],[d])=>{d!=i&&(d=="no"&&l.no!=""?l.no="":d=="userId"&&l.userId!=""?l.userId="":d=="userNickname"&&l.userNickname!=""?l.userNickname="":d=="userMobile"&&l.userMobile!==""?l.userMobile="":d=="spuName"&&l.spuName!==""?l.spuName="":d=="itemCount"&&l.itemCount!==""?l.itemCount="":d==""&&l.all!==""&&(l.all="")),i=="no"?l.no=a:i=="userId"?l.userId=a:i=="userNickname"?l.userNickname=a:i=="userMobile"?l.userMobile=a:i=="spuName"?l.spuName=a:i=="itemCount"?l.itemCount=a:i==""&&(l.all=a)}),Ne(()=>{M(),I()}),(i,a)=>{const d=Se,g=Ve,y=Ee,ie=Ae,de=Ue,Y=Fe,w=Oe,ce=Pe,W=ta,T=ea,pe=aa,_=Re,Z=Ze,me=Qe,_e=Xe,fe=Me,A=Ke,ve=Be,ye=Ie,he=Ye,ge=Ge,we=He,Q=Te("hasPermi"),be=qe;return s(),v(k,null,[t(W,null,{default:r(()=>[t(ce,{ref_key:"queryFormRef",ref:B,model:u(l),class:"-mb-15px","label-width":"68px",inline:!0},{default:r(()=>[t(y,{label:"\u8BA2\u5355\u72B6\u6001",prop:"status"},{default:r(()=>[t(g,{class:"!w-280px",modelValue:u(l).status,"onUpdate:modelValue":a[0]||(a[0]=e=>u(l).status=e),clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(s(!0),v(k,null,D(u(F)(u(C).TRADE_ORDER_STATUS),e=>(s(),f(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"\u652F\u4ED8\u65B9\u5F0F",prop:"payChannelCode"},{default:r(()=>[t(g,{modelValue:u(l).payChannelCode,"onUpdate:modelValue":a[1]||(a[1]=e=>u(l).payChannelCode=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(s(!0),v(k,null,D(u(F)(u(C).PAY_CHANNEL_CODE_TYPE),e=>(s(),f(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:r(()=>[t(ie,{modelValue:u(l).createTime,"onUpdate:modelValue":a[2]||(a[2]=e=>u(l).createTime=e),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-280px","start-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4","end-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(y,{label:"\u8BA2\u5355\u6765\u6E90",prop:"terminal"},{default:r(()=>[t(g,{class:"!w-280px",modelValue:u(l).terminal,"onUpdate:modelValue":a[3]||(a[3]=e=>u(l).terminal=e),clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(s(!0),v(k,null,D(u(F)(u(C).TERMINAL),e=>(s(),f(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"\u8BA2\u5355\u7C7B\u578B",prop:"type"},{default:r(()=>[t(g,{class:"!w-280px",modelValue:u(l).type,"onUpdate:modelValue":a[4]||(a[4]=e=>u(l).type=e),clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(s(!0),v(k,null,D(u(F)(u(C).TRADE_ORDER_TYPE),e=>(s(),f(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"\u8BA2\u5355\u641C\u7D22"},{default:r(()=>[U(t(de,{class:"!w-280px",modelValue:u(h).v,"onUpdate:modelValue":a[6]||(a[6]=e=>u(h).v=e),clearable:"",placeholder:"\u8BF7\u8F93\u5165"},{prepend:r(()=>[t(g,{style:{width:"110px"},modelValue:u(h).k,"onUpdate:modelValue":a[5]||(a[5]=e=>u(h).k=e),clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(s(!0),v(k,null,D(u(ue),e=>(s(),f(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),[[xe,!0]])]),_:1}),t(y,null,{default:r(()=>[U((s(),f(w,{onClick:J},{default:r(()=>[t(Y,{class:"mr-5px",icon:"ep:search"}),p(" \u641C\u7D22 ")]),_:1})),[[Q,["trade:order:query"]]]),U((s(),f(w,{onClick:ne},{default:r(()=>[t(Y,{class:"mr-5px",icon:"ep:refresh"}),p(" \u91CD\u7F6E ")]),_:1})),[[Q,["trade:order:query"]]]),t(w,{type:"success",plain:"",onClick:se,loading:u(V)},{default:r(()=>[t(Y,{icon:"ep:download",class:"mr-5px"}),p(" \u5BFC\u51FATODO ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(W,null,{default:r(()=>[U((s(),f(he,{data:u(n)},{default:r(()=>[t(_,{type:"expand",fixed:"left"},{default:r(e=>[t(pe,{class:"mx-40"},{default:r(()=>[t(T,{label:"\u5546\u54C1\u539F\u4EF7(\u603B): "},{default:r(()=>[p(m("\uFFE5 "+parseFloat(e.row.originalPrice/100).toFixed(2)+" \u5143"),1)]),_:2},1024),t(T,{label:"\u4E0B\u5355\u65F6\u95F4: "},{default:r(()=>[p(m(u(na)(e.row.createTime)),1)]),_:2},1024),t(T,{label:"\u63A8\u5E7F\u4EBA: "},{default:r(()=>[p("TODO")]),_:1}),t(T,{label:"\u7528\u6237\u5907\u6CE8: "},{default:r(()=>[p(m(e.row.userRemark),1)]),_:2},1024),t(T,{label:"\u5546\u5BB6\u5907\u6CE8: "},{default:r(()=>[p(m(e.row.remark),1)]),_:2},1024)]),_:2},1024)]),_:1}),t(_,{width:"100",fixed:"left"},{header:r(()=>[t(_e,{icon:"eq:search",onCommand:oe},{dropdown:r(()=>[t(me,null,{default:r(()=>[t(Z,{command:"1"},{default:r(()=>[p("\u5F53\u524D\u9875")]),_:1}),t(Z,{command:"2"},{default:r(()=>[p("\u6240\u6709\u9875")]),_:1})]),_:1})]),default:r(()=>[t(w,{link:"",type:"primary"},{default:r(()=>[p("\u5168\u9009("+m(u(o).selectTotal)+") ",1)]),_:1})]),_:1})]),default:r(e=>[t(fe,{modelValue:e.row.itemSelect,"onUpdate:modelValue":c=>e.row.itemSelect=c,onChange:c=>{var x,X,$,ee;var N;(N=e.row).itemSelect?(o.selectTotal+=1,o.selectData.has(l.pageNo)||((x=o.selectData)==null||x.set(l.pageNo,new Set)),($=(X=o.selectData)==null?void 0:X.get(l.pageNo))==null||$.add(N.id),E(N.id,"del")):(o.selectTotal-=1,(ee=o.selectData.get(l.pageNo))==null||ee.delete(N.id),E(N.id,"add"))}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(_,{label:"\u8BA2\u5355\u53F7",align:"center","min-width":"110"},{default:r(e=>[t(w,{link:"",type:"primary",onClick:c=>K(e.row)},{default:r(()=>[p(m(e.row.no),1)]),_:2},1032,["onClick"])]),_:1}),t(_,{label:"\u8BA2\u5355\u7C7B\u578B",align:"center","min-width":"100"},{default:r(e=>[t(A,{type:u(C).TRADE_ORDER_TYPE,value:e.row.type},null,8,["type","value"])]),_:1}),t(_,{label:"\u7528\u6237\u4FE1\u606F",align:"center","min-width":"100"},{default:r(e=>[t(w,{link:"",type:"primary",onClick:c=>{e.row}},{default:r(()=>[p(m(e.row.userId)+m("["+e.row.user.nickname+"]"),1)]),_:2},1032,["onClick"])]),_:1}),t(_,{formatter:u(ae),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime","min-width":"180"},null,8,["formatter"]),t(_,{label:"\u8BA2\u5355\u6765\u6E90",align:"center","min-width":"100"},{default:r(e=>[e.row.terminal?(s(),f(A,{key:0,type:u(C).TERMINAL,value:e.row.terminal},null,8,["type","value"])):(s(),v("span",H,m(e.terminal),1))]),_:1}),t(_,{label:"\u5546\u54C1\u4FE1\u606F",align:"left","min-width":"200",prop:"items"},{default:r(e=>[t(ye,{ref:"popover",placement:"bottom",title:"\u8BA2\u5355:"+e.row.no,width:400,trigger:"hover"},{reference:r(()=>[S("div",null,[(s(!0),v(k,null,D(e.row.items,c=>(s(),v("div",{key:c},[t(ve,{style:{width:"36px",height:"36px"},src:c.picUrl,"preview-src-list":[c.picUrl],fit:"cover",onClick:N=>{return x=c.picUrl,j.value=[x],void(O.value=!0);var x}},null,8,["src","preview-src-list","onClick"]),S("span",z,m(c.spuName),1)]))),128))])]),default:r(()=>[(s(!0),v(k,null,D(e.row.items,c=>(s(),v("div",{key:c},[S("div",null,[S("p",null,m(c.spuName),1),S("p",null,m("\uFFE5 "+parseFloat(c.payPrice/100).toFixed(2)+"\u5143 x "+c.count),1)])]))),128))]),_:2},1032,["title"])]),_:1}),t(_,{label:"\u5B9E\u9645\u652F\u4ED8(\u5143)",align:"center",prop:"payPrice","min-width":"100"},{default:r(e=>[p(m("\uFFE5 "+parseFloat(e.row.payPrice/100).toFixed(2)),1)]),_:1}),t(_,{formatter:u(ae),align:"center",label:"\u652F\u4ED8\u65F6\u95F4",prop:"payTime","min-width":"180"},null,8,["formatter"]),t(_,{label:"\u652F\u4ED8\u7C7B\u578B",align:"center","min-width":"100",prop:"payChannelCode"},{default:r(e=>[e.row.payChannelCode?(s(),f(A,{key:0,type:u(C).PAY_CHANNEL_CODE_TYPE,value:e.row.payChannelCode},null,8,["type","value"])):L("",!0)]),_:1}),t(_,{label:"\u8BA2\u5355\u72B6\u6001",align:"center",prop:"status","min-width":"100"},{default:r(e=>[e.row.status!==""?(s(),f(A,{key:0,type:u(C).TRADE_ORDER_STATUS,value:e.row.status},null,8,["type","value"])):(s(),v("span",G,m(e.status),1))]),_:1}),t(_,{label:"\u64CD\u4F5C",align:"center",fixed:"right","min-width":"150"},{default:r(e=>[e.row.status=="10"?(s(),f(w,{key:0,link:"",type:"primary",onClick:c=>{e.row}},{default:r(()=>[p("\u53D1\u8D27")]),_:2},1032,["onClick"])):L("",!0),t(w,{link:"",type:"primary",onClick:c=>K(e.row)},{default:r(()=>[p("\u8BE6\u60C5")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[be,u(P)]]),t(ge,{limit:u(l).pageSize,"onUpdate:limit":a[7]||(a[7]=e=>u(l).pageSize=e),page:u(l).pageNo,"onUpdate:page":a[8]||(a[8]=e=>u(l).pageNo=e),total:u(R),onPagination:I},null,8,["limit","page","total"])]),_:1}),u(O)?(s(),f(we,{key:0,"url-list":u(j),onClose:a[9]||(a[9]=e=>O.value=!1)},null,8,["url-list"])):L("",!0)],64)}}})});export{fa as __tla,le as default};
