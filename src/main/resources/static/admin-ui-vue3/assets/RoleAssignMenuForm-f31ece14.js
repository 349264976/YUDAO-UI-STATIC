import{d as q,l as B,r as o,f as D,o as b,q as V,w as l,i as t,a as u,j as i,B as G,t as g,x as h,a4 as L,D as P,bG as Q,du as z,I as J,H as O,L as T,__tla as W}from"./index-0f589822.js";import{_ as X,__tla as Y}from"./Dialog.vue_vue_type_style_index_0_lang-2d188c85.js";import{E as Z,__tla as $}from"./el-card-bbdd700f.js";import{d as ee,h as ae}from"./tree-f9b1893a.js";import{g as le,__tla as te}from"./index-4df96aa7.js";import{g as se,a as ue,__tla as de}from"./index-159a6c2b.js";import{u as oe,__tla as re}from"./useMessage-45ab706e.js";import{_ as ne}from"./_plugin-vue_export-helper-1b428a4d.js";let C,me=Promise.all([(()=>{try{return W}catch{}})(),(()=>{try{return Y}catch{}})(),(()=>{try{return $}catch{}})(),(()=>{try{return te}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return re}catch{}})()]).then(async()=>{C=ne(q({name:"SystemRoleAssignMenuForm",__name:"RoleAssignMenuForm",emits:["success"],setup(ce,{expose:I,emit:w}){const{t:R}=B(),M=oe(),r=o(!1),n=o(!1),s=D({id:0,name:"",code:"",menuIds:[]}),v=o(),p=o([]),m=o(!1),d=o(),_=o(!1);I({open:async a=>{r.value=!0,H(),p.value=ae(await le()),s.id=a.id,s.name=a.name,s.code=a.code,n.value=!0;try{s.value.menuIds=await se(a.id),s.value.menuIds.forEach(e=>{d.value.setChecked(e,!0,!1)})}finally{n.value=!1}}});const F=async()=>{if(v&&await v.value.validate()){n.value=!0;try{const a={roleId:s.id,menuIds:[...d.value.getCheckedKeys(!1),...d.value.getHalfCheckedKeys()]};await ue(a),M.success(R("common.updateSuccess")),r.value=!1,w("success")}finally{n.value=!1}}},H=()=>{var a,e;_.value=!1,m.value=!1,s.value={id:0,name:"",code:"",menuIds:[]},(a=d.value)==null||a.setCheckedNodes([]),(e=v.value)==null||e.resetFields()},U=()=>{d.value.setCheckedNodes(_.value?p.value:[])},j=()=>{var e;const a=(e=d.value)==null?void 0:e.store.nodesMap;for(let f in a)a[f].expanded!==m.value&&(a[f].expanded=m.value)};return(a,e)=>{const f=L,y=P,x=Q,A=z,E=Z,K=J,k=O,N=X,S=T;return b(),V(N,{modelValue:u(r),"onUpdate:modelValue":e[3]||(e[3]=c=>h(r)?r.value=c:null),title:"\u83DC\u5355\u6743\u9650"},{footer:l(()=>[t(k,{disabled:u(n),type:"primary",onClick:F},{default:l(()=>[i("\u786E \u5B9A")]),_:1},8,["disabled"]),t(k,{onClick:e[2]||(e[2]=c=>r.value=!1)},{default:l(()=>[i("\u53D6 \u6D88")]),_:1})]),default:l(()=>[G((b(),V(K,{ref_key:"formRef",ref:v,model:u(s),"label-width":"80px"},{default:l(()=>[t(y,{label:"\u89D2\u8272\u540D\u79F0"},{default:l(()=>[t(f,null,{default:l(()=>[i(g(u(s).name),1)]),_:1})]),_:1}),t(y,{label:"\u89D2\u8272\u6807\u8BC6"},{default:l(()=>[t(f,null,{default:l(()=>[i(g(u(s).code),1)]),_:1})]),_:1}),t(y,{label:"\u83DC\u5355\u6743\u9650"},{default:l(()=>[t(E,{class:"cardHeight"},{header:l(()=>[i(" \u5168\u9009/\u5168\u4E0D\u9009: "),t(x,{modelValue:u(_),"onUpdate:modelValue":e[0]||(e[0]=c=>h(_)?_.value=c:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:U},null,8,["modelValue"]),i(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: "),t(x,{modelValue:u(m),"onUpdate:modelValue":e[1]||(e[1]=c=>h(m)?m.value=c:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:j},null,8,["modelValue"])]),default:l(()=>[t(A,{ref_key:"treeRef",ref:d,data:u(p),props:u(ee),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1})]),_:1},8,["model"])),[[S,u(n)]])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-8d5bea34"]])});export{me as __tla,C as default};
