import{E as e,a as t,s as l}from"./index-168f367d.js";import{_ as a}from"./el-tree-39cab679.js";import{u as s,_ as r}from"./base-085523fd.js";import{p as o}from"./el-checkbox-cd7dd8c1.js";import{K as n,c as d,D as c,d as i,G as u,m as p,b7 as h,q as f,r as v,A as m,x as k,B as y}from"./runtime-core.esm-bundler-ccc21fcd.js";import{U as C}from"./el-notification-c7d5f4ea.js";import{i as b}from"./isEqual-6e1d5dd6.js";const g=i({extends:t,setup(e,l){const a=t.setup(e,l);delete a.selectOptionClick;const s=u().proxy;return c((()=>{a.select.cachedOptions.get(s.value)||a.select.onOptionCreate(s)})),a},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function x(e){return e||0===e}function K(e){return Array.isArray(e)&&e.length}function O(e){return Array.isArray(e)?e:x(e)?[e]:[]}function N(e,t,l,a,s){for(let r=0;r<e.length;r++){const o=e[r];if(t(o,r,e,s))return a?a(o,r,e,s):o;{const e=l(o);if(K(e)){const s=N(e,t,l,a,o);if(s)return s}}}}function j(e,t,l,a){for(let s=0;s<e.length;s++){const r=e[s];t(r,s,e,a);const o=l(r);K(o)&&j(o,t,l,r)}}const E=(e,{attrs:t,slots:l,emit:s},{select:r,tree:i,key:u})=>{p((()=>e.modelValue),(()=>{e.showCheckbox&&c((()=>{const t=i.value;t&&!b(t.getCheckedKeys(),O(e.modelValue))&&t.setCheckedKeys(O(e.modelValue))}))}),{immediate:!0,deep:!0});const f=d((()=>({value:u.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props}))),v=(e,t)=>{var l;const a=f.value[e];return h(a)?a(t,null==(l=i.value)?void 0:l.getNode(v("value",t))):t[a]},m=O(e.modelValue).map((t=>N(e.data||[],(e=>v("value",e)===t),(e=>v("children",e)),((e,t,l,a)=>a&&v("value",a))))).filter((e=>x(e))),k=d((()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return j(e.data.concat(e.cacheData),(e=>{const l=v("value",e);t.push({value:l,currentLabel:v("label",e),isDisabled:v("disabled",e)})}),(e=>v("children",e))),t}));return{...o(n(e),Object.keys(a.props)),...t,nodeKey:u,expandOnClickNode:d((()=>!e.checkStrictly&&e.expandOnClickNode)),defaultExpandedKeys:d((()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(m):m)),renderContent:(t,{node:a,data:s,store:r})=>t(g,{value:v("value",s),label:v("label",s),disabled:v("disabled",s)},e.renderContent?()=>e.renderContent(t,{node:a,data:s,store:r}):l.default?()=>l.default({node:a,data:s,store:r}):void 0),filterNodeMethod:(t,l,a)=>{var s;return e.filterNodeMethod?e.filterNodeMethod(t,l,a):!t||(null==(s=v("label",l))?void 0:s.includes(t))},onNodeClick:(l,a,s)=>{var o,n,d;if(null==(o=t.onNodeClick)||o.call(t,l,a,s),!e.showCheckbox||!e.checkOnClickNode)if(e.showCheckbox||!e.checkStrictly&&!a.isLeaf)e.expandOnClickNode&&s.proxy.handleExpandIconClick();else if(!v("disabled",l)){const e=null==(n=r.value)?void 0:n.options.get(v("value",l));null==(d=r.value)||d.handleOptionSelect(e,!0)}},onCheck:(l,a)=>{var r;null==(r=t.onCheck)||r.call(t,l,a);const o=v("value",l);if(e.checkStrictly)s(C,e.multiple?a.checkedKeys:a.checkedKeys.includes(o)?o:void 0);else if(e.multiple)s(C,i.value.getCheckedKeys(!0));else{const t=N([l],(e=>!K(v("children",e))&&!v("disabled",e)),(e=>v("children",e))),a=t?v("value",t):void 0,r=x(e.modelValue)&&!!N([l],(t=>v("value",t)===e.modelValue),(e=>v("children",e)));s(C,a===e.modelValue||r?void 0:a)}},cacheOptions:k}};var A=i({props:{data:{type:Array,default:()=>[]}},setup(e){const t=f(l);return p((()=>e.data),(()=>{e.data.forEach((e=>{t.cachedOptions.has(e.value)||t.cachedOptions.set(e.value,e)})),t.setSelected()}),{immediate:!0,deep:!0}),()=>{}}});var V=r(i({name:"ElTreeSelect",inheritAttrs:!1,props:{...e.props,...a.props,cacheData:{type:Array,default:()=>[]}},setup(t,l){const{slots:r,expose:i}=l,u=v(),p=v(),h=d((()=>t.nodeKey||t.valueKey||"value")),f=((t,{attrs:l},{tree:a,key:r})=>{const i=s("tree-select"),u={...o(n(t),Object.keys(e.props)),...l,valueKey:r,popperClass:d((()=>{const e=[i.e("popper")];return t.popperClass&&e.push(t.popperClass),e.join(" ")})),filterMethod:(e="")=>{t.filterMethod&&t.filterMethod(e),c((()=>{var t;null==(t=a.value)||t.filter(e)}))},onVisibleChange:e=>{var a;null==(a=l.onVisibleChange)||a.call(l,e),t.filterable&&e&&u.filterMethod()}};return u})(t,l,{select:u,tree:p,key:h}),{cacheOptions:C,...b}=E(t,l,{select:u,tree:p,key:h}),g=m({});return i(g),k((()=>{Object.assign(g,{...o(p.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...o(u.value,["focus","blur"])})})),()=>y(e,m({...f,ref:e=>u.value=e}),{...r,default:()=>[y(A,{data:C.value}),y(a,m({...b,ref:e=>p.value=e}))]})}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);V.install=e=>{e.component(V.name,V)};const M=V;export{M as E};
