import{d as ia,l as pa,u as ca,r as f,af as da,A as ma,O as _a,o,c as L,i as a,w as t,a as l,P as fa,j as c,B as y,q as d,F as S,k as ya,g as C,t as x,ac as N,a1 as ha,ad as wa,T as ba,D as ka,G as ga,_ as va,H as Ca,I as xa,y as Ea,z as Va,E as Ia,n as Ta,J as La,bG as Sa,a4 as Aa,K as Da,L as Ua,$ as Ba,a0 as Pa,__tla as Na}from"./index-0f589822.js";import{_ as Ya,__tla as $a}from"./index.vue_vue_type_script_setup_true_lang-75e3d81d.js";import{E as Ra,__tla as za}from"./el-image-9c2dd802.js";import{__tla as qa}from"./el-image-viewer-863e3dd0.js";import{_ as Fa,__tla as Ha}from"./ContentWrap.vue_vue_type_script_setup_true_lang-0f1e3633.js";import{E as Ka,__tla as ja}from"./el-tree-select-df2c08ac.js";import{c as Ga,__tla as Ma}from"./index-2b69f27f.js";import{d as Oa,__tla as Ja}from"./formatTime-58783104.js";import{h as Wa,d as Xa,t as Za,c as Qa}from"./tree-f9b1893a.js";import{P as m}from"./constants-c9e2dac8.js";import{d as at}from"./download-20922b56.js";import{a as tt,b as et,d as lt,e as st,f as nt,__tla as rt}from"./spu-3234a0da.js";import{g as ut,__tla as ot}from"./category-77c014e3.js";import{u as it,__tla as pt}from"./useMessage-45ab706e.js";import{_ as ct}from"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as dt}from"./index-331b9b98.js";import{__tla as mt}from"./el-card-bbdd700f.js";let G,_t=Promise.all([(()=>{try{return Na}catch{}})(),(()=>{try{return $a}catch{}})(),(()=>{try{return za}catch{}})(),(()=>{try{return qa}catch{}})(),(()=>{try{return Ha}catch{}})(),(()=>{try{return ja}catch{}})(),(()=>{try{return Ma}catch{}})(),(()=>{try{return Ja}catch{}})(),(()=>{try{return rt}catch{}})(),(()=>{try{return ot}catch{}})(),(()=>{try{return pt}catch{}})(),(()=>{try{return dt}catch{}})(),(()=>{try{return mt}catch{}})()]).then(async()=>{let Y;Y=(E=>(Ba("data-v-341099dc"),E=E(),Pa(),E))(()=>C("span",null,"5",-1)),G=ct(ia({name:"ProductSpu",__name:"index",setup(E){const v=it(),{t:M}=pa(),{currentRoute:O,push:$}=ca(),A=f(!1),D=f(!1),R=f(0),z=f([]),q=f([{count:0,name:"\u51FA\u552E\u4E2D\u5546\u54C1",type:0},{count:0,name:"\u4ED3\u5E93\u4E2D\u5546\u54C1",type:1},{count:0,name:"\u5DF2\u7ECF\u552E\u7A7A\u5546\u54C1",type:2},{count:0,name:"\u8B66\u6212\u5E93\u5B58",type:3},{count:0,name:"\u5546\u54C1\u56DE\u6536\u7AD9",type:4}]),U=async()=>{const s=await tt();for(let r in s)q.value[Number(r)].count=s[r]},n=f({pageNo:1,pageSize:10,tabType:0,name:"",categoryId:null,createTime:[]}),F=f(),J=s=>{n.value.tabType=s.paneName,h()},h=async()=>{A.value=!0;try{const s=await et(n.value);z.value=s.list,R.value=s.total}finally{A.value=!1}},B=async(s,r)=>{const w=wa(l(s));r!==void 0&&(w.status=r);try{let u="";switch(w.status){case m.DISABLE.status:u=m.DISABLE.name;break;case m.ENABLE.status:u=m.ENABLE.name;break;case m.RECYCLE.status:u=`\u52A0\u5165${m.RECYCLE.name}`}await v.confirm(w.status===-1?`\u786E\u8BA4\u8981\u5C06[${s.name}]${u}\u5417\uFF1F`:s.status===-1?`\u786E\u8BA4\u8981\u5C06[${s.name}]\u6062\u590D\u5230\u4ED3\u5E93\u5417\uFF1F`:`\u786E\u8BA4\u8981${u}[${s.name}]\u5417\uFF1F`),await lt({id:w.id,status:w.status}),v.success("\u66F4\u65B0\u72B6\u6001\u6210\u529F"),await U(),await h()}catch{s.status=s.status===m.DISABLE.status?m.ENABLE.status:m.DISABLE.status}},P=()=>{h()},W=()=>{F.value.resetFields(),P()},H=s=>{$(typeof s!="number"?{name:"ProductSpuAdd"}:"/product/spu/edit/"+s)},X=async()=>{try{await v.exportConfirm(),D.value=!0;const s=await nt(n);at.excel(s,"\u5546\u54C1\u5217\u8868.xls")}catch{}finally{D.value=!1}};da(()=>O.value,()=>{h()});const V=f(),Z=()=>{Qa(V.value,n.value.categoryId)||(n.value.categoryId=null,v.warning("\u5FC5\u987B\u9009\u62E9\u4E8C\u7EA7\u53CA\u4EE5\u4E0B\u8282\u70B9\uFF01\uFF01"))};return ma(async()=>{await U(),await h();const s=await ut({});V.value=Wa(s,"id","parentId")}),(s,r)=>{const w=ba,u=ka,Q=Ka,aa=ga,I=va,_=Ca,K=xa,j=Fa,ta=Ea,ea=Va,b=Ia,T=Ta,i=La,la=Ra,sa=Sa,na=Aa,ra=Da,ua=Ya,k=_a("hasPermi"),oa=Ua;return o(),L(S,null,[a(j,null,{default:t(()=>[a(K,{ref_key:"queryFormRef",ref:F,inline:!0,model:l(n),class:"-mb-15px","label-width":"68px"},{default:t(()=>[a(u,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:t(()=>[a(w,{modelValue:l(n).name,"onUpdate:modelValue":r[0]||(r[0]=e=>l(n).name=e),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",onKeyup:fa(P,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),a(u,{label:"\u5546\u54C1\u5206\u7C7B",prop:"categoryId"},{default:t(()=>[a(Q,{modelValue:l(n).categoryId,"onUpdate:modelValue":r[1]||(r[1]=e=>l(n).categoryId=e),data:l(V),props:l(Xa),"check-strictly":"",class:"w-1/1","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B",onChange:Z},null,8,["modelValue","data","props"])]),_:1}),a(u,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:t(()=>[a(aa,{modelValue:l(n).createTime,"onUpdate:modelValue":r[2]||(r[2]=e=>l(n).createTime=e),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),a(u,null,{default:t(()=>[a(_,{onClick:P},{default:t(()=>[a(I,{class:"mr-5px",icon:"ep:search"}),c(" \u641C\u7D22 ")]),_:1}),a(_,{onClick:W},{default:t(()=>[a(I,{class:"mr-5px",icon:"ep:refresh"}),c(" \u91CD\u7F6E ")]),_:1}),y((o(),d(_,{plain:"",type:"primary",onClick:H},{default:t(()=>[a(I,{class:"mr-5px",icon:"ep:plus"}),c(" \u65B0\u589E ")]),_:1})),[[k,["product:spu:create"]]]),y((o(),d(_,{loading:l(D),plain:"",type:"success",onClick:X},{default:t(()=>[a(I,{class:"mr-5px",icon:"ep:download"}),c(" \u5BFC\u51FA ")]),_:1},8,["loading"])),[[k,["product:spu:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(j,null,{default:t(()=>[a(ea,{modelValue:l(n).tabType,"onUpdate:modelValue":r[3]||(r[3]=e=>l(n).tabType=e),onTabClick:J},{default:t(()=>[(o(!0),L(S,null,ya(l(q),e=>(o(),d(ta,{key:e.type,label:e.name+"("+e.count+")",name:e.type},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),y((o(),d(ra,{data:l(z)},{default:t(()=>[a(i,{type:"expand",width:"30"},{default:t(({row:e})=>[a(K,{class:"demo-table-expand","label-position":"left"},{default:t(()=>[a(T,null,{default:t(()=>[a(b,{span:24},{default:t(()=>[a(T,null,{default:t(()=>[a(b,{span:8},{default:t(()=>[a(u,{label:"\u5546\u54C1\u5206\u7C7B:"},{default:t(()=>{return[C("span",null,x((p=e.categoryId,Za(V.value,p))),1)];var p}),_:2},1024)]),_:2},1024),a(b,{span:8},{default:t(()=>[a(u,{label:"\u5E02\u573A\u4EF7:"},{default:t(()=>[C("span",null,x(l(N)(e.marketPrice)),1)]),_:2},1024)]),_:2},1024),a(b,{span:8},{default:t(()=>[a(u,{label:"\u6210\u672C\u4EF7:"},{default:t(()=>[C("span",null,x(l(N)(e.costPrice)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(T,null,{default:t(()=>[a(b,{span:24},{default:t(()=>[a(T,null,{default:t(()=>[a(b,{span:8},{default:t(()=>[a(u,{label:"\u6536\u85CF:"},{default:t(()=>[Y]),_:1})]),_:1}),a(b,{span:8},{default:t(()=>[a(u,{label:"\u865A\u62DF\u9500\u91CF:"},{default:t(()=>[C("span",null,x(e.virtualSalesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),a(i,{key:"id",align:"center",label:"\u5546\u54C1\u7F16\u53F7",prop:"id"}),a(i,{label:"\u5546\u54C1\u56FE","min-width":"80"},{default:t(({row:e})=>[a(la,{src:e.picUrl,class:"w-30px h-30px",onClick:p=>{return g=e.picUrl,void Ga({urlList:[g]});var g}},null,8,["src","onClick"])]),_:1}),a(i,{"show-overflow-tooltip":!0,label:"\u5546\u54C1\u540D\u79F0","min-width":"300",prop:"name"}),a(i,{align:"center",label:"\u5546\u54C1\u552E\u4EF7","min-width":"90",prop:"price"},{default:t(({row:e})=>[c(x(l(N)(e.price)),1)]),_:1}),a(i,{align:"center",label:"\u9500\u91CF","min-width":"90",prop:"salesCount"}),a(i,{align:"center",label:"\u5E93\u5B58","min-width":"90",prop:"stock"}),a(i,{align:"center",label:"\u6392\u5E8F","min-width":"70",prop:"sort"}),a(i,{formatter:l(Oa),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),a(i,{align:"center",label:"\u72B6\u6001","min-width":"80"},{default:t(({row:e})=>[e.status>=0?(o(),d(sa,{key:0,modelValue:e.status,"onUpdate:modelValue":p=>e.status=p,"active-value":1,"inactive-value":0,"active-text":"\u4E0A\u67B6","inactive-text":"\u4E0B\u67B6","inline-prompt":"",onChange:p=>B(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(o(),d(na,{key:1,type:"info"},{default:t(()=>[c("\u56DE\u6536\u7AD9")]),_:1}))]),_:1}),a(i,{align:"center",fixed:"right",label:"\u64CD\u4F5C","min-width":"200"},{default:t(({row:e})=>[y((o(),d(_,{link:"",type:"primary",onClick:p=>{return g=e.id,void $("/product/spu/detail/"+g);var g}},{default:t(()=>[c(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"])),[[k,["product:spu:update"]]]),l(n).tabType===4?(o(),L(S,{key:0},[y((o(),d(_,{link:"",type:"danger",onClick:p=>(async g=>{try{await v.delConfirm(),await st(g),v.success(M("common.delSuccess")),await U(),await h()}catch{}})(e.id)},{default:t(()=>[c(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[k,["product:spu:delete"]]]),y((o(),d(_,{link:"",type:"primary",onClick:p=>B(e,l(m).DISABLE.status)},{default:t(()=>[c(" \u6062\u590D\u5230\u4ED3\u5E93 ")]),_:2},1032,["onClick"])),[[k,["product:spu:update"]]])],64)):(o(),L(S,{key:1},[l(n).tabType!==0?y((o(),d(_,{key:0,link:"",type:"primary",onClick:p=>H(e.id)},{default:t(()=>[c(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[k,["product:spu:update"]]]):ha("",!0),y((o(),d(_,{link:"",type:"primary",onClick:p=>B(e,l(m).RECYCLE.status)},{default:t(()=>[c(" \u52A0\u5165\u56DE\u6536\u7AD9 ")]),_:2},1032,["onClick"])),[[k,["product:spu:update"]]])],64))]),_:1})]),_:1},8,["data"])),[[oa,l(A)]]),a(ua,{limit:l(n).pageSize,"onUpdate:limit":r[4]||(r[4]=e=>l(n).pageSize=e),page:l(n).pageNo,"onUpdate:page":r[5]||(r[5]=e=>l(n).pageNo=e),total:l(R),onPagination:h},null,8,["limit","page","total"])]),_:1})],64)}}}),[["__scopeId","data-v-341099dc"]])});export{_t as __tla,G as default};
