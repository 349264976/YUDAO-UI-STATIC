import{_ as z,__tla as J}from"./Dialog.vue_vue_type_style_index_0_lang-2d188c85.js";import{ab as h,d as O,r as p,f as Q,o as r,q as o,w as u,i as d,j as x,a as l,c as y,k as I,F as v,a1 as f,x as W,l as X,T as Z,D as $,C as ee,I as ae,H as le,M as te,__tla as se}from"./index-0f589822.js";import{E as ue,__tla as re}from"./el-tree-select-df2c08ac.js";import{a as A,D as R,__tla as de}from"./dict-f9a1a53b.js";import{d as oe,h as pe}from"./tree-f9b1893a.js";import{g as ie,__tla as ne}from"./index-2c0de0e8.js";import{g as me,__tla as _e}from"./index-6aa7f3e0.js";import{g as ce,__tla as ye}from"./index-92a8e18e.js";import{g as Ie,__tla as ve}from"./index-2e308907.js";import{g as fe,__tla as be}from"./index-15624e68.js";import{u as ge,__tla as he}from"./useMessage-45ab706e.js";let K,P,ke=Promise.all([(()=>{try{return J}catch{}})(),(()=>{try{return se}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ne}catch{}})(),(()=>{try{return _e}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return be}catch{}})(),(()=>{try{return he}catch{}})()]).then(async()=>{P=async k=>await h.get({url:"/bpm/task-assign-rule/list",params:k}),K=O({name:"BpmTaskAssignRuleForm",__name:"TaskAssignRuleForm",emits:["success"],setup(k,{expose:C,emit:F}){const{t:V}=X(),w=ge(),n=p(!1),g=p(!1),t=p({type:NaN,modelId:"",options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]}),B=Q({type:[{required:!0,message:"\u89C4\u5219\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],roleIds:[{required:!0,message:"\u6307\u5B9A\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deptIds:[{required:!0,message:"\u6307\u5B9A\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],postIds:[{required:!0,message:"\u6307\u5B9A\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userGroupIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],scripts:[{required:!0,message:"\u6307\u5B9A\u811A\u672C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),b=p(),G=p([]),U=p([]),D=p(),S=p([]),q=p([]),N=p([]),E=A(R.BPM_TASK_ASSIGN_SCRIPT);C({open:async(s,a)=>{j(),t.value={...a,modelId:s,options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]},a.type===10?t.value.roleIds.push(...a.options):a.type===20||a.type===21?t.value.deptIds.push(...a.options):a.type===22?t.value.postIds.push(...a.options):a.type===30||a.type===31||a.type===32?t.value.userIds.push(...a.options):a.type===40?t.value.userGroupIds.push(...a.options):a.type===50&&t.value.scripts.push(...a.options),n.value=!0,G.value=await ie(),U.value=await me(),D.value=pe(U.value,"id"),S.value=await ce(),q.value=await Ie(),N.value=await fe()}});const M=async()=>{if(!b||!await b.value.validate())return;const s={...t.value,taskDefinitionName:void 0};s.type===10?s.options=s.roleIds:s.type===20||s.type===21?s.options=s.deptIds:s.type===22?s.options=s.postIds:s.type===30||s.type===31||s.type===32?s.options=s.userIds:s.type===40?s.options=s.userGroupIds:s.type===50&&(s.options=s.scripts),s.roleIds=void 0,s.deptIds=void 0,s.postIds=void 0,s.userIds=void 0,s.userGroupIds=void 0,s.scripts=void 0,g.value=!0;try{const a=s;a.id?(await(async m=>await h.put({url:"/bpm/task-assign-rule/update",data:m}))(a),w.success(V("common.updateSuccess"))):(await(async m=>await h.post({url:"/bpm/task-assign-rule/create",data:m}))(a),w.success(V("common.createSuccess"))),n.value=!1,F("success")}finally{g.value=!1}},j=()=>{var s;(s=b.value)==null||s.resetFields()};return(s,a)=>{const m=Z,i=$,_=te,c=ee,H=ue,L=ae,T=le,Y=z;return r(),o(Y,{modelValue:l(n),"onUpdate:modelValue":a[10]||(a[10]=e=>W(n)?n.value=e:null),title:"\u4FEE\u6539\u4EFB\u52A1\u89C4\u5219",width:"600"},{footer:u(()=>[d(T,{disabled:l(g),type:"primary",onClick:M},{default:u(()=>[x("\u786E \u5B9A")]),_:1},8,["disabled"]),d(T,{onClick:a[9]||(a[9]=e=>n.value=!1)},{default:u(()=>[x("\u53D6 \u6D88")]),_:1})]),default:u(()=>[d(L,{ref_key:"formRef",ref:b,model:l(t),rules:l(B),"label-width":"80px"},{default:u(()=>[d(i,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"taskDefinitionName"},{default:u(()=>[d(m,{modelValue:l(t).taskDefinitionName,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).taskDefinitionName=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u6D41\u6807\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),d(i,{label:"\u4EFB\u52A1\u6807\u8BC6",prop:"taskDefinitionKey"},{default:u(()=>[d(m,{modelValue:l(t).taskDefinitionKey,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).taskDefinitionKey=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),d(i,{label:"\u89C4\u5219\u7C7B\u578B",prop:"type"},{default:u(()=>[d(c,{modelValue:l(t).type,"onUpdate:modelValue":a[2]||(a[2]=e=>l(t).type=e),clearable:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(A)(l(R).BPM_TASK_ASSIGN_RULE_TYPE),e=>(r(),o(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t).type===10?(r(),o(i,{key:0,label:"\u6307\u5B9A\u89D2\u8272",prop:"roleIds"},{default:u(()=>[d(c,{modelValue:l(t).roleIds,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).roleIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(G),e=>(r(),o(_,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===20||l(t).type===21?(r(),o(i,{key:1,label:"\u6307\u5B9A\u90E8\u95E8",prop:"deptIds",span:"24"},{default:u(()=>[d(H,{ref:"treeRef",modelValue:l(t).deptIds,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).deptIds=e),data:l(D),props:l(oe),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E",multiple:"","node-key":"id","show-checkbox":""},null,8,["modelValue","data","props"])]),_:1})):f("",!0),l(t).type===22?(r(),o(i,{key:2,label:"\u6307\u5B9A\u5C97\u4F4D",prop:"postIds",span:"24"},{default:u(()=>[d(c,{modelValue:l(t).postIds,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).postIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(S),e=>(r(),o(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===30||l(t).type===31||l(t).type===32?(r(),o(i,{key:3,label:"\u6307\u5B9A\u7528\u6237",prop:"userIds",span:"24"},{default:u(()=>[d(c,{modelValue:l(t).userIds,"onUpdate:modelValue":a[6]||(a[6]=e=>l(t).userIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(q),e=>(r(),o(_,{key:parseInt(e.id),label:e.nickname,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===40?(r(),o(i,{key:4,label:"\u6307\u5B9A\u7528\u6237\u7EC4",prop:"userGroupIds"},{default:u(()=>[d(c,{modelValue:l(t).userGroupIds,"onUpdate:modelValue":a[7]||(a[7]=e=>l(t).userGroupIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(N),e=>(r(),o(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===50?(r(),o(i,{key:5,label:"\u6307\u5B9A\u811A\u672C",prop:"scripts"},{default:u(()=>[d(c,{modelValue:l(t).scripts,"onUpdate:modelValue":a[8]||(a[8]=e=>l(t).scripts=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(E),e=>(r(),o(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}})});export{K as _,ke as __tla,P as g};
