import{_ as e}from"./XModal.vue_vue_type_script_setup_true_lang-c47b87cf.js";import"./base-085523fd.js";/* empty css                    */import{_ as t}from"./XTextButton-ab77381a.js";import{E as a}from"./el-card-d8ab0074.js";/* empty css                     */import{E as l}from"./el-tree-39cab679.js";import"./el-checkbox-cd7dd8c1.js";import{h as o}from"./aria-8fadfbe9.js";import{a as s}from"./tree-150ed6f6.js";import{p as r}from"./index-6f787488.js";import{u as i}from"./useI18n-56d4bc42.js";import{u as n}from"./useMessage-5e709b20.js";import{E as c}from"./index-be3181b1.js";import{a as m,E as p}from"./index-cb1b634a.js";import{d as u,A as d,r as f,o as h,a as j,w as v,e as _,l as g,f as x,i as y,F as b,z as w,t as k}from"./runtime-core.esm-bundler-ccc21fcd.js";const P={class:"flex"},N=u({__name:"Preview",setup(u,{expose:N}){const{t:V}=i(),E=n(),I=d({open:!1,titel:"代码预览",fileTree:[],activeName:""}),T=f(),C=async(e,t)=>{if(t&&!t.isLeaf)return!1;I.activeName=e.id},O=e=>{let t={},a=[];for(const l of e){let e=l.filePath.split("/"),o="";if(e[e.length-1].indexOf(".java")>=0){let t=[];for(let a=0;a<e.length;a++){let l=e[a];if("java"!==l){t.push(l);continue}t.push(l);let o="";for(;a<e.length&&(l=e[a+1],"controller"!==l&&"convert"!==l&&"dal"!==l&&"enums"!==l&&"service"!==l&&"vo"!==l&&"mysql"!==l&&"dataobject"!==l);)o=o?o+"."+l:l,a++;o&&t.push(o)}e=t}for(let l=0;l<e.length;l++){let s=o;o=0===o.length?e[l]:o.replaceAll(".","/")+"/"+e[l],t[o]||(t[o]=!0,a.push({id:o,label:e[l],parentId:s||"/"}))}}return a};return N({show:async e=>{const t=await r(e.id);let a=O(t);T.value=t,I.fileTree=s(a,"id","parentId","children","/"),I.activeName=t[0].filePath,I.open=!0}}),(s,r)=>{const i=l,n=c,u=a,d=t,f=m,N=p,O=e;return h(),j(O,{title:"预览",modelValue:x(I).open,"onUpdate:modelValue":r[1]||(r[1]=e=>x(I).open=e)},{default:v((()=>[_("div",P,[g(u,{class:"w-1/4",gutter:12,shadow:"hover"},{default:v((()=>[g(n,{height:"calc(100vh - 88px - 40px - 50px)"},{default:v((()=>[g(i,{ref:"treeRef","node-key":"id",data:x(I).fileTree,"expand-on-click-node":!1,"highlight-current":"",onNodeClick:C},null,8,["data"])])),_:1})])),_:1}),g(u,{class:"w-3/4 ml-3",gutter:12,shadow:"hover"},{default:v((()=>[g(N,{modelValue:x(I).activeName,"onUpdate:modelValue":r[0]||(r[0]=e=>x(I).activeName=e)},{default:v((()=>[(h(!0),y(b,null,w(x(T),(e=>(h(),j(f,{label:e.filePath.substring(e.filePath.lastIndexOf("/")+1),name:e.filePath,key:e.filePath},{default:v((()=>[g(d,{style:{float:"right"},title:x(V)("common.copy"),onClick:t=>(async e=>{const{copy:t,copied:a,isSupported:l}=o({source:e});l?(await t(),x(a)&&E.success(V("common.copySuccess"))):E.error(V("common.copyError"))})(e.code)},null,8,["title","onClick"]),_("pre",null,k(e.code),1)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["modelValue"])}}});export{N as _};
