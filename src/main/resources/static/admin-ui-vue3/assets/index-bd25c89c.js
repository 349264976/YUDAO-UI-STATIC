import{_ as e}from"./XModal.vue_vue_type_script_setup_true_lang-c47b87cf.js";import{_ as t}from"./Descriptions-8db90f03.js";import{_ as a}from"./Form-a0e23abc.js";import{_ as s}from"./ContentWrap.vue_vue_type_script_setup_true_lang-63555901.js";import{_ as i}from"./XTable.vue_vue_type_style_index_0_lang-9c560634.js";import{_ as o}from"./XTextButton-ab77381a.js";import"./base-085523fd.js";/* empty css               */import{_ as r}from"./XButton-39866472.js";import{a as l}from"./index-a7ef0ded.js";import{g as n}from"./index-a0aed13e.js";import{u as m}from"./useI18n-56d4bc42.js";import{r as p}from"./formRules-a3380b28.js";import{D as u}from"./dict-3e42505d.js";import{u as c}from"./useVxeCrudSchemas-8bec068b.js";import{A as d,d as j,r as _,Q as f,o as y,i as g,l as v,w as x,f as k,b,k as h,t as w,a as C,h as I,M as T,F as S}from"./runtime-core.esm-bundler-ccc21fcd.js";import{u as D}from"./useMessage-5e709b20.js";import{u as M}from"./useXTable-bf420a68.js";import{E as P}from"./index-795de047.js";/* empty css                     */import"./propTypes-5cfdbdab.js";import"./index-be3181b1.js";import"./aria-8fadfbe9.js";import"./runtime-dom.esm-bundler-daa7e741.js";import"./el-notification-c7d5f4ea.js";import"./el-button-6b012e5e.js";import"./index-4665dced.js";import"./index-c2caee16.js";import"./is-a7957d81.js";import"./focus-trap-f53979c5.js";import"./index-7a379d2e.js";import"./el-descriptions-item-d373bc22.js";import"./DictTag.vue_vue_type_script_lang-a5ff2643.js";import"./color-a8b4eb58.js";import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./Icon.vue_vue_type_script_setup_true_lang-4448c023.js";import"./dayjs.min-65a6b1e4.js";import"./useCache-d48cf6c5.js";import"./app-41ac77cd.js";import"./index-cf52a0ab.js";import"./el-message-7ddf9388.js";import"./index-7486e100.js";import"./index-183fdc84.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./Form.vue_vue_type_style_index_0_scoped_f983cb9f_lang-54d674bd.js";import"./el-form-item-8022b942.js";import"./cloneDeep-8298b498.js";import"./el-row-ad412a39.js";import"./el-col-613bea3c.js";import"./el-checkbox-cd7dd8c1.js";import"./isEqual-6e1d5dd6.js";import"./_flatRest-ac7abae6.js";import"./el-radio-group-d1c0e064.js";import"./el-input-number-4fe7018b.js";/* empty css                  */import"./el-tree-39cab679.js";import"./el-tree-select-6f481715.js";import"./index-168f367d.js";import"./strings-777507ad.js";import"./debounce-eb6bb100.js";import"./index-9d88d8a4.js";import"./el-switch-4b318cc1.js";/* empty css                   */import"./InputPassword-d0077663.js";import"./auth-2fa258a0.js";import"./el-image-viewer-f62c5b85.js";import"./el-progress-64245232.js";import"./isArrayLikeObject-26c677c4.js";import"./index-653de86a.js";/* empty css                        *//* empty css                                                                   *//* empty css                    */import"./el-card-d8ab0074.js";import"./download-20922b56.js";import"./XTextButton.vue_vue_type_style_index_0_scoped_0fcea4df_lang-41ab76b9.js";import"./vue-router-0864a153.js";import"./index-6f87c872.js";const F=e=>l.get({url:"/system/tenant/page",params:e}),R=e=>l.get({url:"/system/tenant/get?id="+e}),X=e=>l.delete({url:"/system/tenant/delete?id="+e}),A=e=>l.download({url:"/system/tenant/export-excel",params:e}),{t:V}=m(),L=[];(async()=>{(await n()).forEach((e=>{L.push({key:e.id,value:e.id,label:e.name})}))})();const N=d({name:[p],packageId:[p],contactName:[p],contactMobile:[p],accountCount:[p],expireTime:[p],username:[p,{min:4,max:30,trigger:"blur",message:"用户名称长度为 4-30 个字符"}],password:[p,{min:4,max:16,trigger:"blur",message:"密码长度为 4-16 位"}],domain:[p],status:[p]}),B=d({primaryKey:"id",primaryTitle:"租户编号",primaryType:"seq",action:!0,columns:[{title:"租户名称",field:"name",isSearch:!0},{title:"租户套餐",field:"packageId",table:{slots:{default:"packageId_default"}},form:{component:"Select",componentProps:{options:L}}},{title:"联系人",field:"contactName",isSearch:!0},{title:"联系手机",field:"contactMobile",isSearch:!0},{title:"用户名称",field:"username",isTable:!1,isDetail:!1},{title:"用户密码",field:"password",isTable:!1,isDetail:!1,form:{component:"InputPassword"}},{title:"账号额度",field:"accountCount",table:{slots:{default:"accountCount_default"}},form:{component:"InputNumber"}},{title:"过期时间",field:"expireTime",formatter:"formatDate",form:{component:"DatePicker",componentProps:{type:"datetime",valueFormat:"x"}}},{title:"绑定域名",field:"domain"},{title:"租户状态",field:"status",dictType:u.COMMON_STATUS,dictClass:"number",isSearch:!0},{title:V("table.createTime"),field:"createTime",formatter:"formatDate",isForm:!1,search:{show:!0,itemRender:{name:"XDataTimePicker"}}}]}),{allSchemas:E}=c(B),O=j({name:"Tenant"}),q=j({...O,setup(n){const{t:p}=m(),u=D(),[c,{reload:d,deleteData:j,exportList:V}]=M({allSchemas:E,getListApi:F,deleteApi:X,exportListApi:A}),B=_(!1),O=_(""),q=_(!1),U=_("edit"),z=_(),K=_(),Q=e=>{for(let t of L)if(t.value===e)return t.label;return"未知套餐"},W=e=>{U.value=p("action."+e),O.value=e,q.value=!0},J=async()=>{var e;const t=null==(e=k(z))?void 0:e.getElFormRef();t&&t.validate((async e=>{var t;if(e){B.value=!0;try{const e=null==(t=k(z))?void 0:t.formModel;"create"===O.value?(await(e=>l.post({url:"/system/tenant/create",data:e}))(e),u.success(p("common.createSuccess"))):(await(e=>l.put({url:"/system/tenant/update",data:e}))(e),u.success(p("common.updateSuccess"))),q.value=!1}finally{B.value=!1,await d()}}}))};return(l,n)=>{const m=r,u=P,d=o,_=i,D=s,M=a,F=t,X=e,A=f("hasPermi");return y(),g(S,null,[v(D,null,{default:x((()=>[v(_,{onRegister:k(c)},{toolbar_buttons:x((()=>[b(v(m,{type:"primary",preIcon:"ep:zoom-in",title:k(p)("action.add"),onClick:n[0]||(n[0]=e=>{W("create")})},null,8,["title"]),[[A,["system:tenant:create"]]]),b(v(m,{type:"warning",preIcon:"ep:download",title:k(p)("action.export"),onClick:n[1]||(n[1]=e=>k(V)("租户列表.xls"))},null,8,["title"]),[[A,["system:tenant:export"]]])])),accountCount_default:x((({row:e})=>[v(u,null,{default:x((()=>[h(w(e.accountCount),1)])),_:2},1024)])),packageId_default:x((({row:e})=>[0===e.packageId?(y(),C(u,{key:0,type:"danger"},{default:x((()=>[h("系统租户")])),_:1})):(y(),C(u,{key:1,type:"success"},{default:x((()=>[h(w(Q(e.packageId)),1)])),_:2},1024))])),actionbtns_default:x((({row:e})=>[b(v(d,{preIcon:"ep:edit",title:k(p)("action.edit"),onClick:t=>(async e=>{var t;W("update");const a=await R(e);null==(t=k(z))||t.setValues(a)})(e.id)},null,8,["title","onClick"]),[[A,["system:tenant:update"]]]),b(v(d,{preIcon:"ep:view",title:k(p)("action.detail"),onClick:t=>(async e=>{const t=await R(e);K.value=t,W("detail")})(e.id)},null,8,["title","onClick"]),[[A,["system:tenant:update"]]]),b(v(d,{preIcon:"ep:delete",title:k(p)("action.del"),onClick:t=>k(j)(e.id)},null,8,["title","onClick"]),[[A,["system:tenant:delete"]]])])),_:1},8,["onRegister"])])),_:1}),v(X,{modelValue:k(q),"onUpdate:modelValue":n[4]||(n[4]=e=>T(q)?q.value=e:null),title:k(U)},{footer:x((()=>[["create","update"].includes(k(O))?(y(),C(m,{key:0,type:"primary",title:k(p)("action.save"),loading:k(B),onClick:n[2]||(n[2]=e=>J())},null,8,["title","loading"])):I("",!0),v(m,{loading:k(B),title:k(p)("dialog.close"),onClick:n[3]||(n[3]=e=>q.value=!1)},null,8,["loading","title"])])),default:x((()=>[["create","update"].includes(k(O))?(y(),C(M,{key:0,schema:k(E).formSchema,rules:k(N),ref_key:"formRef",ref:z},null,8,["schema","rules"])):I("",!0),"detail"===k(O)?(y(),C(F,{key:1,schema:k(E).detailSchema,data:k(K)},{packageId:x((({row:e})=>[0===e.packageId?(y(),C(u,{key:0,type:"danger"},{default:x((()=>[h("系统租户")])),_:1})):(y(),C(u,{key:1,type:"success"},{default:x((()=>[h(w(Q(e.packageId)),1)])),_:2},1024))])),_:1},8,["schema","data"])):I("",!0)])),_:1},8,["modelValue","title"])],64)}}});export{q as default};
