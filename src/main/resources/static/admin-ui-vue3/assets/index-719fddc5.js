import{_ as e}from"./XModal.vue_vue_type_script_setup_true_lang-c47b87cf.js";import{_ as a}from"./Descriptions-8db90f03.js";import"./base-085523fd.js";import{a as l,E as o}from"./el-form-item-8022b942.js";import{b as t,E as i}from"./el-radio-group-d1c0e064.js";import{E as r}from"./el-input-number-4fe7018b.js";import{E as s}from"./el-notification-c7d5f4ea.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  */import{_ as n}from"./ContentWrap.vue_vue_type_script_setup_true_lang-63555901.js";import{_ as d}from"./XTable.vue_vue_type_style_index_0_lang-9c560634.js";import{_ as m}from"./XTextButton-ab77381a.js";import{_ as c}from"./XButton-39866472.js";import{a as p}from"./index-a7ef0ded.js";import{u}from"./useI18n-56d4bc42.js";import{r as f}from"./formRules-a3380b28.js";import{D as g,g as _}from"./dict-3e42505d.js";import{u as j}from"./useVxeCrudSchemas-8bec068b.js";import{A as y,d as b,r as V,Q as k,o as h,i as v,l as w,w as x,f as C,b as S,a as T,h as U,F as I,z as P,k as R,M as A}from"./runtime-core.esm-bundler-ccc21fcd.js";import{u as E}from"./useMessage-5e709b20.js";import{u as D}from"./useXTable-bf420a68.js";import{a as F,E as K}from"./index-168f367d.js";import"./propTypes-5cfdbdab.js";import"./index-be3181b1.js";import"./aria-8fadfbe9.js";import"./runtime-dom.esm-bundler-daa7e741.js";import"./el-descriptions-item-d373bc22.js";import"./index-c2caee16.js";import"./DictTag.vue_vue_type_script_lang-a5ff2643.js";import"./color-a8b4eb58.js";import"./index-795de047.js";import"./el-tooltip-4ed993c7.js";import"./Icon.vue_vue_type_script_setup_true_lang-4448c023.js";import"./dayjs.min-65a6b1e4.js";import"./useCache-d48cf6c5.js";import"./app-41ac77cd.js";import"./index-cf52a0ab.js";import"./el-message-7ddf9388.js";import"./is-a7957d81.js";import"./index-7a379d2e.js";import"./index-7486e100.js";import"./focus-trap-f53979c5.js";import"./index-4665dced.js";import"./index-183fdc84.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./cloneDeep-8298b498.js";import"./el-button-6b012e5e.js";import"./el-card-d8ab0074.js";import"./download-20922b56.js";import"./XTextButton.vue_vue_type_style_index_0_scoped_0fcea4df_lang-41ab76b9.js";import"./auth-2fa258a0.js";import"./vue-router-0864a153.js";import"./_flatRest-ac7abae6.js";import"./index-6f87c872.js";import"./strings-777507ad.js";import"./isEqual-6e1d5dd6.js";import"./debounce-eb6bb100.js";import"./index-9d88d8a4.js";const X=e=>p.get({url:"/infra/file-config/page",params:e}),B=e=>p.get({url:"/infra/file-config/get?id="+e}),L=e=>p.delete({url:"/infra/file-config/delete?id="+e}),{t:N}=u(),q=y({name:[f],storage:[f],config:{basePath:[f],host:[f],port:[f],username:[f],password:[f],mode:[f],endpoint:[f],bucket:[f],accessKey:[f],accessSecret:[f],domain:[f]}}),M=y({primaryKey:"id",primaryType:"seq",primaryTitle:"配置编号",action:!0,actionWidth:"400px",columns:[{title:"配置名",field:"name",isSearch:!0},{title:"存储器",field:"storage",dictType:g.INFRA_FILE_STORAGE,dictClass:"number",isSearch:!0},{title:"主配置",field:"master",dictType:g.INFRA_BOOLEAN_STRING,dictClass:"boolean"},{title:N("form.remark"),field:"remark",form:{component:"Input",componentProps:{type:"textarea",rows:4},colProps:{span:24}}},{title:N("common.createTime"),field:"createTime",formatter:"formatDate",isForm:!1,search:{show:!0,itemRender:{name:"XDataTimePicker"}}}]}),{allSchemas:O}=j(M),z=b({name:"FileConfig"}),G=b({...z,setup(f){const{t:j}=u(),y=E(),[b,{reload:N,deleteData:M}]=D({allSchemas:O,getListApi:X,deleteApi:L}),z=V(!1),G=V(""),W=V(!1),Q=V("edit"),Y=V(),Z=V(),$=V({id:0,name:"",storage:0,master:!1,visible:!1,config:{basePath:"",host:"",port:0,username:"",password:"",mode:"",endpoint:"",bucket:"",accessKey:"",accessSecret:"",domain:""},remark:"",createTime:new Date}),H=e=>{Q.value=j("action."+e),G.value=e,W.value=!0},J=e=>{y.confirm("是否确认修改配置【 "+e.name+" 】为主配置?",j("common.reminder")).then((async()=>{var a;await(a=e.id,p.put({url:"/infra/file-config/update-master?id="+a})),await N()}))},ee=async e=>{const a=await(l=e,p.get({url:"/infra/file-config/test?id="+l}));var l;y.alert("测试通过，上传文件成功！访问地址："+a)},ae=async e=>{e&&e.validate((async e=>{if(e){z.value=!0;try{"create"===G.value?(await(a=$.value,p.post({url:"/infra/file-config/create",data:a})),y.success(j("common.createSuccess"))):(await(e=>p.put({url:"/infra/file-config/update",data:e}))($.value),y.success(j("common.updateSuccess"))),W.value=!1}finally{z.value=!1,await N()}}var a}))};return(p,u)=>{const f=c,y=m,V=d,E=n,D=s,X=l,L=F,N=K,le=r,oe=t,te=i,ie=o,re=a,se=e,ne=k("hasPermi");return h(),v(I,null,[w(E,null,{default:x((()=>[w(V,{onRegister:C(b)},{toolbar_buttons:x((()=>[S(w(f,{type:"primary",preIcon:"ep:zoom-in",title:C(j)("action.add"),onClick:u[0]||(u[0]=e=>{return a=C(Y),H("create"),null==a||a.resetFields(),void($.value={id:0,name:"",storage:0,master:!1,visible:!1,config:{basePath:"",host:"",port:0,username:"",password:"",mode:"",endpoint:"",bucket:"",accessKey:"",accessSecret:"",domain:""},remark:"",createTime:new Date});var a})},null,8,["title"]),[[ne,["infra:file-config:create"]]])])),actionbtns_default:x((({row:e})=>[S(w(y,{preIcon:"ep:edit",title:C(j)("action.edit"),onClick:a=>(async e=>{const a=await B(e);$.value=a,H("update")})(e.id)},null,8,["title","onClick"]),[[ne,["infra:file-config:update"]]]),S(w(y,{preIcon:"ep:view",title:C(j)("action.detail"),onClick:a=>(async e=>{H("detail");const a=await B(e);Z.value=a})(e.id)},null,8,["title","onClick"]),[[ne,["infra:file-config:query"]]]),S(w(y,{preIcon:"ep:flag",title:"主配置",onClick:a=>J(e)},null,8,["onClick"]),[[ne,["infra:file-config:update"]]]),w(y,{preIcon:"ep:share",title:C(j)("action.test"),onClick:a=>ee(e.id)},null,8,["title","onClick"]),S(w(y,{preIcon:"ep:delete",title:C(j)("action.del"),onClick:a=>C(M)(e.id)},null,8,["title","onClick"]),[[ne,["infra:file-config:delete"]]])])),_:1},8,["onRegister"])])),_:1}),w(se,{modelValue:C(W),"onUpdate:modelValue":u[18]||(u[18]=e=>A(W)?W.value=e:null),title:C(Q)},{footer:x((()=>[["create","update"].includes(C(G))?(h(),T(f,{key:0,type:"primary",title:C(j)("action.save"),loading:C(z),onClick:u[16]||(u[16]=e=>ae(C(Y)))},null,8,["title","loading"])):U("",!0),w(f,{loading:C(z),title:C(j)("dialog.close"),onClick:u[17]||(u[17]=e=>W.value=!1)},null,8,["loading","title"])])),default:x((()=>[["create","update"].includes(C(G))?(h(),T(ie,{key:0,ref_key:"formRef",ref:Y,model:C($),rules:C(q),"label-width":"120px"},{default:x((()=>[w(X,{label:"配置名",prop:"name"},{default:x((()=>[w(D,{modelValue:C($).name,"onUpdate:modelValue":u[1]||(u[1]=e=>C($).name=e),placeholder:"请输入配置名"},null,8,["modelValue"])])),_:1}),w(X,{label:"备注",prop:"remark"},{default:x((()=>[w(D,{modelValue:C($).remark,"onUpdate:modelValue":u[2]||(u[2]=e=>C($).remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1}),w(X,{label:"存储器",prop:"storage"},{default:x((()=>[w(N,{modelValue:C($).storage,"onUpdate:modelValue":u[3]||(u[3]=e=>C($).storage=e),placeholder:"请选择存储器",disabled:0!==C($).id},{default:x((()=>[(h(!0),v(I,null,P(C(_)(C(g).INFRA_FILE_STORAGE),((e,a)=>(h(),T(L,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),C($).storage>=10&&C($).storage<=12?(h(),T(X,{key:0,label:"基础路径",prop:"config.basePath"},{default:x((()=>[w(D,{modelValue:C($).config.basePath,"onUpdate:modelValue":u[4]||(u[4]=e=>C($).config.basePath=e),placeholder:"请输入基础路径"},null,8,["modelValue"])])),_:1})):U("",!0),C($).storage>=11&&C($).storage<=12?(h(),T(X,{key:1,label:"主机地址",prop:"config.host"},{default:x((()=>[w(D,{modelValue:C($).config.host,"onUpdate:modelValue":u[5]||(u[5]=e=>C($).config.host=e),placeholder:"请输入主机地址"},null,8,["modelValue"])])),_:1})):U("",!0),C($).storage>=11&&C($).storage<=12?(h(),T(X,{key:2,label:"主机端口",prop:"config.port"},{default:x((()=>[w(le,{min:0,modelValue:C($).config.port,"onUpdate:modelValue":u[6]||(u[6]=e=>C($).config.port=e),placeholder:"请输入主机端口"},null,8,["modelValue"])])),_:1})):U("",!0),C($).storage>=11&&C($).storage<=12?(h(),T(X,{key:3,label:"用户名",prop:"config.username"},{default:x((()=>[w(D,{modelValue:C($).config.username,"onUpdate:modelValue":u[7]||(u[7]=e=>C($).config.username=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):U("",!0),C($).storage>=11&&C($).storage<=12?(h(),T(X,{key:4,label:"密码",prop:"config.password"},{default:x((()=>[w(D,{modelValue:C($).config.password,"onUpdate:modelValue":u[8]||(u[8]=e=>C($).config.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):U("",!0),11===C($).storage?(h(),T(X,{key:5,label:"连接模式",prop:"config.mode"},{default:x((()=>[w(te,{modelValue:C($).config.mode,"onUpdate:modelValue":u[9]||(u[9]=e=>C($).config.mode=e)},{default:x((()=>[w(oe,{key:"Active",label:"Active"},{default:x((()=>[R("主动模式")])),_:1}),w(oe,{key:"Passive",label:"Passive"},{default:x((()=>[R("主动模式")])),_:1})])),_:1},8,["modelValue"])])),_:1})):U("",!0),20===C($).storage?(h(),T(X,{key:6,label:"节点地址",prop:"config.endpoint"},{default:x((()=>[w(D,{modelValue:C($).config.endpoint,"onUpdate:modelValue":u[10]||(u[10]=e=>C($).config.endpoint=e),placeholder:"请输入节点地址"},null,8,["modelValue"])])),_:1})):U("",!0),20===C($).storage?(h(),T(X,{key:7,label:"存储 bucket",prop:"config.bucket"},{default:x((()=>[w(D,{modelValue:C($).config.bucket,"onUpdate:modelValue":u[11]||(u[11]=e=>C($).config.bucket=e),placeholder:"请输入 bucket"},null,8,["modelValue"])])),_:1})):U("",!0),20===C($).storage?(h(),T(X,{key:8,label:"accessKey",prop:"config.accessKey"},{default:x((()=>[w(D,{modelValue:C($).config.accessKey,"onUpdate:modelValue":u[12]||(u[12]=e=>C($).config.accessKey=e),placeholder:"请输入 accessKey"},null,8,["modelValue"])])),_:1})):U("",!0),20===C($).storage?(h(),T(X,{key:9,label:"accessSecret",prop:"config.accessSecret"},{default:x((()=>[w(D,{modelValue:C($).config.accessSecret,"onUpdate:modelValue":u[13]||(u[13]=e=>C($).config.accessSecret=e),placeholder:"请输入 accessSecret"},null,8,["modelValue"])])),_:1})):U("",!0),20===C($).storage?(h(),T(X,{key:10,label:"自定义域名"},{default:x((()=>[w(D,{modelValue:C($).config.domain,"onUpdate:modelValue":u[14]||(u[14]=e=>C($).config.domain=e),placeholder:"请输入自定义域名"},null,8,["modelValue"])])),_:1})):C($).storage?(h(),T(X,{key:11,label:"自定义域名",prop:"config.domain"},{default:x((()=>[w(D,{modelValue:C($).config.domain,"onUpdate:modelValue":u[15]||(u[15]=e=>C($).config.domain=e),placeholder:"请输入自定义域名"},null,8,["modelValue"])])),_:1})):U("",!0)])),_:1},8,["model","rules"])):U("",!0),"detail"===C(G)?(h(),T(re,{key:1,schema:C(O).detailSchema,data:C(Z)},null,8,["schema","data"])):U("",!0)])),_:1},8,["modelValue","title"])],64)}}});export{G as default};
