import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-63555901.js";import"./base-085523fd.js";import{E as t}from"./el-card-d8ab0074.js";import{E as s}from"./el-col-613bea3c.js";import{_ as o}from"./XButton-39866472.js";import{_ as a}from"./XTable.vue_vue_type_style_index_0_lang-9c560634.js";import{_ as r}from"./XTextButton-ab77381a.js";/* empty css               */import{_ as i}from"./DictTag.vue_vue_type_script_lang-a5ff2643.js";import{D as l}from"./dict-3e42505d.js";import{u as p}from"./useVxeCrudSchemas-8bec068b.js";import{A as m,d as n,r as u,C as d,o as f,a as c,w as _,f as j,i as v,l as y,k as x,t as g,h as b,e as C,M as h,v as T}from"./runtime-core.esm-bundler-ccc21fcd.js";import{b as w,a as k}from"./index-6d220aa9.js";import{c as D}from"./index-6ed5f261.js";import{b as E}from"./formCreate-a3356cdc.js";import{u as M}from"./vue-router-0864a153.js";import{u as B}from"./useMessage-5e709b20.js";import{u as I}from"./useXTable-bf420a68.js";import{E as R}from"./index-795de047.js";import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./Icon.vue_vue_type_script_setup_true_lang-4448c023.js";import"./propTypes-5cfdbdab.js";import"./index-7486e100.js";import"./aria-8fadfbe9.js";import"./focus-trap-f53979c5.js";import"./runtime-dom.esm-bundler-daa7e741.js";import"./index-4665dced.js";import"./index-7a379d2e.js";import"./is-a7957d81.js";import"./el-button-6b012e5e.js";import"./index-c2caee16.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./app-41ac77cd.js";import"./useI18n-56d4bc42.js";import"./useCache-d48cf6c5.js";import"./index-cf52a0ab.js";import"./el-message-7ddf9388.js";import"./download-20922b56.js";import"./XTextButton.vue_vue_type_style_index_0_scoped_0fcea4df_lang-41ab76b9.js";import"./color-a8b4eb58.js";import"./index-a7ef0ded.js";import"./el-notification-c7d5f4ea.js";import"./auth-2fa258a0.js";import"./cloneDeep-8298b498.js";import"./_flatRest-ac7abae6.js";import"./index-6f87c872.js";const S=m({primaryKey:"id",primaryType:null,action:!0,columns:[{title:"流程名称",field:"name"},{title:"流程分类",field:"category",dictType:l.BPM_MODEL_CATEGORY,dictClass:"number",table:{slots:{default:"category_default"}}},{title:"流程版本",field:"version",table:{slots:{default:"version_default"}}},{title:"流程描述",field:"description"}]}),{allSchemas:V}=p(S),X={key:0},A={key:1},L={class:"clearfix"},O={class:"el-icon-document"},P=C("div",{class:"clearfix"},[C("span",{class:"el-icon-picture-outline"},"流程图")],-1),Y=n({__name:"create",setup(p){const m=M(),n=B(),[S]=I({allSchemas:V,params:{suspensionState:1},getListApi:w,isList:!0}),Y=u(),F=u({rule:[],option:{}}),G=u(),K=async e=>{if(Y.value&&G.value){Y.value.btn.loading(!0);try{await D({processDefinitionId:G.value.id,variables:e}),n.success("发起流程成功"),m.go(-1)}finally{Y.value.btn.loading(!1)}}},U=u(null),q=u({prefix:"flowable"});return(p,n)=>{const u=i,w=R,D=r,M=a,B=o,I=d("form-create"),V=s,z=t,N=d("my-process-viewer"),W=e;return f(),c(W,null,{default:_((()=>[j(G)?(f(),v("div",A,[y(z,{class:"box-card"},{default:_((()=>[C("div",L,[C("span",O,"申请信息【"+g(j(G).name)+"】",1),y(B,{style:{float:"right"},type:"primary",preIcon:"ep:delete",title:"选择其它流程",onClick:n[0]||(n[0]=e=>G.value=void 0)})]),y(V,{span:16,offset:6,style:{"margin-top":"20px"}},{default:_((()=>[y(I,{rule:j(F).rule,api:j(Y),"onUpdate:api":n[1]||(n[1]=e=>h(Y)?Y.value=e:null),option:j(F).option,onSubmit:K},null,8,["rule","api","option"])])),_:1})])),_:1}),y(z,{class:"box-card"},{default:_((()=>[P,y(N,T({key:"designer",modelValue:j(U),"onUpdate:modelValue":n[2]||(n[2]=e=>h(U)?U.value=e:null),value:j(U)},j(q),{prefix:j(q).prefix}),null,16,["modelValue","value","prefix"])])),_:1})])):(f(),v("div",X,[y(M,{onRegister:j(S)},{category_default:_((({row:e})=>[y(u,{type:j(l).BPM_MODEL_CATEGORY,value:Number(null==e?void 0:e.category)},null,8,["type","value"])])),version_default:_((({row:e})=>[e?(f(),c(w,{key:0},{default:_((()=>[x("v"+g(e.version),1)])),_:2},1024)):b("",!0)])),actionbtns_default:_((({row:e})=>[y(D,{preIcon:"ep:plus",title:"选择",onClick:t=>(async e=>{G.value=e,10==e.formType?(E(F,e.formConf,e.formFields),k(e.id).then((e=>{U.value=e}))):e.formCustomCreatePath&&await m.push({path:e.formCustomCreatePath})})(e)},null,8,["onClick"])])),_:1},8,["onRegister"])]))])),_:1})}}});export{Y as default};
