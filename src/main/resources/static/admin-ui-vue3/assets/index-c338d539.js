import{_ as la,__tla as ta}from"./Descriptions-add071e6.js";import{d as ra,p as Y,r as k,f as Z,af as oa,A as sa,o as d,c as I,q as f,w as t,a,a1 as g,i as l,F as U,I as pa,k as R,j as m,t as C,dn as da,dp as ua,T as ia,D as na,E as _a,C as ca,a6 as ma,a5 as fa,H as ya,n as ha,M as ba,__tla as ka}from"./index-0f589822.js";import{E as va,__tla as Ia}from"./el-image-9c2dd802.js";import{__tla as Ua}from"./el-image-viewer-863e3dd0.js";import{E as Va,__tla as Ta}from"./el-tree-select-df2c08ac.js";import{h as wa,d as ga,c as Ca,t as Pa}from"./tree-f9b1893a.js";import{c as La,__tla as xa}from"./index-2b69f27f.js";import{a as Da,D as Fa,__tla as Sa}from"./dict-f9a1a53b.js";import{_ as Ea,__tla as Ra}from"./UploadImg-fe783aab.js";import{U as Na,__tla as ja}from"./UploadImgs-4f92341d.js";import{__tla as Ba}from"./UploadFile.vue_vue_type_style_index_0_scoped_5a2639f8_lang-77946e64.js";import{__tla as Oa}from"./DescriptionForm.vue_vue_type_script_setup_true_lang-fc21193d.js";import{__tla as qa}from"./OtherSettingsForm.vue_vue_type_script_setup_true_lang-8438943b.js";import{__tla as Aa}from"./el-text-1124a1da.js";import{__tla as Ha}from"./Dialog.vue_vue_type_style_index_0_lang-2d188c85.js";import{_ as N,__tla as Ma}from"./SkuList.vue_vue_type_script_setup_true_lang-8927b71a.js";import{b as Ya,__tla as Za}from"./spu.data-4698afe5.js";import{g as $a,__tla as za}from"./category-77c014e3.js";import{g as Ga,__tla as Ja}from"./brand-9d019f03.js";import{g as Ka,__tla as Qa}from"./index-1853e07d.js";import{u as Wa,__tla as Xa}from"./useCrudSchemas-9a73989a.js";import{u as ae,__tla as ee}from"./useMessage-45ab706e.js";import{r as c,__tla as le}from"./formRules-04f2a102.js";import{_ as te,__tla as re}from"./ProductAttributes.vue_vue_type_script_setup_true_lang-7003f5aa.js";import{_ as oe,__tla as se}from"./ProductPropertyAddForm.vue_vue_type_script_setup_true_lang-d0459cf7.js";let $,A,pe=Promise.all([(()=>{try{return ta}catch{}})(),(()=>{try{return ka}catch{}})(),(()=>{try{return Ia}catch{}})(),(()=>{try{return Ua}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return xa}catch{}})(),(()=>{try{return Sa}catch{}})(),(()=>{try{return Ra}catch{}})(),(()=>{try{return ja}catch{}})(),(()=>{try{return Ba}catch{}})(),(()=>{try{return Oa}catch{}})(),(()=>{try{return qa}catch{}})(),(()=>{try{return Aa}catch{}})(),(()=>{try{return Ha}catch{}})(),(()=>{try{return Ma}catch{}})(),(()=>{try{return Za}catch{}})(),(()=>{try{return za}catch{}})(),(()=>{try{return Ja}catch{}})(),(()=>{try{return Qa}catch{}})(),(()=>{try{return Xa}catch{}})(),(()=>{try{return ee}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return se}catch{}})()]).then(async()=>{$=ra({name:"ProductSpuBasicInfoForm",__name:"BasicInfoForm",props:{propFormData:{type:Object,default:()=>{}},activeName:Y.string.def(""),isDetail:Y.bool.def(!1)},emits:["update:activeName"],setup(y,{expose:u,emit:P}){const L=y,{allSchemas:x}=Wa(Ya),v=s=>{const o=[];da(s)?s.forEach(b=>{o.push(b.url)}):o.push(s),La({urlList:o})},D=ae(),V=k(),T=k(),i=k([]),h=k(),F=s=>{h.value.generateTableData(s)},r=Z({name:"",categoryId:null,keyword:"",unit:null,picUrl:"",sliderPicUrls:[],introduction:"",deliveryTemplateId:null,brandId:null,specType:!1,subCommissionType:!1,skus:[]}),z=Z({name:[c],categoryId:[c],keyword:[c],unit:[c],introduction:[c],picUrl:[c],sliderPicUrls:[c],deliveryTemplateId:[c],brandId:[c],specType:[c],subCommissionType:[c]});oa(()=>L.propFormData,s=>{var o;s&&(ua(r,s),r.sliderPicUrls=(o=s.sliderPicUrls)==null?void 0:o.map(b=>({url:b})),i.value=A(s))},{immediate:!0}),u({validate:async()=>{if(h.value.validateSku(),T)return await a(T).validate(s=>{if(!s)throw D.warning("\u5546\u54C1\u4FE1\u606F\u672A\u5B8C\u5584\uFF01\uFF01"),P("update:activeName","basicInfo"),new Error("\u5546\u54C1\u4FE1\u606F\u672A\u5B8C\u5584\uFF01\uFF01");Object.assign(L.propFormData,r)})}});const G=()=>{for(const s of r.skus)s.subCommissionFirstPrice=0,s.subCommissionSecondPrice=0},J=()=>{i.value=[],r.skus=[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,subCommissionFirstPrice:0,subCommissionSecondPrice:0}]},S=k([]),K=()=>{Ca(S.value,r.categoryId)||(r.categoryId=null,D.warning("\u5FC5\u987B\u9009\u62E9\u4E8C\u7EA7\u53CA\u4EE5\u4E0B\u8282\u70B9\uFF01\uFF01"))},j=k([]),B=k([]);return sa(async()=>{const s=await $a({});S.value=wa(s,"id","parentId"),j.value=await Ga(),B.value=await Ka()}),(s,o)=>{const b=ia,p=na,n=_a,Q=Va,O=ba,q=ca,E=ma,H=fa,W=ya,X=ha,aa=pa,M=va,ea=la;return d(),I(U,null,[y.isDetail?g("",!0):(d(),f(aa,{key:0,ref_key:"productSpuBasicInfoRef",ref:T,model:a(r),rules:a(z),"label-width":"120px"},{default:t(()=>[l(X,null,{default:t(()=>[l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:t(()=>[l(b,{modelValue:a(r).name,"onUpdate:modelValue":o[0]||(o[0]=e=>a(r).name=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u5206\u7C7B",prop:"categoryId"},{default:t(()=>[l(Q,{modelValue:a(r).categoryId,"onUpdate:modelValue":o[1]||(o[1]=e=>a(r).categoryId=e),data:a(S),props:a(ga),"check-strictly":"",class:"w-1/1","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B",onChange:K},null,8,["modelValue","data","props"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u5173\u952E\u5B57",prop:"keyword"},{default:t(()=>[l(b,{modelValue:a(r).keyword,"onUpdate:modelValue":o[2]||(o[2]=e=>a(r).keyword=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5173\u952E\u5B57"},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5355\u4F4D",prop:"unit"},{default:t(()=>[l(q,{modelValue:a(r).unit,"onUpdate:modelValue":o[3]||(o[3]=e=>a(r).unit=e),class:"w-1/1",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D"},{default:t(()=>[(d(!0),I(U,null,R(a(Da)(a(Fa).PRODUCT_UNIT),e=>(d(),f(O,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u7B80\u4ECB",prop:"introduction"},{default:t(()=>[l(b,{modelValue:a(r).introduction,"onUpdate:modelValue":o[4]||(o[4]=e=>a(r).introduction=e),rows:3,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u7B80\u4ECB",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u5C01\u9762\u56FE",prop:"picUrl"},{default:t(()=>[l(a(Ea),{modelValue:a(r).picUrl,"onUpdate:modelValue":o[5]||(o[5]=e=>a(r).picUrl=e),height:"80px"},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{span:24},{default:t(()=>[l(p,{label:"\u5546\u54C1\u8F6E\u64AD\u56FE",prop:"sliderPicUrls"},{default:t(()=>[l(a(Na),{modelValue:a(r).sliderPicUrls,"onUpdate:modelValue":o[6]||(o[6]=e=>a(r).sliderPicUrls=e)},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u8FD0\u8D39\u6A21\u677F",prop:"deliveryTemplateId"},{default:t(()=>[l(q,{modelValue:a(r).deliveryTemplateId,"onUpdate:modelValue":o[7]||(o[7]=e=>a(r).deliveryTemplateId=e),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(d(!0),I(U,null,R(a(B),e=>(d(),f(O,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u54C1\u724C",prop:"brandId"},{default:t(()=>[l(q,{modelValue:a(r).brandId,"onUpdate:modelValue":o[8]||(o[8]=e=>a(r).brandId=e),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(d(!0),I(U,null,R(a(j),e=>(d(),f(O,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5546\u54C1\u89C4\u683C",props:"specType"},{default:t(()=>[l(H,{modelValue:a(r).specType,"onUpdate:modelValue":o[9]||(o[9]=e=>a(r).specType=e),onChange:J},{default:t(()=>[l(E,{label:!1,class:"radio"},{default:t(()=>[m("\u5355\u89C4\u683C")]),_:1}),l(E,{label:!0},{default:t(()=>[m("\u591A\u89C4\u683C")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(n,{span:12},{default:t(()=>[l(p,{label:"\u5206\u9500\u7C7B\u578B",props:"subCommissionType"},{default:t(()=>[l(H,{modelValue:a(r).subCommissionType,"onUpdate:modelValue":o[10]||(o[10]=e=>a(r).subCommissionType=e),onChange:G},{default:t(()=>[l(E,{label:!1},{default:t(()=>[m("\u9ED8\u8BA4\u8BBE\u7F6E")]),_:1}),l(E,{label:!0,class:"radio"},{default:t(()=>[m("\u81EA\u884C\u8BBE\u7F6E")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(n,{span:24},{default:t(()=>[a(r).specType?g("",!0):(d(),f(p,{key:0},{default:t(()=>[l(a(N),{ref_key:"skuListRef",ref:h,"prop-form-data":a(r),propertyList:a(i)},null,8,["prop-form-data","propertyList"])]),_:1})),a(r).specType?(d(),f(p,{key:1,label:"\u5546\u54C1\u5C5E\u6027"},{default:t(()=>[l(W,{class:"mr-15px mb-10px",onClick:a(V).open},{default:t(()=>[m("\u6DFB\u52A0\u89C4\u683C")]),_:1},8,["onClick"]),l(a(te),{propertyList:a(i),onSuccess:F},null,8,["propertyList"])]),_:1})):g("",!0),a(r).specType&&a(i).length>0?(d(),I(U,{key:2},[l(p,{label:"\u6279\u91CF\u8BBE\u7F6E"},{default:t(()=>[l(a(N),{"is-batch":!0,"prop-form-data":a(r),propertyList:a(i)},null,8,["prop-form-data","propertyList"])]),_:1}),l(p,{label:"\u5C5E\u6027\u5217\u8868"},{default:t(()=>[l(a(N),{ref_key:"skuListRef",ref:h,"prop-form-data":a(r),propertyList:a(i)},null,8,["prop-form-data","propertyList"])]),_:1})],64)):g("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])),y.isDetail?(d(),f(ea,{key:1,data:a(r),schema:a(x).detailSchema},{categoryId:t(({row:e})=>{return[m(C((_=e.categoryId,Pa(S.value,_))),1)];var _}),brandId:t(({row:e})=>{var _;return[m(C((_=a(j).find(w=>w.id===e.brandId))==null?void 0:_.name),1)]}),deliveryTemplateId:t(({row:e})=>{var _;return[m(C((_=a(B).find(w=>w.id===e.deliveryTemplateId))==null?void 0:_.name),1)]}),specType:t(({row:e})=>[m(C(e.specType?"\u591A\u89C4\u683C":"\u5355\u89C4\u683C"),1)]),subCommissionType:t(({row:e})=>[m(C(e.subCommissionType?"\u81EA\u884C\u8BBE\u7F6E":"\u9ED8\u8BA4\u8BBE\u7F6E"),1)]),picUrl:t(({row:e})=>[l(M,{src:e.picUrl,class:"w-60px h-60px",onClick:_=>v(e.picUrl)},null,8,["src","onClick"])]),sliderPicUrls:t(({row:e})=>[(d(!0),I(U,null,R(e.sliderPicUrls,(_,w)=>(d(),f(M,{key:w,src:_.url,class:"w-60px h-60px mr-10px",onClick:de=>v(e.sliderPicUrls)},null,8,["src","onClick"]))),128))]),skus:t(()=>[l(a(N),{ref:"skuDetailListRef","is-detail":y.isDetail,"prop-form-data":a(r),propertyList:a(i)},null,8,["is-detail","prop-form-data","propertyList"])]),_:1},8,["data","schema"])):g("",!0),l(a(oe),{ref_key:"attributesAddFormRef",ref:V,propertyList:a(i)},null,8,["propertyList"])],64)}}}),A=y=>{var P;const u=[];return y.specType&&((P=y.skus)==null||P.forEach(L=>{var x;(x=L.properties)==null||x.forEach(({propertyId:v,propertyName:D,valueId:V,valueName:T})=>{var h,F;u!=null&&u.some(r=>r.id===v)||u.push({id:v,name:D,values:[]});const i=u==null?void 0:u.findIndex(r=>r.id===v);(h=u[i].values)!=null&&h.some(r=>r.id===V)||((F=u[i].values)==null||F.push({id:V,name:T}))})})),u}});export{$ as _,pe as __tla,A as g};
