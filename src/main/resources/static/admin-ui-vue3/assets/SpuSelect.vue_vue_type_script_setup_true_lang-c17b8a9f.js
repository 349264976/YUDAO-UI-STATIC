import{d as $,p as ee,r as n,A as ae,o as k,q as S,w as o,i as e,j as d,a,P as te,B as le,K as re,a1 as P,t as oe,ac as ne,x as ie,T as se,E as ue,G as pe,_ as ce,H as _e,n as de,J as me,L as fe,__tla as ve}from"./index-0f589822.js";import{_ as ye,__tla as he}from"./Dialog.vue_vue_type_style_index_0_lang-2d188c85.js";import{_ as ge,__tla as we}from"./ContentWrap.vue_vue_type_script_setup_true_lang-0f1e3633.js";import{_ as ke,__tla as Se}from"./index.vue_vue_type_script_setup_true_lang-75e3d81d.js";import{E as xe,__tla as be}from"./el-image-9c2dd802.js";import{__tla as Ve}from"./el-image-viewer-863e3dd0.js";import{E as Ce,__tla as Te}from"./el-tree-select-df2c08ac.js";import{g as Ue,__tla as De}from"./index-c338d539.js";import{d as Ie,__tla as ze}from"./formatTime-58783104.js";import{c as Le,__tla as Ne}from"./index-2b69f27f.js";import{h as Ye,d as Ee}from"./tree-f9b1893a.js";import{g as He,__tla as Ke}from"./category-77c014e3.js";import{g as Pe,b as Re,__tla as Be}from"./spu-3234a0da.js";import{u as Me,__tla as je}from"./useMessage-45ab706e.js";import{_ as qe,__tla as Ae}from"./SkuList.vue_vue_type_script_setup_true_lang-8927b71a.js";let R,Ge=Promise.all([(()=>{try{return ve}catch{}})(),(()=>{try{return he}catch{}})(),(()=>{try{return we}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return be}catch{}})(),(()=>{try{return Ve}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return De}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Ne}catch{}})(),(()=>{try{return Ke}catch{}})(),(()=>{try{return Be}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return Ae}catch{}})()]).then(async()=>{R=$({name:"PromotionSpuSelect",__name:"SpuSelect",props:{isSelectSku:ee.bool.def(!1)},emits:["confirm"],setup(C,{expose:B,emit:T}){const U=C,m=Me(),D=n(0),I=n([]),x=n(!1),c=n(!1),z=n(""),i=n({pageNo:1,pageSize:10,tabType:0,name:"",categoryId:null,createTime:[]}),b=n([]),V=n(),L=n(),f=n(),v=n(!1),y=n(),s=n(0),_=n([]),M=l=>{if(s.value===0)return m.warning("\u8BF7\u5148\u9009\u62E9\u5546\u54C1\u518D\u9009\u62E9\u76F8\u5E94\u7684\u89C4\u683C\uFF01\uFF01\uFF01"),void L.value.clearSelection();_.value=l.map(t=>t.id)},j=l=>{if(l.length!==0){if(s.value=l.map(t=>t.id)[0],_.value.length>0&&(_.value=[]),l.length>1)return V.value.clearSelection(),void V.value.toggleRowSelection(l.pop(),!0);N(l[0],l)}else s.value=0},N=async(l,t)=>{var p;if(s.value!==0){if(l.id!==s.value)return m.warning("\u4F60\u5DF2\u9009\u62E9\u5546\u54C1\u8BF7\u5148\u53D6\u6D88"),void(y.value=[s.value]);if(v.value&&((p=f.value)==null?void 0:p.id)===l.id)return}if(f.value={},b.value=[],v.value=!1,(t==null?void 0:t.length)===0)return void(y.value=[]);const g=await Pe(l.id);b.value=Ue(g),f.value=g,v.value=!0,y.value=[l.id]},q=()=>{s.value!==0?U.isSelectSku&&_.value.length===0?m.warning("\u6CA1\u6709\u9009\u62E9\u4EFB\u4F55\u5546\u54C1\u5C5E\u6027"):(U.isSelectSku?T("confirm",s.value,_.value):T("confirm",s.value),c.value=!1,s.value=0,_.value=[]):m.warning("\u6CA1\u6709\u9009\u62E9\u4EFB\u4F55\u5546\u54C1")};B({open:()=>{z.value="\u5546\u54C1\u9009\u62E9",c.value=!0}});const h=async()=>{x.value=!0;try{const l=await Re(i.value);I.value=l.list,D.value=l.total}finally{x.value=!1}},Y=()=>{h()},A=()=>{i.value={pageNo:1,pageSize:10,tabType:0,name:"",categoryId:null,createTime:[]},h()},E=n();return ae(async()=>{await h();const l=await He({});E.value=Ye(l,"id","parentId")}),(l,t)=>{const g=se,p=ue,G=Ce,J=pe,H=ce,w=_e,F=de,u=me,O=xe,Q=ke,W=ge,X=ye,Z=fe;return k(),S(X,{modelValue:a(c),"onUpdate:modelValue":t[6]||(t[6]=r=>ie(c)?c.value=r:null),appendToBody:!0,title:a(z),width:"70%"},{footer:o(()=>[e(w,{type:"primary",onClick:q},{default:o(()=>[d("\u786E \u5B9A")]),_:1}),e(w,{onClick:t[5]||(t[5]=r=>c.value=!1)},{default:o(()=>[d("\u53D6 \u6D88")]),_:1})]),default:o(()=>[e(W,null,{default:o(()=>[e(F,{gutter:20,class:"mb-10px"},{default:o(()=>[e(p,{span:6},{default:o(()=>[e(g,{modelValue:a(i).name,"onUpdate:modelValue":t[0]||(t[0]=r=>a(i).name=r),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",onKeyup:te(Y,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(p,{span:6},{default:o(()=>[e(G,{modelValue:a(i).categoryId,"onUpdate:modelValue":t[1]||(t[1]=r=>a(i).categoryId=r),data:a(E),props:a(Ee),"check-strictly":"",class:"w-1/1","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B"},null,8,["modelValue","data","props"])]),_:1}),e(p,{span:6},{default:o(()=>[e(J,{modelValue:a(i).createTime,"onUpdate:modelValue":t[2]||(t[2]=r=>a(i).createTime=r),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(p,{span:6},{default:o(()=>[e(w,{onClick:Y},{default:o(()=>[e(H,{class:"mr-5px",icon:"ep:search"}),d(" \u641C\u7D22 ")]),_:1}),e(w,{onClick:A},{default:o(()=>[e(H,{class:"mr-5px",icon:"ep:refresh"}),d(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1}),le((k(),S(a(re),{ref_key:"spuListRef",ref:V,data:a(I),"expand-row-keys":a(y),"row-key":"id",onExpandChange:N,onSelectionChange:j},{default:o(()=>[C.isSelectSku?(k(),S(u,{key:0,type:"expand",width:"30"},{default:o(()=>[a(v)?(k(),S(a(qe),{key:0,ref_key:"skuListRef",ref:L,isComponent:!0,isDetail:!0,"prop-form-data":a(f),"property-list":a(b),onSelectionChange:M},null,8,["prop-form-data","property-list"])):P("",!0)]),_:1})):P("",!0),e(u,{type:"selection",width:"55"}),e(u,{key:"id",align:"center",label:"\u5546\u54C1\u7F16\u53F7",prop:"id"}),e(u,{label:"\u5546\u54C1\u56FE","min-width":"80"},{default:o(({row:r})=>[e(O,{src:r.picUrl,class:"w-30px h-30px",onClick:Je=>{return K=r.picUrl,void Le({zIndex:99999999,urlList:[K]});var K}},null,8,["src","onClick"])]),_:1}),e(u,{"show-overflow-tooltip":!0,label:"\u5546\u54C1\u540D\u79F0","min-width":"300",prop:"name"}),e(u,{align:"center",label:"\u5546\u54C1\u552E\u4EF7","min-width":"90",prop:"price"},{default:o(({row:r})=>[d(oe(a(ne)(r.price)),1)]),_:1}),e(u,{align:"center",label:"\u9500\u91CF","min-width":"90",prop:"salesCount"}),e(u,{align:"center",label:"\u5E93\u5B58","min-width":"90",prop:"stock"}),e(u,{align:"center",label:"\u6392\u5E8F","min-width":"70",prop:"sort"}),e(u,{formatter:a(Ie),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"])]),_:1},8,["data","expand-row-keys"])),[[Z,a(x)]]),e(Q,{limit:a(i).pageSize,"onUpdate:limit":t[3]||(t[3]=r=>a(i).pageSize=r),page:a(i).pageNo,"onUpdate:page":t[4]||(t[4]=r=>a(i).pageNo=r),total:a(D),onPagination:h},null,8,["limit","page","total"])]),_:1})]),_:1},8,["modelValue","title"])}}})});export{R as _,Ge as __tla};
