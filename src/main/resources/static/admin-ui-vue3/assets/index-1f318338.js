import"./base-085523fd.js";import{E as e}from"./el-card-d8ab0074.js";import{E as s}from"./el-button-6b012e5e.js";import{E as a}from"./el-notification-c7d5f4ea.js";/* empty css               */import{d as t}from"./dayjs.min-65a6b1e4.js";import{a as l}from"./user-76f18df3.js";import{i as r}from"./aria-8fadfbe9.js";import{E as o}from"./index-795de047.js";import{d as i,r as m,A as d,b0 as n,c as u,o as c,i as p,l as f,w as j,e as v,f as h,k as x,t as b,M as w,F as y,z as g}from"./runtime-core.esm-bundler-ccc21fcd.js";import"./index-4665dced.js";import"./index-c2caee16.js";import"./runtime-dom.esm-bundler-daa7e741.js";import"./is-a7957d81.js";import"./focus-trap-f53979c5.js";import"./useI18n-56d4bc42.js";import"./useCache-d48cf6c5.js";import"./index-7a379d2e.js";import"./auth-2fa258a0.js";import"./index-ffcbf524.js";import"./index-a7ef0ded.js";import"./el-message-7ddf9388.js";import"./vue-router-0864a153.js";import"./cloneDeep-8298b498.js";import"./_flatRest-ac7abae6.js";const _={class:"flex"},V=v("div",{class:"card-header"},[v("span",null,"连接")],-1),k={class:"flex items-center"},D=v("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),E=v("hr",{class:"my-4"},null,-1),M={class:"flex"},Y=v("p",{class:"text-lg font-medium mt-4"},"设置",-1),L=v("hr",{class:"my-4"},null,-1),R=v("div",{class:"card-header"},[v("span",null,"消息记录")],-1),C={class:"max-h-80 overflow-auto"},U={class:"flex items-center"},z=v("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1),H=i({__name:"index",setup(i){const H=l(),I=m(""),N=m("http://localhost:48080/websocket/message".replace("http","ws")+"?userId="+H.getUser.id),O=d({recordList:[]}),{status:A,data:F,send:J,close:P,open:S}=r(N.value,{autoReconnect:!1,heartbeat:!0});n((()=>{if(F.value)try{const e=JSON.parse(F.value);O.recordList.push(e)}catch(e){O.recordList.push({res:F.value,id:Math.ceil(1e3*Math.random()),time:(new Date).getTime()})}}));const T=u((()=>"OPEN"===A.value)),Z=u((()=>T.value?"success":"red")),$=u((()=>[...O.recordList].reverse()));function q(){J(I.value),I.value=""}function B(){T.value?P():S()}return(l,r)=>{const i=o,m=a,d=s,n=e;return c(),p("div",_,[f(n,{class:"w-1/2",gutter:12,shadow:"always"},{header:j((()=>[V])),default:j((()=>[v("div",k,[D,f(i,{color:h(Z)},{default:j((()=>[x(b(h(A)),1)])),_:1},8,["color"])]),E,v("div",M,[f(m,{modelValue:h(N),"onUpdate:modelValue":r[0]||(r[0]=e=>w(N)?N.value=e:null),disabled:""},{prepend:j((()=>[x(" 服务地址 ")])),_:1},8,["modelValue"]),f(d,{type:h(T)?"danger":"primary",onClick:B},{default:j((()=>[x(b(h(T)?"关闭连接":"开启连接"),1)])),_:1},8,["type"])]),Y,L,f(m,{modelValue:h(I),"onUpdate:modelValue":r[1]||(r[1]=e=>w(I)?I.value=e:null),autosize:{minRows:2,maxRows:4},type:"textarea",disabled:!h(T),clearable:""},null,8,["modelValue","disabled"]),f(d,{type:"primary",block:"",class:"mt-4",disabled:!h(T),onClick:q},{default:j((()=>[x(" 发送 ")])),_:1},8,["disabled"])])),_:1}),f(n,{class:"w-1/2",gutter:12,shadow:"always"},{header:j((()=>[R])),default:j((()=>[v("div",C,[v("ul",null,[(c(!0),p(y,null,g(h($),(e=>(c(),p("li",{class:"mt-2",key:e.time},[v("div",U,[z,v("span",null,b(h(t)(e.time).format("YYYY-MM-DD HH:mm:ss")),1)]),v("div",null,b(e.res),1)])))),128))])])])),_:1})])}}});export{H as default};
