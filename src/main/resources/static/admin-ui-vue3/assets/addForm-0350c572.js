import{d as j,u as H,N as J,r as s,A as O,B as q,a as t,o as I,q as U,w as l,i as o,x as v,j as D,a1 as z,l as A,ac as d,ad as G,ae as y,y as L,z as K,H as Z,D as $,I as M,L as Q,__tla as W}from"./index-0f589822.js";import{_ as X,__tla as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-0f1e3633.js";import{u as tt,__tla as at}from"./tagsView-802591bb.js";import{_ as rt,__tla as et}from"./index-c338d539.js";import{_ as _t,__tla as ot}from"./DescriptionForm.vue_vue_type_script_setup_true_lang-fc21193d.js";import{_ as it,__tla as lt}from"./OtherSettingsForm.vue_vue_type_script_setup_true_lang-8438943b.js";import{__tla as ct}from"./el-text-1124a1da.js";import{u as st,__tla as mt}from"./useMessage-45ab706e.js";import{__tla as nt}from"./Dialog.vue_vue_type_style_index_0_lang-2d188c85.js";import{__tla as ut}from"./SkuList.vue_vue_type_script_setup_true_lang-8927b71a.js";import{g as pt,c as ft,u as dt,__tla as yt}from"./spu-3234a0da.js";import{__tla as ht}from"./el-card-bbdd700f.js";import{__tla as vt}from"./Descriptions-add071e6.js";import{__tla as Pt}from"./el-descriptions-item-41445509.js";import{__tla as bt}from"./DictTag.vue_vue_type_script_lang-9c2c480d.js";import"./color-a8b4eb58.js";import{__tla as kt}from"./dict-f9a1a53b.js";import"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as Ct}from"./el-image-9c2dd802.js";import{__tla as St}from"./el-image-viewer-863e3dd0.js";import{__tla as Ft}from"./el-tree-select-df2c08ac.js";import"./tree-f9b1893a.js";import{__tla as Nt}from"./index-2b69f27f.js";import{__tla as gt}from"./UploadImg-fe783aab.js";import{__tla as wt}from"./UploadImgs-4f92341d.js";import{__tla as It}from"./UploadFile.vue_vue_type_style_index_0_scoped_5a2639f8_lang-77946e64.js";import{__tla as Ut}from"./spu.data-4698afe5.js";import{__tla as Dt}from"./category-77c014e3.js";import{__tla as Rt}from"./brand-9d019f03.js";import{__tla as Et}from"./index-1853e07d.js";import{__tla as Vt}from"./useCrudSchemas-9a73989a.js";import{__tla as xt}from"./formRules-04f2a102.js";import{__tla as Bt}from"./ProductAttributes.vue_vue_type_script_setup_true_lang-7003f5aa.js";import{__tla as Tt}from"./property-e9306a35.js";import{__tla as jt}from"./ProductPropertyAddForm.vue_vue_type_script_setup_true_lang-d0459cf7.js";import{__tla as Ht}from"./style.css_vue_type_style_index_0_src_true_lang-317ea815.js";let R,Jt=Promise.all([(()=>{try{return W}catch{}})(),(()=>{try{return Y}catch{}})(),(()=>{try{return at}catch{}})(),(()=>{try{return et}catch{}})(),(()=>{try{return ot}catch{}})(),(()=>{try{return lt}catch{}})(),(()=>{try{return ct}catch{}})(),(()=>{try{return mt}catch{}})(),(()=>{try{return nt}catch{}})(),(()=>{try{return ut}catch{}})(),(()=>{try{return yt}catch{}})(),(()=>{try{return ht}catch{}})(),(()=>{try{return vt}catch{}})(),(()=>{try{return Pt}catch{}})(),(()=>{try{return bt}catch{}})(),(()=>{try{return kt}catch{}})(),(()=>{try{return Ct}catch{}})(),(()=>{try{return St}catch{}})(),(()=>{try{return Ft}catch{}})(),(()=>{try{return Nt}catch{}})(),(()=>{try{return gt}catch{}})(),(()=>{try{return wt}catch{}})(),(()=>{try{return It}catch{}})(),(()=>{try{return Ut}catch{}})(),(()=>{try{return Dt}catch{}})(),(()=>{try{return Rt}catch{}})(),(()=>{try{return Et}catch{}})(),(()=>{try{return Vt}catch{}})(),(()=>{try{return xt}catch{}})(),(()=>{try{return Bt}catch{}})(),(()=>{try{return Tt}catch{}})(),(()=>{try{return jt}catch{}})(),(()=>{try{return Ht}catch{}})()]).then(async()=>{R=j({name:"ProductSpuForm",__name:"addForm",setup(Ot){const{t:k}=A(),C=st(),{push:E,currentRoute:V}=H(),{params:S,name:x}=J(),{delView:B}=tt(),m=s(!1),_=s("basicInfo"),f=s(!1),F=s(),N=s(),g=s(),n=s({name:"",categoryId:null,keyword:"",unit:null,picUrl:"",sliderPicUrls:[],introduction:"",deliveryTemplateId:null,brandId:null,specType:!1,subCommissionType:!1,skus:[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,subCommissionFirstPrice:0,subCommissionSecondPrice:0}],description:"",sort:0,giveIntegral:0,virtualSalesCount:0,recommendHot:!1,recommendBenefit:!1,recommendBest:!1,recommendNew:!1,recommendGood:!1}),T=async()=>{var u,e,i;m.value=!0;try{await((u=t(F))==null?void 0:u.validate()),await((e=t(N))==null?void 0:e.validate()),await((i=t(g))==null?void 0:i.validate());const a=G(t(n.value));n.value.skus.forEach(r=>{if(r.barCode===""){const P=a.skus.findIndex(b=>JSON.stringify(b.properties)===JSON.stringify(r.properties));a.skus.splice(P,1)}}),a.skus.forEach(r=>{r.name=a.name,r.price=y(r.price),r.marketPrice=y(r.marketPrice),r.costPrice=y(r.costPrice),r.subCommissionFirstPrice=y(r.subCommissionFirstPrice),r.subCommissionSecondPrice=y(r.subCommissionSecondPrice)});const p=[];a.sliderPicUrls.forEach(r=>{typeof r=="object"?p.push(r.url):p.push(r)}),a.sliderPicUrls=p;const h=a;S.spuId?(await dt(h),C.success(k("common.updateSuccess"))):(await ft(h),C.success(k("common.createSuccess"))),w()}finally{m.value=!1}},w=()=>{B(t(V)),E("/product/product-spu")};return O(async()=>{await(async()=>{var e;x==="ProductSpuDetail"&&(f.value=!0);const u=S.spuId;if(u){m.value=!0;try{const i=await pt(u);(e=i.skus)==null||e.forEach(a=>{a.price=d(a.price),a.marketPrice=d(a.marketPrice),a.costPrice=d(a.costPrice),a.subCommissionFirstPrice=d(a.subCommissionFirstPrice),a.subCommissionSecondPrice=d(a.subCommissionSecondPrice)}),n.value=i}finally{m.value=!1}}})()}),(u,e)=>{const i=L,a=K,p=Z,h=$,r=M,P=X,b=Q;return q((I(),U(P,null,{default:l(()=>[o(a,{modelValue:t(_),"onUpdate:modelValue":e[3]||(e[3]=c=>v(_)?_.value=c:null)},{default:l(()=>[o(i,{label:"\u5546\u54C1\u4FE1\u606F",name:"basicInfo"},{default:l(()=>[o(t(rt),{ref_key:"basicInfoRef",ref:F,activeName:t(_),"onUpdate:activeName":e[0]||(e[0]=c=>v(_)?_.value=c:null),"is-detail":t(f),propFormData:t(n)},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(i,{label:"\u5546\u54C1\u8BE6\u60C5",name:"description"},{default:l(()=>[o(t(_t),{ref_key:"descriptionRef",ref:N,activeName:t(_),"onUpdate:activeName":e[1]||(e[1]=c=>v(_)?_.value=c:null),"is-detail":t(f),propFormData:t(n)},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(i,{label:"\u5176\u4ED6\u8BBE\u7F6E",name:"otherSettings"},{default:l(()=>[o(t(it),{ref_key:"otherSettingsRef",ref:g,activeName:t(_),"onUpdate:activeName":e[2]||(e[2]=c=>v(_)?_.value=c:null),"is-detail":t(f),propFormData:t(n)},null,8,["activeName","is-detail","propFormData"])]),_:1})]),_:1},8,["modelValue"]),o(r,null,{default:l(()=>[o(h,{style:{float:"right"}},{default:l(()=>[t(f)?z("",!0):(I(),U(p,{key:0,loading:t(m),type:"primary",onClick:T},{default:l(()=>[D(" \u4FDD\u5B58 ")]),_:1},8,["loading"])),o(p,{onClick:w},{default:l(()=>[D("\u8FD4\u56DE")]),_:1})]),_:1})]),_:1})]),_:1})),[[b,t(m)]])}}})});export{Jt as __tla,R as default};
