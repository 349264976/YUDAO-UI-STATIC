import{c as e}from"./aria-8fadfbe9.js";import{E as a,i as l}from"./el-image-viewer-f62c5b85.js";import{b as t,d as o,i as s,u as i,l as n,_ as r,y as u,$ as c,w as v}from"./base-085523fd.js";import{m as d}from"./is-a7957d81.js";import{u as f,c as p,k as m}from"./el-notification-c7d5f4ea.js";import{d as y,aX as g,r as w,c as h,m as k,x as b,o as z,i as x,v as S,f as j,h as E,n as $,j as C,e as I,t as L,F as B,a as O,w as _,s as A,D as T,b8 as F}from"./runtime-core.esm-bundler-ccc21fcd.js";const M=t({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:o([String,Object])},previewSrcList:{type:o(Array),default:()=>d([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),N={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>s(e),close:()=>!0,show:()=>!0},D=["src","loading"],P={key:0},R=y({name:"ElImage",inheritAttrs:!1});const Y=v(r(y({...R,props:M,emits:N,setup(t,{emit:o}){const s=t;let r="";const{t:v}=f(),d=i("image"),y=g(),M=p(),N=w(),R=w(!1),Y=w(!0),q=w(!1),H=w(),K=w(),X=n&&"loading"in HTMLImageElement.prototype;let G,J;const Q=h((()=>y.style)),U=h((()=>{const{fit:e}=s;return n&&e?{objectFit:e}:{}})),V=h((()=>{const{previewSrcList:e}=s;return Array.isArray(e)&&e.length>0})),W=h((()=>{const{previewSrcList:e,initialIndex:a}=s;let l=a;return a>e.length-1&&(l=0),l})),Z=h((()=>"eager"!==s.loading&&(!X&&"lazy"===s.loading||s.lazy))),ee=()=>{n&&(Y.value=!0,R.value=!1,N.value=s.src)};function ae(e){Y.value=!1,R.value=!1,o("load",e)}function le(e){Y.value=!1,R.value=!0,o("error",e)}function te(){l(H.value,K.value)&&(ee(),ie())}const oe=c(te,200);async function se(){var a;if(!n)return;await T();const{scrollContainer:l}=s;u(l)?K.value=l:F(l)&&""!==l?K.value=null!=(a=document.querySelector(l))?a:void 0:H.value&&(K.value=m(H.value)),K.value&&(G=e(K,"scroll",oe),setTimeout((()=>te()),100))}function ie(){n&&K.value&&oe&&(null==G||G(),K.value=void 0)}function ne(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function re(){V.value&&(J=e("wheel",ne,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",q.value=!0,o("show"))}function ue(){null==J||J(),document.body.style.overflow=r,q.value=!1,o("close")}function ce(e){o("switch",e)}return k((()=>s.src),(()=>{Z.value?(Y.value=!0,R.value=!1,ie(),se()):ee()})),b((()=>{Z.value?se():ee()})),(e,l)=>(z(),x("div",{ref_key:"container",ref:H,class:$([j(d).b(),e.$attrs.class]),style:A(j(Q))},[void 0===N.value||R.value?E("v-if",!0):(z(),x("img",S({key:0},j(M),{src:N.value,loading:e.loading,style:j(U),class:[j(d).e("inner"),j(V)&&j(d).e("preview"),Y.value&&j(d).is("loading")],onClick:re,onLoad:ae,onError:le}),null,16,D)),Y.value||R.value?(z(),x("div",{key:1,class:$(j(d).e("wrapper"))},[Y.value?C(e.$slots,"placeholder",{key:0},(()=>[I("div",{class:$(j(d).e("placeholder"))},null,2)])):R.value?C(e.$slots,"error",{key:1},(()=>[I("div",{class:$(j(d).e("error"))},L(j(v)("el.image.error")),3)])):E("v-if",!0)],2)):E("v-if",!0),j(V)?(z(),x(B,{key:2},[q.value?(z(),O(j(a),{key:0,"z-index":e.zIndex,"initial-index":j(W),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ue,onSwitch:ce},{default:_((()=>[e.$slots.viewer?(z(),x("div",P,[C(e.$slots,"viewer")])):E("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]));export{Y as E};
