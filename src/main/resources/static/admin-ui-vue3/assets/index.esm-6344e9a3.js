function t(t){return Array.prototype.concat.apply([],t)}var n=Object.prototype.toString,e=Object.prototype.hasOwnProperty;function r(t){return void 0===t}function o(t){return void 0!==t}function i(t){return null==t}function a(t){return"[object Array]"===n.call(t)}function c(t){return"[object Object]"===n.call(t)}function u(t){return"[object Number]"===n.call(t)}function s(t){var e=n.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function f(t){return"[object String]"===n.call(t)}function l(t){if(!a(t))throw new Error("must supply array")}function p(t,n){return e.call(t,n)}function h(t,n){var e;return n=A(n),d(t,(function(t,r){if(n(t,r))return e=t,!1})),e}function y(t,n){n=A(n);var e=a(t)?-1:void 0;return d(t,(function(t,r){if(n(t,r))return e=r,!1})),e}function v(t,n){var e=[];return d(t,(function(t,r){n(t,r)&&e.push(t)})),e}function d(t,n){var e;if(!r(t)){var o=a(t)?P:q;for(var i in t)if(p(t,i)&&!1===n(e=t[i],o(i)))return e}}function b(t,n){return r(t)?[]:(l(t),n=A(n),t.filter((function(t,e){return!n(t,e)})))}function x(t,n,e){return d(t,(function(t,r){e=n(e,t,r)})),e}function g(t,n){return!!x(t,(function(t,e,r){return t&&n(e,r)}),!0)}function m(t,n){return!!h(t,n)}function w(t,n){var e=[];return d(t,(function(t,r){e.push(n(t,r))})),e}function j(t){return t&&Object.keys(t)||[]}function C(t){return j(t).length}function S(t){return w(t,(function(t){return t}))}function O(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=F(n),d(t,(function(t){var r=n(t)||"_",o=e[r];o||(o=e[r]=[]),o.push(t)})),e}function k(t){t=F(t);for(var n={},e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return d(r,(function(e){return O(e,t,n)})),w(n,(function(t,n){return t[0]}))}var _=k;function E(t,n){n=F(n);var e=[];return d(t,(function(t,r){for(var o=n(t,r),i={d:o,v:t},a=0;a<e.length;a++){if(o<e[a].d)return void e.splice(a,0,i)}e.push(i)})),w(e,(function(t){return t.v}))}function M(t){return function(n){return g(t,(function(t,e){return n[e]===t}))}}function F(t){return s(t)?t:function(n){return n[t]}}function A(t){return s(t)?t:function(n){return n===t}}function q(t){return t}function P(t){return Number(t)}function T(t,n){var e,r,o,i;function a(e){var a=Date.now(),s=e?0:i+n-a;if(s>0)return c(s);t.apply(o,r),u()}function c(t){e=setTimeout(a,t)}function u(){e&&clearTimeout(e),e=i=r=o=void 0}function s(){i=Date.now();for(var t=arguments.length,a=new Array(t),u=0;u<t;u++)a[u]=arguments[u];r=a,o=this,e||c(n)}return s.flush=function(){e&&a(!0),u()},s.cancel=u,s}function N(t,n){return t.bind(n)}function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(){return G=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},G.apply(this,arguments)}function z(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return G.apply(void 0,[t].concat(e))}function B(t,n){var e={},r=Object(t);return d(n,(function(n){n in r&&(e[n]=t[n])})),e}function L(t,n){var e={};return d(Object(t),(function(t,r){-1===n.indexOf(r)&&(e[r]=t)})),e}const I=Object.freeze(Object.defineProperty({__proto__:null,assign:z,bind:N,debounce:T,ensureArray:l,every:g,filter:v,find:h,findIndex:y,flatten:t,forEach:d,get:function(t,n,e){var o=t;return d(n,(function(t){if(i(o))return o=void 0,!1;o=o[t]})),r(o)?e:o},groupBy:O,has:p,isArray:a,isDefined:o,isFunction:s,isNil:i,isNumber:u,isObject:c,isString:f,isUndefined:r,keys:j,map:w,matchPattern:M,merge:function t(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.length?(d(r,(function(e){e&&c(e)&&d(e,(function(e,r){if("__proto__"!==r){var o=n[r];c(e)?(c(o)||(o={}),n[r]=t(o,e)):n[r]=e}}))})),n):n},omit:L,pick:B,reduce:x,set:function(t,n,e){var a=t;return d(n,(function(t,c){if("number"!=typeof t&&"string"!=typeof t)throw new Error("illegal key type: "+D(t)+". Key should be of type number or string.");if("constructor"===t)throw new Error("illegal key: constructor");if("__proto__"===t)throw new Error("illegal key: __proto__");var u=n[c+1],s=a[t];o(u)&&i(s)&&(s=a[t]=isNaN(+u)?{}:[]),r(u)?r(e)?delete a[t]:a[t]=e:a=s})),t},size:C,some:m,sortBy:E,throttle:function(t,n){var e=!1;return function(){e||(t.apply(void 0,arguments),e=!0,setTimeout((function(){e=!1}),n))}},unionBy:_,uniqueBy:k,values:S,without:b},Symbol.toStringTag,{value:"Module"}));function R(t){return v(t,(function(n){return!h(t,(function(t){return t!==n&&H(n,t)}))}))}function H(t,n){if(n){if(t===n)return n;if(t.parent)return H(t.parent,n)}}function U(t,n,e){var r=!e||-1===t.indexOf(n);return r&&t.push(n),r}function $(t,n,e){e=e||0,a(t)||(t=[t]),d(t,(function(t,r){var o=n(t,r,e);a(o)&&o.length&&$(o,n,e+1)}))}function Q(t,n){return function(t,n,e){var r=[],o=[];return $(t,(function(t,i,a){U(r,t,n);var c=t.children;if((-1===e||a<e)&&c&&U(o,c,n))return c})),r}(t,!n,-1)}function V(t,n,e){r(n)&&(n=!0),c(n)&&(e=n,n=!0);var o=J((e=e||{}).allShapes),i=J(e.allConnections),a=J(e.enclosedElements),u=J(e.enclosedConnections),s=J(e.topLevel,n&&O(t,(function(t){return t.id})));function f(t){s[t.source.id]&&s[t.target.id]&&(s[t.id]=[t]),o[t.source.id]&&o[t.target.id]&&(u[t.id]=a[t.id]=t),i[t.id]=t}return $(t,(function(t){if(a[t.id]=t,!t.waypoints)return o[t.id]=t,d(t.incoming,f),d(t.outgoing,f),t.children;u[t.id]=i[t.id]=t})),{allShapes:o,allConnections:i,topLevel:s,enclosedConnections:u,enclosedElements:a}}function X(t,n){var e,r,o,i;return n=!!n,a(t)||(t=[t]),d(t,(function(t){var a=t;t.waypoints&&!n&&(a=X(t.waypoints,!0));var c=a.x,u=a.y,s=a.height||0,f=a.width||0;(c<e||void 0===e)&&(e=c),(u<r||void 0===r)&&(r=u),(c+f>o||void 0===o)&&(o=c+f),(u+s>i||void 0===i)&&(i=u+s)})),{x:e,y:r,height:i-r,width:o-e}}function Y(t,n){var e={};return d(t,(function(t){var r=t;r.waypoints&&(r=X(r)),!u(n.y)&&r.x>n.x&&(e[t.id]=t),!u(n.x)&&r.y>n.y&&(e[t.id]=t),r.x>n.x&&r.y>n.y&&(u(n.width)&&u(n.height)&&r.width+r.x<n.width+n.x&&r.height+r.y<n.height+n.y?e[t.id]=t:u(n.width)&&u(n.height)||(e[t.id]=t))})),e}function Z(t){return"waypoints"in t?"connection":"x"in t?"shape":"root"}function K(t){return!(!t||!t.isFrame)}function J(t,n){return z({},t||{},n||{})}function W(t,n){return t&&n?Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)):-1}function tt(t,n,e,r){if(void 0===r&&(r=5),!t||!n||!e)return!1;var o=(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x),i=W(t,n);return Math.abs(o/i)<=r}var nt=2;function et(t,n){var e;return function(t,n){var e;e=a(t)?t:[t,n];var r=e.slice().shift();return g(e,(function(t){return Math.abs(r.y-t.y)<=nt}))}(e=a(t)?t:[t,n])?"h":!!function(t,n){var e;e=a(t)?t:[t,n];var r=e.slice().shift();return g(e,(function(t){return Math.abs(r.x-t.x)<=nt}))}(e)&&"v"}function rt(t,n,e){return e=e||0,t.x>n.x-e&&t.y>n.y-e&&t.x<n.x+n.width+e&&t.y<n.y+n.height+e}function ot(t,n){return{x:Math.round(t.x+(n.x-t.x)/2),y:Math.round(t.y+(n.y-t.y)/2)}}var it=/,?([a-z]),?/gi,at=parseFloat,ct=Math,ut=ct.PI,st=ct.min,ft=ct.max,lt=ct.pow,pt=ct.abs,ht=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,yt=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/gi,vt=Array.isArray||function(t){return t instanceof Array};function dt(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function bt(t){if("function"==typeof t||Object(t)!==t)return t;var n=new t.constructor;for(var e in t)dt(t,e)&&(n[e]=bt(t[e]));return n}function xt(t){var n=xt.ps=xt.ps||{};return n[t]?n[t].sleep=100:n[t]={sleep:100},setTimeout((function(){for(var e in n)dt(n,e)&&e!=t&&(n[e].sleep--,!n[e].sleep&&delete n[e])})),n[t]}function gt(t,n,e,r){return 1===arguments.length&&(n=t.y,e=t.width,r=t.height,t=t.x),{x:t,y:n,width:e,height:r,x2:t+e,y2:n+r}}function mt(){return this.join(",").replace(it,"$1")}function wt(t){var n=bt(t);return n.toString=mt,n}function jt(t,n,e,r,o,i,a,c,u){var s=1-u,f=lt(s,3),l=lt(s,2),p=u*u*u,h=f*n+3*l*u*r+3*s*u*u*i+p*c;return{x:Et(f*t+3*l*u*e+3*s*u*u*o+p*a),y:Et(h)}}function Ct(t){var n=Nt.apply(null,t);return gt(n.x0,n.y0,n.x1-n.x0,n.y1-n.y0)}function St(t,n,e){return n>=t.x&&n<=t.x+t.width&&e>=t.y&&e<=t.y+t.height}function Ot(t,n,e,r,o){return t*(t*(-3*n+9*e-9*r+3*o)+6*n-12*e+6*r)-3*n+3*e}function kt(t,n,e,r,o,i,a,c,u){null==u&&(u=1);for(var s=(u=u>1?1:u<0?0:u)/2,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],l=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,h=0;h<12;h++){var y=s*f[h]+s,v=Ot(y,t,e,o,a),d=Ot(y,n,r,i,c),b=v*v+d*d;p+=l[h]*ct.sqrt(b)}return s*p}function _t(t,n,e,r,o,i,a,c){if(!(ft(t,e)<st(o,a)||st(t,e)>ft(o,a)||ft(n,r)<st(i,c)||st(n,r)>ft(i,c))){var u=(t*r-n*e)*(i-c)-(n-r)*(o*c-i*a),s=(t-e)*(i-c)-(n-r)*(o-a);if(s){var f=Et(((t*r-n*e)*(o-a)-(t-e)*(o*c-i*a))/s),l=Et(u/s),p=+f.toFixed(2),h=+l.toFixed(2);if(!(p<+st(t,e).toFixed(2)||p>+ft(t,e).toFixed(2)||p<+st(o,a).toFixed(2)||p>+ft(o,a).toFixed(2)||h<+st(n,r).toFixed(2)||h>+ft(n,r).toFixed(2)||h<+st(i,c).toFixed(2)||h>+ft(i,c).toFixed(2)))return{x:f,y:l}}}}function Et(t){return Math.round(1e11*t)/1e11}function Mt(t,n,e){if(!function(t,n){return t=gt(t),St(n=gt(n),t.x,t.y)||St(n,t.x2,t.y)||St(n,t.x,t.y2)||St(n,t.x2,t.y2)||St(t,n.x,n.y)||St(t,n.x2,n.y)||St(t,n.x,n.y2)||St(t,n.x2,n.y2)||(t.x<n.x2&&t.x>n.x||n.x<t.x2&&n.x>t.x)&&(t.y<n.y2&&t.y>n.y||n.y<t.y2&&n.y>t.y)}(Ct(t),Ct(n)))return e?0:[];for(var r=kt.apply(0,t),o=kt.apply(0,n),i=At(t)?1:~~(r/5)||1,a=At(n)?1:~~(o/5)||1,c=[],u=[],s={},f=e?0:[],l=0;l<i+1;l++){var p=jt.apply(0,t.concat(l/i));c.push({x:p.x,y:p.y,t:l/i})}for(l=0;l<a+1;l++)p=jt.apply(0,n.concat(l/a)),u.push({x:p.x,y:p.y,t:l/a});for(l=0;l<i;l++)for(var h=0;h<a;h++){var y,v=c[l],d=c[l+1],b=u[h],x=u[h+1],g=pt(d.x-v.x)<.01?"y":"x",m=pt(x.x-b.x)<.01?"y":"x",w=_t(v.x,v.y,d.x,d.y,b.x,b.y,x.x,x.y);if(w){if(s[y=w.x.toFixed(9)+"#"+w.y.toFixed(9)])continue;s[y]=!0;var j=v.t+pt((w[g]-v[g])/(d[g]-v[g]))*(d.t-v.t),C=b.t+pt((w[m]-b[m])/(x[m]-b[m]))*(x.t-b.t);j>=0&&j<=1&&C>=0&&C<=1&&(e?f++:f.push({x:w.x,y:w.y,t1:j,t2:C}))}}return f}function Ft(t){var n=xt(t);if(n.abs)return wt(n.abs);if(vt(t)&&vt(t&&t[0])||(t=function(t){if(!t)return null;var n=xt(t);if(n.arr)return bt(n.arr);var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return vt(t)&&vt(t[0])&&(r=bt(t)),r.length||String(t).replace(ht,(function(t,n,o){var i=[],a=n.toLowerCase();for(o.replace(yt,(function(t,n){n&&i.push(+n)})),"m"==a&&i.length>2&&(r.push([n].concat(i.splice(0,2))),a="l",n="m"==n?"l":"L");i.length>=e[a]&&(r.push([n].concat(i.splice(0,e[a]))),e[a]););})),r.toString=xt.toString,n.arr=bt(r),r}(t)),!t||!t.length)return[["M",0,0]];var e,r=[],o=0,i=0,a=0,c=0,u=0;"M"==t[0][0]&&(a=o=+t[0][1],c=i=+t[0][2],u++,r[0]=["M",o,i]);for(var s,f,l=u,p=t.length;l<p;l++){if(r.push(s=[]),(e=(f=t[l])[0])!=e.toUpperCase())switch(s[0]=e.toUpperCase(),s[0]){case"A":s[1]=f[1],s[2]=f[2],s[3]=f[3],s[4]=f[4],s[5]=f[5],s[6]=+f[6]+o,s[7]=+f[7]+i;break;case"V":s[1]=+f[1]+i;break;case"H":s[1]=+f[1]+o;break;case"M":a=+f[1]+o,c=+f[2]+i;default:for(var h=1,y=f.length;h<y;h++)s[h]=+f[h]+(h%2?o:i)}else for(var v=0,d=f.length;v<d;v++)s[v]=f[v];switch(e=e.toUpperCase(),s[0]){case"Z":o=+a,i=+c;break;case"H":o=s[1];break;case"V":i=s[1];break;case"M":a=s[s.length-2],c=s[s.length-1];default:o=s[s.length-2],i=s[s.length-1]}}return r.toString=mt,n.abs=wt(r),r}function At(t){return t[0]===t[2]&&t[1]===t[3]&&t[4]===t[6]&&t[5]===t[7]}function qt(t,n,e,r){return[t,n,e,r,e,r]}function Pt(t,n,e,r,o,i){var a=1/3,c=2/3;return[a*t+c*e,a*n+c*r,a*o+c*e,a*i+c*r,o,i]}function Tt(t,n,e,r,o,i,a,c,u,s){var f,l,p=120*ut/180,h=ut/180*(+o||0),y=[],v=(l=function(t,n,e){return{x:t*ct.cos(e)-n*ct.sin(e),y:t*ct.sin(e)+n*ct.cos(e)}},function t(){var n=Array.prototype.slice.call(arguments,0),e=n.join("␀"),r=t.cache=t.cache||{},o=t.count=t.count||[];return dt(r,e)?(function(t,n){for(var e=0,r=t.length;e<r;e++)if(t[e]===n)return t.push(t.splice(e,1)[0])}(o,e),r[e]):(o.length>=1e3&&delete r[o.shift()],o.push(e),r[e]=l.apply(0,n),r[e])});if(s)S=s[0],O=s[1],j=s[2],C=s[3];else{t=(f=v(t,n,-h)).x,n=f.y;var d=(t-(c=(f=v(c,u,-h)).x))/2,b=(n-(u=f.y))/2,x=d*d/(e*e)+b*b/(r*r);x>1&&(e*=x=ct.sqrt(x),r*=x);var g=e*e,m=r*r,w=(i==a?-1:1)*ct.sqrt(pt((g*m-g*b*b-m*d*d)/(g*b*b+m*d*d))),j=w*e*b/r+(t+c)/2,C=w*-r*d/e+(n+u)/2,S=ct.asin(((n-C)/r).toFixed(9)),O=ct.asin(((u-C)/r).toFixed(9));(S=t<j?ut-S:S)<0&&(S=2*ut+S),(O=c<j?ut-O:O)<0&&(O=2*ut+O),a&&S>O&&(S-=2*ut),!a&&O>S&&(O-=2*ut)}var k=O-S;if(pt(k)>p){var _=O,E=c,M=u;O=S+p*(a&&O>S?1:-1),y=Tt(c=j+e*ct.cos(O),u=C+r*ct.sin(O),e,r,o,0,a,E,M,[O,_,j,C])}k=O-S;var F=ct.cos(S),A=ct.sin(S),q=ct.cos(O),P=ct.sin(O),T=ct.tan(k/4),N=4/3*e*T,D=4/3*r*T,G=[t,n],z=[t+N*A,n-D*F],B=[c+N*P,u-D*q],L=[c,u];if(z[0]=2*G[0]-z[0],z[1]=2*G[1]-z[1],s)return[z,B,L].concat(y);for(var I=[],R=0,H=(y=[z,B,L].concat(y).join().split(",")).length;R<H;R++)I[R]=R%2?v(y[R-1],y[R],h).y:v(y[R],y[R+1],h).x;return I}function Nt(t,n,e,r,o,i,a,c){for(var u,s,f,l,p,h,y,v,d=[],b=[[],[]],x=0;x<2;++x)if(0==x?(s=6*t-12*e+6*o,u=-3*t+9*e-9*o+3*a,f=3*e-3*t):(s=6*n-12*r+6*i,u=-3*n+9*r-9*i+3*c,f=3*r-3*n),pt(u)<1e-12){if(pt(s)<1e-12)continue;0<(l=-f/s)&&l<1&&d.push(l)}else y=s*s-4*f*u,v=ct.sqrt(y),y<0||(0<(p=(-s+v)/(2*u))&&p<1&&d.push(p),0<(h=(-s-v)/(2*u))&&h<1&&d.push(h));for(var g,m=d.length,w=m;m--;)g=1-(l=d[m]),b[0][m]=g*g*g*t+3*g*g*l*e+3*g*l*l*o+l*l*l*a,b[1][m]=g*g*g*n+3*g*g*l*r+3*g*l*l*i+l*l*l*c;return b[0][w]=t,b[1][w]=n,b[0][w+1]=a,b[1][w+1]=c,b[0].length=b[1].length=w+2,{x0:st.apply(0,b[0]),y0:st.apply(0,b[1]),x1:ft.apply(0,b[0]),y1:ft.apply(0,b[1])}}function Dt(t){var n=xt(t);if(n.curve)return wt(n.curve);for(var e=Ft(t),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(t,n,e){var r,o;if(!t)return["C",n.x,n.y,n.x,n.y,n.x,n.y];switch(!(t[0]in{T:1,Q:1})&&(n.qx=n.qy=null),t[0]){case"M":n.X=t[1],n.Y=t[2];break;case"A":t=["C"].concat(Tt.apply(0,[n.x,n.y].concat(t.slice(1))));break;case"S":"C"==e||"S"==e?(r=2*n.x-n.bx,o=2*n.y-n.by):(r=n.x,o=n.y),t=["C",r,o].concat(t.slice(1));break;case"T":"Q"==e||"T"==e?(n.qx=2*n.x-n.qx,n.qy=2*n.y-n.qy):(n.qx=n.x,n.qy=n.y),t=["C"].concat(Pt(n.x,n.y,n.qx,n.qy,t[1],t[2]));break;case"Q":n.qx=t[1],n.qy=t[2],t=["C"].concat(Pt(n.x,n.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(qt(n.x,n.y,t[1],t[2]));break;case"H":t=["C"].concat(qt(n.x,n.y,t[1],n.y));break;case"V":t=["C"].concat(qt(n.x,n.y,n.x,t[1]));break;case"Z":t=["C"].concat(qt(n.x,n.y,n.X,n.Y))}return t},i=function(t,n){if(t[n].length>7){t[n].shift();for(var r=t[n];r.length;)a[n]="A",t.splice(n++,0,["C"].concat(r.splice(0,6)));t.splice(n,1),f=e.length}},a=[],c="",u="",s=0,f=e.length;s<f;s++){e[s]&&(c=e[s][0]),"C"!=c&&(a[s]=c,s&&(u=a[s-1])),e[s]=o(e[s],r,u),"A"!=a[s]&&"C"==c&&(a[s]="C"),i(e,s);var l=e[s],p=l.length;r.x=l[p-2],r.y=l[p-1],r.bx=at(l[p-4])||r.x,r.by=at(l[p-3])||r.y}return n.curve=wt(e),e}const Gt=function(t,n,e){t=Dt(t),n=Dt(n);for(var r,o,i,a,c,u,s,f,l,p,h=e?0:[],y=0,v=t.length;y<v;y++){var d=t[y];if("M"==d[0])r=c=d[1],o=u=d[2];else{"C"==d[0]?(l=[r,o].concat(d.slice(1)),r=l[6],o=l[7]):(l=[r,o,r,o,c,u,c,u],r=c,o=u);for(var b=0,x=n.length;b<x;b++){var g=n[b];if("M"==g[0])i=s=g[1],a=f=g[2];else{"C"==g[0]?(p=[i,a].concat(g.slice(1)),i=p[6],a=p[7]):(p=[i,a,i,a,s,f,s,f],i=s,a=f);var m=Mt(l,p,e);if(e)h+=m;else{for(var w=0,j=m.length;w<j;w++)m[w].segment1=y,m[w].segment2=b,m[w].bez1=l,m[w].bez2=p;h=h.concat(m)}}}}}return h};function zt(t){return{x:Math.round(t.x),y:Math.round(t.y),width:Math.round(t.width),height:Math.round(t.height)}}function Bt(t){return{x:Math.round(t.x),y:Math.round(t.y)}}function Lt(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}function It(t){return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}function Rt(t){return Bt({x:t.x+(t.width||0)/2,y:t.y+(t.height||0)/2})}function Ht(t,n,e){c(e=e||0)||(e={x:e,y:e});var r=Lt(t),o=Lt(n),i=r.bottom+e.y<=o.top,a=r.left-e.x>=o.right,u=r.top-e.y>=o.bottom,s=i?"top":u?"bottom":null,f=r.right+e.x<=o.left?"left":a?"right":null;return f&&s?s+"-"+f:f||s||"intersect"}function Ut(t,n,e){var r=Gt(t,n);return 1===r.length||2===r.length&&W(r[0],r[1])<1?Bt(r[0]):r.length>1?Bt((r=E(r,(function(t){var n=Math.floor(100*t.t2)||1;return n=((n=100-n)<10?"0":"")+n,t.segment2+"#"+n})))[e?0:r.length-1]):null}function $t(t){t=t.slice();for(var n,e,r,o=0;t[o];)n=t[o],e=t[o-1],0===W(n,r=t[o+1])||tt(e,r,n)?t.splice(o,1):o++;return t}function Qt(t,n){var e=Xt(t);return e&&"function"==typeof e.$instanceOf&&e.$instanceOf(n)}function Vt(t,n){return m(n,(function(n){return Qt(t,n)}))}function Xt(t){return t&&t.businessObject||t}function Yt(t){return!Qt(t,"bpmn:CallActivity")&&(Qt(t,"bpmn:SubProcess")?Xt(t).di&&!!Xt(t).di.isExpanded:!Qt(t,"bpmn:Participant")||!!Xt(t).processRef)}function Zt(t){return t&&!1!==Xt(t).isInterrupting}function Kt(t){return t&&!!Xt(t).triggeredByEvent}function Jt(t,n){var e=Xt(t),r=!1;return e.eventDefinitions&&d(e.eventDefinitions,(function(t){Qt(t,n)&&(r=!0)})),r}function Wt(t){return Jt(t,"bpmn:ErrorEventDefinition")}function tn(t){return Jt(t,"bpmn:EscalationEventDefinition")}function nn(t){return Jt(t,"bpmn:CompensateEventDefinition")}function en(t,n){for("string"==typeof n&&(n=[n]);t=t.parent;)if(Vt(t,n))return t;return null}var rn=Math.max,on=Math.min,an=20;function cn(t,n){return{top:t.top-n.top,right:t.right-n.right,bottom:t.bottom-n.bottom,left:t.left-n.left}}function un(t,n,e){var r=e.x,o=e.y,i={x:t.x,y:t.y,width:t.width,height:t.height};return-1!==n.indexOf("n")?(i.y=t.y+o,i.height=t.height-o):-1!==n.indexOf("s")&&(i.height=t.height+o),-1!==n.indexOf("e")?i.width=t.width+r:-1!==n.indexOf("w")&&(i.x=t.x+r,i.width=t.width-r),i}function sn(t,n,e){var r=n[t],o=e.min&&e.min[t],i=e.max&&e.max[t];return u(o)&&(r=(/top|left/.test(t)?on:rn)(r,o)),u(i)&&(r=(/top|left/.test(t)?rn:on)(r,i)),r}function fn(t,n){if(!n)return t;var e=Lt(t);return It({top:sn("top",e,n),right:sn("right",e,n),bottom:sn("bottom",e,n),left:sn("left",e,n)})}function ln(t,n,e,r){var o=Lt(n),i={top:/n/.test(t)?o.bottom-e.height:o.top,left:/w/.test(t)?o.right-e.width:o.left,bottom:/s/.test(t)?o.top+e.height:o.bottom,right:/e/.test(t)?o.left+e.width:o.right},a=r?Lt(r):i;return It({top:on(i.top,a.top),left:on(i.left,a.left),bottom:rn(i.bottom,a.bottom),right:rn(i.right,a.right)})}function pn(t,n){return void 0!==t?t:an}function hn(t){return!t.waypoints&&"label"!==t.type}function yn(t,n){var e;if((e=void 0===t.length?v(t.children,hn):t).length)return function(t,n){var e,r,o,i;return"object"==typeof n?(e=pn(n.left),r=pn(n.right),o=pn(n.top),i=pn(n.bottom)):e=r=o=i=pn(n),{x:t.x-e,y:t.y-o,width:t.width+e+r,height:t.height+o+i}}(X(e),n)}var vn=Math.abs;var dn=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],bn=30;function xn(t,n){return n=n||[],t.children.filter((function(t){Qt(t,"bpmn:Lane")&&(xn(t,n),n.push(t))})),n}function gn(t){return t.children.filter((function(t){return Qt(t,"bpmn:Lane")}))}function mn(t){return en(t,dn)||t}function wn(t,n){var e=mn(t),r=xn(e,Qt(e,"bpmn:Process")?[]:[e]),o=Lt(t),i=Lt(n),a=function(t,n){return cn(Lt(n),Lt(t))}(t,n),c=[];return r.forEach((function(n){if(n!==t){var e,r,u=0,s=a.right,f=0,l=a.left,p=Lt(n);a.top&&(vn(p.bottom-o.top)<10&&(f=i.top-p.bottom),vn(p.top-o.top)<5&&(u=i.top-p.top)),a.bottom&&(vn(p.top-o.bottom)<10&&(u=i.bottom-p.top),vn(p.bottom-o.bottom)<5&&(f=i.bottom-p.bottom)),(u||s||f||l)&&c.push({shape:n,newBounds:(e=n,r={top:u,right:s,bottom:f,left:l},{x:e.x+(r.left||0),y:e.y+(r.top||0),width:e.width-(r.left||0)+(r.right||0),height:e.height-(r.top||0)+(r.bottom||0)})})}})),c}function jn(t,n,e,r,o,i,a,c){this._palette=t,this._create=n,this._elementFactory=e,this._spaceTool=r,this._lassoTool=o,this._handTool=i,this._globalConnect=a,this._translate=c,t.registerProvider(this)}jn.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],jn.prototype.getPaletteEntries=function(t){var n={},e=this._create,r=this._elementFactory,o=this._spaceTool,i=this._lassoTool,a=this._handTool,c=this._globalConnect,u=this._translate;function s(t,n,o,i,a){function c(n){var o=r.createShape(z({type:t},a));a&&(o.businessObject.di.isExpanded=a.isExpanded),e.start(n,o)}var s=t.replace(/^bpmn:/,"");return{group:n,className:o,title:i||u("Create {type}",{type:s}),action:{dragstart:c,click:c}}}function f(t){var n=r.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),o=r.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:n});e.start(t,[n,o],{hints:{autoSelect:[n]}})}function l(t){e.start(t,r.createParticipantShape())}return z(n,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:u("Activate the hand tool"),action:{click:function(t){a.activateHand(t)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:u("Activate the lasso tool"),action:{click:function(t){i.activateSelection(t)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:u("Activate the create/remove space tool"),action:{click:function(t){o.activateSelection(t)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:u("Activate the global connect tool"),action:{click:function(t){c.start(t)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":s("bpmn:StartEvent","event","bpmn-icon-start-event-none",u("Create StartEvent")),"create.intermediate-event":s("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",u("Create Intermediate/Boundary Event")),"create.end-event":s("bpmn:EndEvent","event","bpmn-icon-end-event-none",u("Create EndEvent")),"create.exclusive-gateway":s("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",u("Create Gateway")),"create.task":s("bpmn:Task","activity","bpmn-icon-task",u("Create Task")),"create.data-object":s("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",u("Create DataObjectReference")),"create.data-store":s("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",u("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:u("Create expanded SubProcess"),action:{dragstart:f,click:f}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:u("Create Pool/Participant"),action:{dragstart:l,click:l}},"create.group":s("bpmn:Group","artifact","bpmn-icon-group",u("Create Group"))}),n};const Cn=Object.prototype.toString,Sn=Object.prototype.hasOwnProperty;function On(t){return"[object Array]"===Cn.call(t)}function kn(t){return"[object Object]"===Cn.call(t)}function _n(t){const n=Cn.call(t);return"[object Function]"===n||"[object AsyncFunction]"===n||"[object GeneratorFunction]"===n||"[object AsyncGeneratorFunction]"===n||"[object Proxy]"===n}function En(t,n){return Sn.call(t,n)}function Mn(t,n){let e;return n=function(t){return _n(t)?t:n=>n===t}(n),Fn(t,(function(t,r){if(n(t,r))return e=t,!1})),e}function Fn(t,n){let e,r;if(void 0===t)return;const o=On(t)?Pn:qn;for(let i in t)if(En(t,i)&&(e=t[i],r=n(e,o(i)),!1===r))return e}function An(t,n){return!!Mn(t,n)}function qn(t){return t}function Pn(t){return Number(t)}function Tn(t,...n){return Object.assign(t,...n)}export{yn as $,M as A,o as B,E as C,Ht as D,Vt as E,t as F,S as G,O as H,It as I,W as J,Gt as K,ot as L,et as M,$t as N,tt as O,i as P,Ut as Q,w as R,C as S,R as T,$ as U,Xt as V,r as W,gn as X,un as Y,fn as Z,zt as _,z as a,ln as a0,Jt as a1,en as a2,mn as a3,Bt as a4,Q as a5,xn as a6,Zt as a7,Wt as a8,tn as a9,nn as aa,k as ab,_ as ac,V as ad,j as ae,bn as af,wn as ag,cn as ah,b as ai,rt as aj,Y as ak,jn as al,I as am,kn as an,_n as ao,An as ap,Tn as aq,On as ar,Fn as as,a as b,N as c,T as d,d as e,h as f,g,X as h,K as i,Lt as j,Z as k,u as l,s as m,f as n,c as o,B as p,y as q,x as r,v as s,p as t,L as u,Qt as v,m as w,Yt as x,Kt as y,Rt as z};
