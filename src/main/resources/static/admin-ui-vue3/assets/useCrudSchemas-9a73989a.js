import{f as Y,l as I,bQ as P,h as A,__tla as H}from"./index-0f589822.js";import{e as S,a as M,f as g}from"./tree-f9b1893a.js";import{b as C,a as x,g as N,__tla as Q}from"./dict-f9a1a53b.js";import{_ as j,__tla as k}from"./DictTag.vue_vue_type_script_lang-9c2c480d.js";let D,q=Promise.all([(()=>{try{return H}catch{}})(),(()=>{try{return Q}catch{}})(),(()=>{try{return k}catch{}})()]).then(async()=>{let y,T,w,F,v,_;({t:y}=I()),D=l=>{const o=Y({searchSchema:[],tableColumns:[],formSchema:[],detailSchema:[]}),a=T(l,o);o.searchSchema=a||[];const s=w(l);o.tableColumns=s||[];const t=F(l,o);o.formSchema=t;const r=v(l);return o.detailSchema=r,{allSchemas:o}},T=(l,o)=>{const a=[],s=[];S(l,t=>{var r,m,d,p;if(t!=null&&t.isSearch||(r=t.search)!=null&&r.show){let u=((m=t==null?void 0:t.search)==null?void 0:m.component)||"Input";const f=[];let h={};if(t.dictType){const n={label:"\u5168\u90E8",value:""};f.push(n),C(t.dictType).forEach(c=>{f.push(c)}),h={options:f},(d=t.search)!=null&&d.component||(u="Select")}const e={component:u,componentProps:h,...t.search,field:t.field,label:((p=t.search)==null?void 0:p.label)||t.label};e.api&&s.push(async()=>{var c;const n=await e.api();if(n){const i=P(o.searchSchema,b=>b.field===e.field);i!==-1&&(o.searchSchema[i].componentProps.options=_(n,(c=e.componentProps.optionsAlias)==null?void 0:c.labelField))}}),delete e.show,a.push(e)}});for(const t of s)t();return a},w=l=>{const o=M(l,{conversion:a=>{var s;if((a==null?void 0:a.isTable)!==!1&&((s=a==null?void 0:a.table)==null?void 0:s.show)!==!1)return!a.formatter&&a.dictType&&(a.formatter=(t,r,m)=>A(j,{type:a.dictType,value:m})),{...a.table,...a}}});return g(o,a=>(a.children===void 0&&delete a.children,!!a.field))},F=(l,o)=>{const a=[],s=[];S(l,t=>{var r,m,d,p,u;if((t==null?void 0:t.isForm)!==!1&&((r=t==null?void 0:t.form)==null?void 0:r.show)!==!1){let f=((m=t==null?void 0:t.form)==null?void 0:m.component)||"Input",h="";(d=t.form)!=null&&d.value?h=(p=t.form)==null?void 0:p.value:f==="InputNumber"&&(h=0);let e={};if(t.dictType){const c=[];t.dictClass&&t.dictClass==="number"?x(t.dictType).forEach(i=>{c.push(i)}):t.dictClass&&t.dictClass==="boolean"?N(t.dictType).forEach(i=>{c.push(i)}):C(t.dictType).forEach(i=>{c.push(i)}),e={options:c},t.form&&t.form.component||(f="Select")}const n={component:f,componentProps:e,value:h,...t.form,field:t.field,label:((u=t.form)==null?void 0:u.label)||t.label};n.api&&s.push(async()=>{var i;const c=await n.api();if(c){const b=P(o.formSchema,E=>E.field===n.field);b!==-1&&(o.formSchema[b].componentProps.options=_(c,(i=n.componentProps.optionsAlias)==null?void 0:i.labelField))}}),delete n.show,a.push(n)}});for(const t of s)t();return a},v=l=>{const o=[];return S(l,a=>{var s,t,r,m,d;if((a==null?void 0:a.isDetail)!==!1&&((s=a.detail)==null?void 0:s.show)!==!1){const p={...a.detail,field:a.field,label:((t=a.detail)==null?void 0:t.label)||a.label};a.dictType&&(p.dictType=a.dictType),((r=a.detail)!=null&&r.dateFormat||a.formatter=="formatDate")&&(p.dateFormat=(m=a==null?void 0:a.detail)!=null&&m.dateFormat?(d=a==null?void 0:a.detail)==null?void 0:d.dateFormat:"YYYY-MM-DD HH:mm:ss"),delete p.show,o.push(p)}}),o},_=(l,o)=>l==null?void 0:l.map(a=>(o?a.labelField=y(a.labelField):a.label=y(a.label),a))});export{q as __tla,D as u};
