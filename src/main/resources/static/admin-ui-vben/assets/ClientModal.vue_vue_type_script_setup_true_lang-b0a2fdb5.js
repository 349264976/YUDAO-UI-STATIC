import{cm as s,a as b,c as _,z as x,k as t,o as w,j as y,w as P,n as C,ag as M,x as O}from"./index-8b526734.js";import{u as A,_ as R}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as U,B as k}from"./index-40f1f97e.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as n}from"./useRender-f65ba3eb.js";import{D as r,g as c}from"./dict-5cefafd8.js";const K=[{title:"客户端编号",dataIndex:"clientId",width:200},{title:"客户端密钥",dataIndex:"secret",width:100},{title:"应用名",dataIndex:"name",width:100},{title:"应用图标",dataIndex:"logo",width:120,customRender:({text:e})=>n.renderImg(e)},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>n.renderDict(e,r.COMMON_STATUS)},{title:"访问令牌的有效期",dataIndex:"accessTokenValiditySeconds",width:100,customRender:({text:e})=>n.renderText(e,"秒")},{title:"刷新令牌的有效期",dataIndex:"refreshTokenValiditySeconds",width:100,customRender:({text:e})=>n.renderText(e,"秒")},{title:"授权类型",dataIndex:"authorizedGrantTypes",width:180,customRender:({text:e})=>n.renderTags(e)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>n.renderDate(e)}],Q=[{label:"应用名",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:c(r.COMMON_STATUS)},colProps:{span:8}}],q=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"客户端编号",field:"clientId",required:!0,component:"Input"},{label:"客户端密钥",field:"secret",required:!0,component:"Input"},{label:"应用名",field:"name",required:!0,component:"Input"},{label:"应用图标",field:"logo",required:!0,component:"FileUpload",componentProps:{fileType:"image",maxCount:1}},{label:"应用描述",field:"description",component:"InputTextArea"},{label:"状态",field:"status",component:"Select",componentProps:{options:c(r.COMMON_STATUS)}},{label:"访问令牌的有效期",field:"accessTokenValiditySeconds",required:!0,defaultValue:0,component:"InputNumber"},{label:"刷新令牌的有效期",field:"refreshTokenValiditySeconds",required:!0,defaultValue:0,component:"InputNumber"},{label:"授权类型",field:"authorizedGrantTypes",required:!0,component:"Select",componentProps:{options:c(r.SYSTEM_OAUTH2_GRANT_TYPE,"string"),mode:"multiple"}},{label:"授权范围",field:"scopes",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"自动授权范围",field:"autoApproveScopes",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"可重定向的 URI 地址",field:"redirectUris",required:!0,component:"Select",componentProps:{mode:"tags",options:[]}},{label:"权限",field:"authorities",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"资源",field:"resourceIds",component:"Select",componentProps:{mode:"tags",options:[]}},{label:"附加信息",field:"additionalInformation",component:"InputTextArea"}];function X(e){return s.get({url:"/system/oauth2-client/page",params:e})}function V(e){return s.get({url:"/system/oauth2-client/get?id="+e})}function N(e){return s.post({url:"/system/oauth2-client/create",data:e})}function v(e){return s.put({url:"/system/oauth2-client/update",data:e})}function Z(e){return s.delete({url:"/system/oauth2-client/delete?id="+e})}const ee=b({name:"SystemClientModal",__name:"ClientModal",emits:["success","register"],setup(e,{emit:u}){const{t:i}=_(),{createMessage:p}=O(),a=x(!0),[m,{setFieldsValue:f,resetFields:g,validate:h}]=A({labelWidth:160,baseColProps:{span:24},schemas:q,showActionButtonGroup:!1,actionColOptions:{span:23}}),[I,{setModalProps:l,closeModal:S}]=U(async o=>{if(g(),l({confirmLoading:!1}),a.value=!!o?.isUpdate,t(a)){const d=await V(o.record.id);f({...d})}});async function T(){try{const o=await h();l({confirmLoading:!0}),t(a)?await v(o):await N(o),S(),u("success"),p.success(i("common.saveSuccessText"))}finally{l({confirmLoading:!1})}}return(o,d)=>(w(),y(t(k),M(o.$attrs,{onRegister:t(I),title:a.value?t(i)("action.edit"):t(i)("action.create"),onOk:T}),{default:P(()=>[C(t(R),{onRegister:t(m)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{ee as _,K as c,Z as d,X as g,Q as s};
