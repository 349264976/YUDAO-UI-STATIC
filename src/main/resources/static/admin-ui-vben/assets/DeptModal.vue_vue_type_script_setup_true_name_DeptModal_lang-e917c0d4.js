import{u as w,B as S}from"./index-b9c40b5d.js";import{u as M,a as T}from"./useForm-8fd7b992.js";import{l as D,g as O,u as P,c as U}from"./index-1fa4f246.js";import{g as d}from"./index-385c14ff.js";import"./index-c3c80eae.js";import{u as l}from"./useRender-7b752cf7.js";import{D as r,g as c}from"./dict-411628cd.js";import{a as p,H as C,u as a,o as R,c as F,w as k,e as v,ag as y}from"./index-185fe65d.js";let u=[];async function A(){u=await d()}await A();const W=[{title:"部门名称",dataIndex:"name",width:260,align:"left"},{title:"负责人",dataIndex:"leaderUserId",width:120,customRender:({text:e})=>{if(!e)return"未设置";for(const s of u)if(e===s.id)return s.nickname;return"未知【"+e+"】"}},{title:"排序",dataIndex:"sort",width:60},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>l.renderDict(e,r.COMMON_STATUS)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>l.renderDate(e)}],Y=[{label:"部门名称",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:c(r.COMMON_STATUS)},colProps:{span:8}}],N=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"上级部门",field:"parentId",required:!0,component:"ApiTreeSelect",componentProps:{api:()=>D(),parent:"主类目",fieldNames:{label:"name",key:"id",value:"id"},handleTree:"id"}},{label:"部门名称",field:"name",required:!0,component:"Input"},{label:"岗位顺序",field:"sort",required:!0,component:"InputNumber"},{label:"负责人",field:"leaderUserId",component:"ApiSelect",componentProps:{api:()=>d(),labelField:"nickname",valueField:"id"}},{label:"联系电话",field:"phone",required:!0,rules:[{pattern:/^(?:(?:\+|00)86)?1(?:3[\d]|4[5-79]|5[0-35-9]|6[5-7]|7[0-8]|8[\d]|9[189])\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],component:"Input"},{label:"邮箱",field:"email",required:!0,component:"Input"},{label:"部门状态",field:"status",component:"Select",defaultValue:0,componentProps:{options:c(r.COMMON_STATUS)}}],q=p({name:"DeptModal"}),j=p({...q,emits:["success","register"],setup(e,{emit:s}){const o=C(!0),[m,{setFieldsValue:f,resetFields:g,validate:b}]=M({labelWidth:120,baseColProps:{span:24},schemas:N,showActionButtonGroup:!1,actionColOptions:{span:23}}),[h,{setModalProps:n,closeModal:I}]=w(async t=>{if(g(),n({confirmLoading:!1}),o.value=!!t?.isUpdate,a(o)){const i=await O(t.record.id);f({...i})}});async function _(){try{const t=await b();n({confirmLoading:!0}),a(o)?await P(t):await U(t),I(),s("success")}finally{n({confirmLoading:!1})}}return(t,i)=>(R(),F(a(S),y(t.$attrs,{onRegister:a(h),title:o.value?"编辑":"新增",onOk:_}),{default:k(()=>[v(a(T),{onRegister:a(m)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{j as _,W as c,Y as s};
