import{cm as l,u as _,a as B,c as C,f6 as R,z as T,d$ as y,e0 as k,o as d,h as P,n as p,w as u,k as t,j as F,I as f,l as M,x as z}from"./index-8b526734.js";import{O as E,_ as S}from"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{u as v,_ as A}from"./useTable-33ec4cfa.js";import"./index-ec19b8e7.js";import"./index-7aea77c8.js";import"./index-8629d074.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./index-40f1f97e.js";import"./sortable.esm-f208c0d8.js";import{u as r}from"./useRender-f65ba3eb.js";import"./index-50e4b4b2.js";import"./index-8e6d9858.js";import"./index-47ca6c32.js";import"./get-11175361.js";import"./onMountedOrActivated-13e9417a.js";import"./index-081b541d.js";import"./useRefs-872c0ad6.js";import"./_baseIteratee-625e56a9.js";import"./index-c8286d7f.js";import"./index-42686290.js";import"./useForm-f7dccb87.js";import"./_stringToArray-c38191b3.js";import"./uniqBy-f83999c6.js";import"./index-9e517d44.js";import"./useWindowSizeFn-38cd0f6d.js";import"./RedoOutlined-fa24e892.js";import"./FullscreenOutlined-8b988545.js";import"./eagerComputed-6290a54f.js";import"./fromPairs-e099444b.js";import"./scrollTo-67205127.js";import"./index-fb15648b.js";import"./dict-5cefafd8.js";import"./useSize-5af631ed.js";function D(e){return l.get({url:"/infra/file/page",params:e})}function N(e){return l.delete({url:"/infra/file/delete?id="+e})}const U=[{title:"编号",dataIndex:"id",width:100},{title:"文件名",dataIndex:"name",width:200},{title:"文件 URL",dataIndex:"url",width:180,customRender:({text:e})=>r.renderImg(e)},{title:"文件路径",dataIndex:"path",width:180},{title:"文件大小",dataIndex:"size",width:120,customRender:({text:e})=>{const o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=parseFloat(e),i=Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,i)).toFixed(2)+" "+o[i]}},{title:"文件类型",dataIndex:"type",width:100,customRender:({text:e})=>r.renderTag(e)},{title:"文件内容",dataIndex:"content",width:180,customRender:({text:e})=>r.renderImg(e)},{title:"上传时间",dataIndex:"createTime",width:180,customRender:({text:e})=>r.renderDate(e)}],V=[{label:"文件路径",field:"path",component:"Input",colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],{uploadUrl:$=""}=_();function G(e,o){return l.uploadFile({url:$,onUploadProgress:o},e)}const ye=B({name:"InfraFile",__name:"index",setup(e){const{t:o}=C(),{createMessage:a}=z(),{clipboardRef:i,copiedRef:s}=R(),h=T({Authorization:"Bearer "+y(),"tenant-id":k()}),[g,{reload:m}]=v({title:"文件列表",api:D,columns:U,formConfig:{labelWidth:120,schemas:V},useSearchForm:!0,showTableSetting:!0,showIndexColumn:!1,actionColumn:{width:160,title:o("common.action"),dataIndex:"action",fixed:"right"}});function x(){m()}function I(n){i.value=n.url,t(s)&&a.warning("复制成功")}async function w(n){await N(n.id),a.success(o("common.delSuccessText")),m()}return(n,H)=>(d(),P("div",null,[p(t(A),{onRegister:t(g)},{toolbar:u(()=>[p(t(E),{maxSize:20,maxNumber:10,emptyHidePreview:!0,onChange:x,uploadParams:h.value,api:t(G),class:"my-5",accept:["image/*"]},null,8,["uploadParams","api"])]),bodyCell:u(({column:b,record:c})=>[b.key==="action"?(d(),F(t(S),{key:0,actions:[{icon:t(f).VIEW,label:"复制链接",onClick:I.bind(null,c)},{icon:t(f).DELETE,color:"error",label:t(o)("action.delete"),auth:"infra:file:delete",popConfirm:{title:t(o)("common.delMessage"),placement:"left",confirm:w.bind(null,c)}}]},null,8,["actions"])):M("",!0)]),_:1},8,["onRegister"])]))}});export{ye as default};
