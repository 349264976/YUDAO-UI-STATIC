import{a as w,c as M,z as T,k as t,o as D,j as O,w as P,n as U,ag as C,x as R}from"./index-8b526734.js";import{u as k,_ as v}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as x,B as F}from"./index-40f1f97e.js";import{l as y,g as A,u as L,c as N}from"./index-9e9f35a9.js";import{g as p}from"./index-2d30e53e.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as c}from"./useRender-f65ba3eb.js";import{D as i,g as d}from"./dict-5cefafd8.js";let m=[];async function q(){m=await p()}await q();const te=[{title:"部门名称",dataIndex:"name",width:260,align:"left"},{title:"负责人",dataIndex:"leaderUserId",width:120,customRender:({text:e})=>{if(!e)return"未设置";for(const s of m)if(e===s.id)return s.nickname;return"未知【"+e+"】"}},{title:"排序",dataIndex:"sort",width:60},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>c.renderDict(e,i.COMMON_STATUS)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>c.renderDate(e)}],ae=[{label:"部门名称",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:d(i.COMMON_STATUS)},colProps:{span:8}}],B=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"上级部门",field:"parentId",required:!0,component:"ApiTreeSelect",componentProps:{api:()=>y(),parentLabel:"主类目",fieldNames:{label:"name",key:"id",value:"id"},handleTree:"id"}},{label:"部门名称",field:"name",required:!0,component:"Input"},{label:"岗位顺序",field:"sort",required:!0,defaultValue:0,component:"InputNumber"},{label:"负责人",field:"leaderUserId",component:"ApiSelect",componentProps:{api:()=>p(),labelField:"nickname",valueField:"id"}},{label:"联系电话",field:"phone",required:!0,rules:[{pattern:/^(?:(?:\+|00)86)?1(?:3[\d]|4[5-79]|5[0-35-9]|6[5-7]|7[0-8]|8[\d]|9[189])\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],component:"Input"},{label:"邮箱",field:"email",required:!0,component:"Input"},{label:"部门状态",field:"status",component:"Select",componentProps:{options:d(i.COMMON_STATUS)}}],se=w({name:"DeptModal",__name:"DeptModal",emits:["success","register"],setup(e,{emit:s}){const{t:r}=M(),{createMessage:u}=R(),o=T(!0),[f,{setFieldsValue:g,resetFields:b,validate:h}]=k({labelWidth:120,baseColProps:{span:24},schemas:B,showActionButtonGroup:!1,actionColOptions:{span:23}}),[I,{setModalProps:n,closeModal:S}]=x(async a=>{if(b(),n({confirmLoading:!1}),o.value=!!a?.isUpdate,t(o)){const l=await A(a.record.id);g({...l})}});async function _(){try{const a=await h();n({confirmLoading:!0}),t(o)?await L(a):await N(a),S(),s("success"),u.success(r("common.saveSuccessText"))}finally{n({confirmLoading:!1})}}return(a,l)=>(D(),O(t(F),C(a.$attrs,{onRegister:t(I),title:o.value?t(r)("action.edit"):t(r)("action.create"),onOk:_}),{default:P(()=>[U(t(v),{onRegister:t(f)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{se as _,te as c,ae as s};
