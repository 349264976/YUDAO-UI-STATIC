import{cm as a,a as b,c as w,o as M,j as _,w as x,n as k,k as s,ag as P,x as S}from"./index-8b526734.js";import{u as R,_ as F}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as q,B as y}from"./index-40f1f97e.js";import{f as U}from"./index-6dcbd942.js";import{b as v}from"./index-0c3bd330.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as o}from"./useRender-f65ba3eb.js";const K=[{title:"编号",dataIndex:"id",width:100},{title:"用户标识",dataIndex:"openid",width:180},{title:"昵称",dataIndex:"nickname",width:100},{title:"备注",dataIndex:"remark",width:120},{title:"标签",dataIndex:"tagIds",width:180,customRender:({text:e})=>o.renderTags(e)},{title:"订阅状态",dataIndex:"subscribeStatus",width:180,customRender:({text:e})=>o.renderTag(e===0?"已订阅":"未订阅",e===0?"purple":"orange")},{title:"订阅时间",dataIndex:"subscribeTime",width:180,customRender:({text:e})=>o.renderDate(e)}],i=await U(),Q=[{label:"公众号",field:"accountId",component:"Select",required:!0,defaultValue:i[0].id,componentProps:{options:i,fieldNames:{label:"name",value:"id"}},colProps:{span:8}},{label:"用户标识",field:"openid",component:"Input",colProps:{span:8}},{label:"昵称",field:"nickname",component:"Input",colProps:{span:8}}],A=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"昵称",field:"nickname",required:!0,component:"Input"},{label:"备注",field:"remark",required:!0,component:"Input"},{label:"标签",field:"tagIds",helpMessage:"在微信公众平台（mp.weixin.qq.com）的菜单 [设置与开发 - 公众号设置 - 基本设置] 中能找到「开发者ID(AppID)」",required:!0,defaultValue:[],component:"ApiSelect",componentProps:{api:()=>v(),labelField:"name",valueField:"tagId",mode:"tags"}}];function B(e){return a.put({url:"/mp/user/update",data:e})}function T(e){return a.get({url:"/mp/user/get?id="+e})}function X(e){return a.get({url:"/mp/user/page",params:e})}function Y(e){return a.post({url:"/mp/user/sync?accountId="+e})}const Z=b({name:"MpUserModal",__name:"MpUserModal",emits:["success","register"],setup(e,{emit:l}){const{t:c}=w(),{createMessage:d}=S(),[u,{setFieldsValue:p,resetFields:m,validate:f}]=R({labelWidth:120,baseColProps:{span:24},schemas:A,showActionButtonGroup:!1,actionColOptions:{span:23}}),[g,{setModalProps:n,closeModal:I}]=q(async t=>{m(),n({confirmLoading:!1});const r=await T(t.record.id);p({...r})});async function h(){try{const t=await f();n({confirmLoading:!0}),await B(t),I(),l("success"),d.success(c("common.saveSuccessText"))}finally{n({confirmLoading:!1})}}return(t,r)=>(M(),_(s(y),P(t.$attrs,{onRegister:s(g),title:"编辑",onOk:h}),{default:x(()=>[k(s(F),{onRegister:s(u)},null,8,["onRegister"])]),_:1},16,["onRegister"]))}});export{Z as _,Y as a,K as c,X as g,Q as s};
