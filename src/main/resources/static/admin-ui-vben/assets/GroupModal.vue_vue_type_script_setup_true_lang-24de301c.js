import{cm as a,a as M,c as S,z as T,k as t,o as P,j as x,w as O,n as R,ag as C,x as G}from"./index-8b526734.js";import{u as k,_ as F}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as v,B}from"./index-40f1f97e.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as l}from"./useRender-f65ba3eb.js";import{D as p,g as m}from"./dict-5cefafd8.js";import{g as f}from"./index-2d30e53e.js";let g=[];async function y(){g=await f()}await y();const ee=[{title:"编号",dataIndex:"id",width:100},{title:"组名",dataIndex:"name",width:180},{title:"描述",dataIndex:"description",width:200},{title:"成员",dataIndex:"memberUserIds",width:180,customRender:({record:e,text:c})=>{const s=[];if(c){for(const n of e.memberUserIds){let r=!1;g.forEach(i=>{n===i.id&&(s.push(i.nickname),r=!0)}),r||s.push("未知("+n+")")}return l.renderTags(s)}}},{title:"状态",dataIndex:"status",width:180,customRender:({text:e})=>l.renderDict(e,p.COMMON_STATUS)},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:e})=>l.renderDate(e)}],te=[{label:"组名",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:m(p.COMMON_STATUS)},colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],A=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"组名",field:"name",required:!0,component:"Input"},{label:"描述",field:"description",required:!0,component:"Input"},{label:"成员",field:"memberUserIds",required:!0,component:"ApiTransfer",componentProps:{api:()=>f(),showSearch:!0,labelField:"nickname",valueField:"id"}},{label:"状态",field:"status",component:"Select",componentProps:{options:m(p.COMMON_STATUS)}}];function D(e){return a.post({url:"/bpm/user-group/create",data:e})}function L(e){return a.put({url:"/bpm/user-group/update",data:e})}function se(e){return a.delete({url:"/bpm/user-group/delete?id="+e})}function N(e){return a.get({url:"/bpm/user-group/get?id="+e})}function re(e){return a.get({url:"/bpm/user-group/page",params:e})}const oe=M({name:"BpmGroupModal",__name:"GroupModal",emits:["success","register"],setup(e,{emit:c}){const{t:s}=S(),{createMessage:n}=G(),r=T(!0),[i,{setFieldsValue:h,resetFields:b,validate:w}]=k({labelWidth:120,baseColProps:{span:24},schemas:A,showActionButtonGroup:!1,actionColOptions:{span:23}}),[I,{setModalProps:u,closeModal:U}]=v(async o=>{if(b(),u({confirmLoading:!1}),r.value=!!o?.isUpdate,t(r)){const d=await N(o.record.id);h({...d})}});async function _(){try{const o=await w();u({confirmLoading:!0}),t(r)?await L(o):await D(o),U(),c("success"),n.success(s("common.saveSuccessText"))}finally{u({confirmLoading:!1})}}return(o,d)=>(P(),x(t(B),C(o.$attrs,{onRegister:t(I),title:r.value?t(s)("action.edit"):t(s)("action.create"),onOk:_}),{default:O(()=>[R(t(F),{onRegister:t(i)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{oe as _,ee as c,se as d,re as g,te as s};
