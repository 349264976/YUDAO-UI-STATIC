import{a as _,c as M,z as w,k as e,o as C,j as b,w as P,n as x,ag as T,x as A}from"./index-8b526734.js";import{u as O,_ as R}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as k,B as U}from"./index-40f1f97e.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as i}from"./useRender-f65ba3eb.js";import{D as s,g as l}from"./dict-5cefafd8.js";import{g as D,u as N,c as y}from"./index-aa18a34f.js";const J=[{title:"编号",dataIndex:"id",width:100},{title:"短信签名",dataIndex:"signature",width:180},{title:"渠道编码",dataIndex:"code",width:180,customRender:({text:a})=>i.renderDict(a,s.SYSTEM_SMS_CHANNEL_CODE)},{title:"启用状态",dataIndex:"status",width:180,customRender:({text:a})=>i.renderDict(a,s.COMMON_STATUS)},{title:"备注",dataIndex:"remark",width:180},{title:"短信 API 的账号",dataIndex:"apiKey",width:180},{title:"短信 API 的密钥",dataIndex:"apiSecret",width:180},{title:"短信发送回调 URL",dataIndex:"callbackUrl",width:180},{title:"创建时间",dataIndex:"createTime",width:180,customRender:({text:a})=>i.renderDate(a)}],Q=[{label:"短信签名",field:"signature",component:"Input",colProps:{span:8}},{label:"启用状态",field:"status",component:"Select",componentProps:{options:l(s.COMMON_STATUS)},colProps:{span:8}},{label:"创建时间",field:"createTime",component:"RangePicker",colProps:{span:8}}],E=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"短信签名",field:"signature",required:!0,component:"Input"},{label:"渠道编码",field:"code",component:"Select",required:!0,componentProps:{options:l(s.SYSTEM_SMS_CHANNEL_CODE,"string")}},{label:"启用状态",field:"status",component:"Select",defaultValue:0,componentProps:{options:l(s.COMMON_STATUS)}},{label:"备注",field:"remark",component:"InputTextArea"},{label:"短信 API 的账号",field:"apiKey",required:!0,component:"Input"},{label:"短信 API 的密钥",field:"apiSecret",component:"Input"},{label:"短信发送回调 URL",field:"callbackUrl",component:"Input"}],X=_({name:"SystemSmsChannelModal",__name:"SmsChannelModal",emits:["success","register"],setup(a,{emit:d}){const{t:n}=M(),{createMessage:m}=A(),o=w(!0),[p,{setFieldsValue:u,resetFields:f,validate:S}]=O({labelWidth:120,baseColProps:{span:24},schemas:E,showActionButtonGroup:!1,actionColOptions:{span:23}}),[h,{setModalProps:r,closeModal:g}]=k(async t=>{if(f(),r({confirmLoading:!1}),o.value=!!t?.isUpdate,e(o)){const c=await D(t.record.id);u({...c})}});async function I(){try{const t=await S();r({confirmLoading:!0}),e(o)?await N(t):await y(t),g(),d("success"),m.success(n("common.saveSuccessText"))}finally{r({confirmLoading:!1})}}return(t,c)=>(C(),b(e(U),T(t.$attrs,{onRegister:e(h),title:o.value?e(n)("action.edit"):e(n)("action.create"),onOk:I}),{default:P(()=>[x(e(R),{onRegister:e(p)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{X as _,J as c,Q as s};
