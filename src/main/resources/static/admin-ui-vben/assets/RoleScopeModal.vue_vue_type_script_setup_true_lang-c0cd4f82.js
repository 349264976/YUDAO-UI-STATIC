import{a as M,c as R,z as k,k as a,o as w,j as y,w as n,n as c,ag as b,x as D}from"./index-8b526734.js";import{u as B,_ as F}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as x,B as C}from"./index-40f1f97e.js";import{_ as I}from"./index-ccb32bec.js";import{d as L}from"./role.data-25790bb5.js";import{g as P}from"./index-74c73d6c.js";import{l as $}from"./index-9e9f35a9.js";import{h as N}from"./tree-e6981725.js";import{b as O}from"./index-1b3f13e5.js";const J=M({name:"SystemRoleScopeModal",__name:"RoleScopeModal",emits:["success","register"],setup(T,{emit:l}){const{t:m}=R(),{createMessage:p}=D(),o=k([]),[d,{setFieldsValue:u,resetFields:f,validate:g}]=B({labelWidth:120,baseColProps:{span:24},schemas:L,showActionButtonGroup:!1,actionColOptions:{span:23}}),[_,{setModalProps:t,closeModal:h}]=x(async e=>{if(f(),t({confirmLoading:!1}),a(o).length===0){const s=await $();o.value=N(s,"id")}const r=await P(e.record.id);r.roleId=e.record.id,u({...r})});async function S(){try{const e=await g();t({confirmLoading:!0}),await O(e),h(),l("success"),p.success(m("common.saveSuccessText"))}finally{t({confirmLoading:!1})}}return(e,r)=>(w(),y(a(C),b(e.$attrs,{onRegister:a(_),title:"编辑角色数据权限",onOk:S}),{default:n(()=>[c(a(F),{onRegister:a(d)},{dataScopeDeptIds:n(({model:s,field:i})=>[c(a(I),{value:s[i],"onUpdate:value":v=>s[i]=v,treeData:o.value,fieldNames:{title:"name",key:"id"},checkStrictly:!1,checkable:"",toolbar:"",title:"部门分配"},null,8,["value","onUpdate:value","treeData"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister"]))}});export{J as _};
