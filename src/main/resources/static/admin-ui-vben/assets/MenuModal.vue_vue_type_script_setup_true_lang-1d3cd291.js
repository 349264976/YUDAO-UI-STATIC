import{a as T,c as b,z as y,k as t,o as I,j as _,w as P,n as C,ag as N,x as U}from"./index-8b526734.js";import{u as k,_ as O}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as x,B}from"./index-40f1f97e.js";import{l as E,g as R,u as v,c as A}from"./index-a2b632f4.js";import"./index-ec19b8e7.js";import"./index-d2d20fb4.js";import"./tree-e6981725.js";import"./index-03ea37ad.js";import"./index-3e87b811.js";import"./index-c8168e27.js";import"./sortable.esm-f208c0d8.js";import{u as l}from"./useRender-f65ba3eb.js";import{D as s,g as p}from"./dict-5cefafd8.js";import{S as o}from"./systemEnum-4af82c45.js";const Z=[{title:"菜单名称",dataIndex:"name",width:250,align:"left"},{title:"菜单类型",dataIndex:"type",width:80,customRender:({text:e})=>l.renderDict(e,s.SYSTEM_MENU_TYPE)},{title:"图标",dataIndex:"icon",width:60,customRender:({record:e})=>l.renderIcon(e.icon)},{title:"排序",dataIndex:"sort",width:60},{title:"权限标识",dataIndex:"permission",width:140},{title:"组件路径",dataIndex:"component",width:140},{title:"状态",dataIndex:"status",width:80,customRender:({text:e})=>l.renderDict(e,s.COMMON_STATUS)}],ee=[{label:"菜单名称",field:"name",component:"Input",colProps:{span:8}},{label:"状态",field:"status",component:"Select",componentProps:{options:p(s.COMMON_STATUS)},colProps:{span:8}}],q=[{label:"编号",field:"id",show:!1,component:"Input"},{label:"上级菜单",field:"parentId",required:!0,component:"ApiTreeSelect",componentProps:{api:()=>E(),parentLabel:"主类目",fieldNames:{label:"name",key:"id",value:"id"},handleTree:"id"}},{label:"菜单类型",field:"type",required:!0,defaultValue:"0",component:"RadioButtonGroup",componentProps:{options:p(s.SYSTEM_MENU_TYPE)},colProps:{lg:24,md:24}},{label:"菜单名称",field:"name",required:!0,component:"Input"},{label:"菜单图标",field:"icon",component:"IconPicker",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"显示排序",field:"sort",required:!0,component:"InputNumber",defaultValue:0},{label:"路由地址",field:"path",required:!0,component:"Input",helpMessage:"访问的路由地址，如：`user`。如需外网地址时，则以 `http(s)://` 开头",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"权限标识",field:"permission",component:"Input",helpMessage:'Controller 方法上的权限字符，如：@PreAuthorize(`@ss.hasPermission("system:user:list")`)',ifShow:({values:e})=>e.type!==o.DIR},{label:"组件路径",field:"component",component:"Input",helpMessage:"例如：system/user/index",ifShow:({values:e})=>e.type===o.MENU},{label:"组件名称",field:"componentName",component:"Input",helpMessage:"例如：SystemUser",ifShow:({values:e})=>e.type===o.MENU},{label:"菜单状态",field:"status",required:!0,component:"RadioButtonGroup",helpMessage:"选择停用时，路由将不会出现在侧边栏，也不能被访问",componentProps:{options:p(s.COMMON_STATUS)}},{label:"显示状态",field:"visible",component:"Switch",componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"},helpMessage:"选择隐藏时，路由将不会出现在侧边栏，但仍然可以访问",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"总是显示",field:"alwaysShow",component:"Switch",componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"},helpMessage:"选择不是时，当该菜单只有一个子菜单时，不展示自己，直接展示子菜单",ifShow:({values:e})=>e.type!==o.BUTTON},{label:"是否缓存",field:"keepAlive",component:"Switch",componentProps:{checkedChildren:"缓存",unCheckedChildren:"不缓存"},helpMessage:"选择缓存时，则会被 `keep-alive` 缓存，必须填写「组件名称」字段",ifShow:({values:e})=>e.type===o.MENU}],te=T({name:"SystemMenuModal",__name:"MenuModal",emits:["success","register"],setup(e,{emit:d}){const{t:i}=b(),{createMessage:m}=U(),a=y(!0),[u,{setFieldsValue:h,resetFields:f,validate:M}]=k({labelWidth:120,baseColProps:{span:24},schemas:q,showActionButtonGroup:!1,actionColOptions:{span:23}}),[S,{setModalProps:r,closeModal:g}]=x(async n=>{if(f(),r({confirmLoading:!1}),a.value=!!n?.isUpdate,t(a)){const c=await R(n.record.id);h({...c})}});async function w(){try{const n=await M();r({confirmLoading:!0}),t(a)?await v(n):await A(n),g(),d("success"),m.success(i("common.saveSuccessText"))}finally{r({confirmLoading:!1})}}return(n,c)=>(I(),_(t(B),N(n.$attrs,{onRegister:t(S),title:a.value?t(i)("action.edit"):t(i)("action.create"),onOk:w}),{default:P(()=>[C(t(O),{onRegister:t(u)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{te as _,Z as c,ee as s};
