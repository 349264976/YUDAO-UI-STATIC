import{eS as je,eT as Pe,eU as Ue,eV as Re,eW as He,eX as Ve,eY as Ye,eZ as re,e_ as Xe,e$ as We,aG as ze,f0 as qe,a as le,z as X,aA as Ge,c as Je,f as I,aM as Ze,R as $,o as N,h as P,k as r,ax as Qe,l as M,j as Z,w as U,v as ie,t as oe,eb as et,q as de,n as S,f1 as tt,ai as Y,F as W,r as nt,ah as lt,aI as st,aJ as ct,f2 as at,af as z,aC as rt,dK as it,bx as ot,bb as dt,bw as te,f3 as ue,C as ve,Q as ut,T as Ce,cP as Ke,dZ as ht,d_ as ft,az as yt,B as he,al as V,cT as pt,c3 as kt,as as Q,f4 as gt,eF as St,aw as R,f5 as xt,e8 as bt,bm as vt,D as fe,E as ye,S as Ct,ag as Kt,eE as pe,c$ as Lt,aF as ke,cQ as _t}from"./index-8b526734.js";import{f as At}from"./fromPairs-e099444b.js";import{b as Et}from"./tree-e6981725.js";import{D as mt}from"./index-c8168e27.js";import{g as Tt}from"./get-11175361.js";var wt=200;function Bt(e,l,d,y){var _=-1,g=Re,t=!0,f=e.length,x=[],v=l.length;if(!f)return x;d&&(l=je(l,Pe(d))),y?(g=He,t=!1):l.length>=wt&&(g=Ve,t=!1,l=new Ue(l));e:for(;++_<f;){var k=e[_],a=d==null?k:d(k);if(k=y||k!==0?k:0,t&&a===a){for(var n=v;n--;)if(l[n]===a)continue e;x.push(k)}else g(l,a,y)||x.push(k)}return x}var Nt=Ye(function(e,l){return re(e)?Bt(e,Xe(l,1,re,!0)):[]});const It=Nt;function ne(e,l){return l?typeof l=="string"?` ${e}--${l}`:Array.isArray(l)?l.reduce((d,y)=>d+ne(e,y),""):Object.keys(l).reduce((d,y)=>d+(l[y]?ne(e,y):""),""):""}function Dt(e){return(l,d)=>(l&&typeof l!="string"&&(d=l,l=""),l=l?`${e}__${l}`:e,`${l}${ne(l,d)}`)}function Le(e){return[Dt(`${We}-${e}`)]}const ge=Symbol(),Se=Symbol();function Ft(e,l){if(!ze(e)||e[Se])return e;const{values:d,required:y,default:_,type:g,validator:t}=e,f=d||t?x=>{let v=!1,k=[];if(d&&(k=[...d,_],v||=k.includes(x)),t&&(v||=t(x)),!v&&k.length>0){const a=[...new Set(k)].map(n=>JSON.stringify(n)).join(", ");qe(`Invalid prop: validation failed${l?` for prop "${l}"`:""}. Expected one of [${a}], got value ${JSON.stringify(x)}.`)}return v}:void 0;return{type:typeof g=="object"&&g&&Object.getOwnPropertySymbols(g).includes(ge)?g[ge]:g,required:!!y,default:_,validator:f,[Se]:!0}}const Mt=e=>At(Object.entries(e).map(([l,d])=>[l,Ft(d,l)]));var m=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(m||{});const $t=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ot=Mt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,showStrictlyButton:{type:Boolean,default:!0},fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),jt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Pt=le({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},showStrictlyButton:{type:Boolean,default:!0},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:l}){const d=e,y=X(""),[_]=Le("tree-header"),g=Ge(),{t}=Je(),f=I(()=>["mr-1","w-full",{"ml-5":g.headerTitle||d.title}]),x=I(()=>{const{checkable:n,showStrictlyButton:c}=d,i=[{label:t("component.tree.expandAll"),value:m.EXPAND_ALL},{label:t("component.tree.unExpandAll"),value:m.UN_EXPAND_ALL,divider:n}],h=[{label:t("component.tree.selectAll"),value:m.SELECT_ALL},{label:t("component.tree.unSelectAll"),value:m.UN_SELECT_ALL,divider:n},...i];return c&&h.push({label:t("component.tree.checkStrictly"),value:m.CHECK_STRICTLY},{label:t("component.tree.checkUnStrictly"),value:m.CHECK_UN_STRICTLY}),n?h:i});function v(n){const{key:c}=n;switch(c){case m.SELECT_ALL:d.checkAll?.(!0);break;case m.UN_SELECT_ALL:d.checkAll?.(!1);break;case m.EXPAND_ALL:d.expandAll?.(!0);break;case m.UN_EXPAND_ALL:d.expandAll?.(!1);break;case m.CHECK_STRICTLY:l("strictly-change",!1);break;case m.CHECK_UN_STRICTLY:l("strictly-change",!0);break}}function k(n){l("search",n)}const a=Ze(k,200);return $(()=>y.value,n=>{a(n)}),$(()=>d.searchText,n=>{n!==y.value&&(y.value=n)}),(n,c)=>(N(),P("div",{class:de([r(_)(),"flex px-2 py-1.5 items-center"])},[r(g).headerTitle?Qe(n.$slots,"headerTitle",{key:0}):M("",!0),!r(g).headerTitle&&n.title?(N(),Z(r(et),{key:1,helpMessage:n.helpMessage},{default:U(()=>[ie(oe(n.title),1)]),_:1},8,["helpMessage"])):M("",!0),n.search||n.toolbar?(N(),P("div",jt,[n.search?(N(),P("div",{key:0,class:de(f.value)},[S(r(tt),{placeholder:r(t)("common.searchText"),allowClear:"",value:y.value,"onUpdate:value":c[0]||(c[0]=i=>y.value=i)},null,8,["placeholder","value"])],2)):M("",!0),n.toolbar?(N(),Z(r(it),{key:1,onClick:c[1]||(c[1]=rt(()=>{},["prevent"]))},{overlay:U(()=>[S(r(Y),{onClick:v},{default:U(()=>[(N(!0),P(W,null,nt(x.value,i=>(N(),P(W,{key:i.value},[S(r(lt),st(ct({key:i.value})),{default:U(()=>[ie(oe(i.label),1)]),_:2},1040),i.divider?(N(),Z(r(at),{key:0})):M("",!0)],64))),128))]),_:1})]),default:U(()=>[S(r(z),{icon:"ion:ellipsis-vertical"})]),_:1})):M("",!0)])):M("",!0)],2))}}),Ut=({icon:e})=>e?ot(e)?dt(z,{icon:e,class:"mr-1"}):z:null;function Rt(e,l){function d(a){const n=[],c=a||r(e),{key:i,children:h}=r(l);if(!h||!i)return n;for(let u=0;u<c.length;u++){const o=c[u];n.push(o[i]);const b=o[h];b&&b.length&&n.push(...d(b))}return n}function y(a){const n=[],c=a||r(e),{key:i,children:h}=r(l);if(!h||!i)return n;for(let u=0;u<c.length;u++){const o=c[u];o.disabled!==!0&&o.selectable!==!1&&n.push(o[i]);const b=o[h];b&&b.length&&n.push(...y(b))}return n}function _(a,n){const c=[],i=n||r(e),{key:h,children:u}=r(l);if(!u||!h)return c;for(let o=0;o<i.length;o++){const b=i[o],E=b[u];a===b[h]?(c.push(b[h]),E&&E.length&&c.push(...d(E))):E&&E.length&&c.push(..._(a,E))}return c}function g(a,n,c){if(!a)return;const i=c||r(e),{key:h,children:u}=r(l);if(!(!u||!h))for(let o=0;o<i.length;o++){const b=i[o],E=b[u];if(b[h]===a){i[o]={...i[o],...n};break}else E&&E.length&&g(a,n,b[u])}}function t(a=1,n,c=1){if(!a)return[];const i=[],h=n||r(e)||[];for(let u=0;u<h.length;u++){const o=h[u],{key:b,children:E}=r(l),q=b?o[b]:"",O=E?o[E]:[];i.push(q),O&&O.length&&c<a&&(c+=1,i.push(...t(a,O,c)))}return i}function f({parentKey:a=null,node:n,push:c="push"}){const i=te(r(e));if(!a){i[c](n),e.value=i;return}const{key:h,children:u}=r(l);!u||!h||(ue(i,o=>{if(o[h]===a)return o[u]=o[u]||[],o[u][c](n),!0}),e.value=i)}function x({parentKey:a=null,list:n,push:c="push"}){const i=te(r(e));if(!(!n||n.length<1))if(a){const{key:h,children:u}=r(l);if(!u||!h)return;ue(i,o=>{if(o[h]===a){o[u]=o[u]||[];for(let b=0;b<n.length;b++)o[u][c](n[b]);return e.value=i,!0}})}else for(let h=0;h<n.length;h++)i[c](n[h])}function v(a,n){if(!a)return;const c=n||r(e),{key:i,children:h}=r(l);if(!(!h||!i))for(let u=0;u<c.length;u++){const o=c[u],b=o[h];if(o[i]===a){c.splice(u,1);break}else b&&b.length&&v(a,o[h])}}function k(a,n,c){if(!a&&a!==0)return null;const i=n||r(e),{key:h,children:u}=r(l);if(h)return i.forEach(o=>{if(c?.key||c?.key===0)return c;if(o[h]===a){c=o;return}o[u]&&o[u].length&&(c=k(a,o[u],c))}),c||null}return{deleteNodeByKey:v,insertNodeByKey:f,insertNodesByKey:x,filterByLevel:t,updateNodeByKey:g,getAllKeys:d,getChildrenKeys:_,getEnabledKeys:y,getSelectedNode:k}}function Ht(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ke(e)}const ee="context-menu",Vt={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},xe=e=>{const{item:l}=e;return S("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,l)},[e.showIcon&&l.icon&&S(z,{class:"mr-2",icon:l.icon},null),S("span",null,[l.label])])},Yt=le({name:"ContextMenu",props:Vt,setup(e){const l=X(null),d=X(!1),y=I(()=>{const{axis:t,items:f,styles:x,width:v}=e,{x:k,y:a}=t||{x:0,y:0},n=(f||[]).length*40,c=v,i=document.body,h=i.clientWidth<k+c?k-c:k,u=i.clientHeight<a+n?a-n:a;return{...x,position:"absolute",width:`${v}px`,left:`${h+1}px`,top:`${u+1}px`,zIndex:9999}});ve(()=>{ut(()=>d.value=!0)}),Ce(()=>{const t=r(l);t&&document.body.removeChild(t)});function _(t,f){const{handler:x,disabled:v}=t;v||(d.value=!1,f?.stopPropagation(),f?.preventDefault(),x?.())}function g(t){return t.filter(x=>!x.hidden).map(x=>{const{disabled:v,label:k,children:a,divider:n=!1}=x,c={item:x,handler:_,showIcon:e.showIcon};return!a||a.length===0?S(W,null,[S(Y.Item,{disabled:v,class:`${ee}__item`,key:k},{default:()=>[S(xe,c,null)]}),n?S(mt,{key:`d-${k}`},null):null]):r(d)?S(Y.SubMenu,{key:k,disabled:v,popupClassName:`${ee}__popup`},{title:()=>S(xe,c,null),default:()=>g(a)}):null})}return()=>{let t;if(!r(d))return null;const{items:f}=e;return S("div",{class:ee},[S(Y,{inlineIndent:12,mode:"vertical",ref:l,style:r(y)},Ht(t=g(f))?t:{default:()=>[t]})])}}});const D={domList:[],resolve:()=>{}},Xt=function(e){const{event:l}=e||{};if(l&&l?.preventDefault(),!!ht)return new Promise(d=>{const y=document.body,_=document.createElement("div"),g={};e.styles&&(g.styles=e.styles),e.items&&(g.items=e.items),e.event&&(g.customEvent=l,g.axis={x:l.clientX,y:l.clientY});const t=S(Yt,g);ft(t,_);const f=function(){D.resolve("")};D.domList.push(_);const x=function(){D.domList.forEach(v=>{try{v&&y.removeChild(v)}catch{}}),y.removeEventListener("click",f),y.removeEventListener("scroll",f)};D.resolve=function(v){x(),d(v)},x(),y.appendChild(_),y.addEventListener("click",f),y.addEventListener("scroll",f)})},be=function(){D&&(D.resolve(""),D.domList=[])};function Wt(e=!0){return yt()&&e&&Ce(()=>{be()}),[Xt,be]}function zt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ke(e)}const en=le({name:"BasicTree",inheritAttrs:!1,props:Ot,emits:$t,setup(e,{attrs:l,slots:d,emit:y,expose:_}){const[g]=Le("tree"),t=he({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),f=he({startSearch:!1,searchText:"",searchData:[]}),x=X([]),[v]=Wt(),k=I(()=>{const{fieldNames:s}=e;return{children:"children",title:"title",key:"key",...s}}),a=I(()=>{let s={blockNode:!0,...l,...e,expandedKeys:t.expandedKeys,selectedKeys:t.selectedKeys,checkedKeys:t.checkedKeys,checkStrictly:t.checkStrictly,fieldNames:r(k),"onUpdate:expandedKeys":p=>{t.expandedKeys=p,y("update:expandedKeys",p)},"onUpdate:selectedKeys":p=>{t.selectedKeys=p,y("update:selectedKeys",p)},onCheck:(p,L)=>{let K=V(t.checkedKeys);if(pt(K)&&f.startSearch){const A=L.node.eventKey;K=It(K,q(A)),L.checked&&K.push(A),t.checkedKeys=K}else t.checkedKeys=p;const C=V(t.checkedKeys);y("update:value",C),y("check",t.checkStrictly?C.checked:C,L)},onRightClick:Ee};return kt(s,"treeData","class")}),n=I(()=>f.startSearch?f.searchData:r(x)),c=I(()=>!n.value||n.value.length===0),{deleteNodeByKey:i,insertNodeByKey:h,insertNodesByKey:u,filterByLevel:o,updateNodeByKey:b,getAllKeys:E,getChildrenKeys:q,getEnabledKeys:O,getSelectedNode:_e}=Rt(x,k);function Ae(s,p){return!p&&e.renderIcon&&Q(e.renderIcon)?e.renderIcon(s):p}async function Ee({event:s,node:p}){const{rightMenuList:L=[],beforeRightClick:K}=e;let C={event:s,items:[]};if(K&&Q(K)){let A=await K(p,s);Array.isArray(A)?C.items=A:Object.assign(C,A)}else C.items=L;C.items?.length&&(C.items=C.items.filter(A=>!A.hidden),v(C))}function H(s){t.expandedKeys=s}function me(){return t.expandedKeys}function se(s){t.selectedKeys=s}function Te(){return t.selectedKeys}function ce(s){t.checkedKeys=s}function we(){return t.checkedKeys}function ae(s){t.checkedKeys=s?O():[],y("check",t.checkedKeys,[])}function G(s){t.expandedKeys=s?E():[]}function Be(s){t.checkStrictly=s}$(()=>e.searchValue,s=>{s!==f.searchText&&(f.searchText=s)},{immediate:!0}),$(()=>e.treeData,s=>{s&&J(f.searchText)});function J(s){if(s!==f.searchText&&(f.searchText=s),y("update:searchValue",s),!s){f.startSearch=!1;return}const{filterFn:p,checkable:L,expandOnSearch:K,checkOnSearch:C,selectedOnSearch:A}=r(e);f.startSearch=!0;const{title:j,key:F}=r(k),w=[];if(f.searchData=gt(r(x),T=>{const B=p?p(s,T,r(k)):T[j]?.includes(s)??!1;return B&&w.push(T[F]),B},r(k)),K){const T=St(f.searchData).map(B=>B[F]);T&&T.length&&H(T)}C&&L&&w.length&&ce(w),A&&w.length&&se(w)}function Ne(s,p){if(!(!e.clickRowToExpand||!p||p.length===0))if(!t.expandedKeys.includes(s))H([...t.expandedKeys,s]);else{const L=[...t.expandedKeys],K=L.findIndex(C=>C===s);K!==-1&&L.splice(K,1),H(L)}}R(()=>{x.value=e.treeData}),ve(()=>{const s=parseInt(e.defaultExpandLevel);s>0?t.expandedKeys=o(s):e.defaultExpandAll&&G(!0)}),R(()=>{t.expandedKeys=e.expandedKeys}),R(()=>{t.selectedKeys=e.selectedKeys}),R(()=>{t.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{t.checkedKeys=V(e.value||[])},{immediate:!0}),$(()=>t.checkedKeys,()=>{const s=V(t.checkedKeys);y("update:value",s),y("change",s)}),R(()=>{t.checkStrictly=e.checkStrictly});const Ie={setExpandedKeys:H,getExpandedKeys:me,setSelectedKeys:se,getSelectedKeys:Te,setCheckedKeys:ce,getCheckedKeys:we,insertNodeByKey:h,insertNodesByKey:u,deleteNodeByKey:i,updateNodeByKey:b,getSelectedNode:_e,checkAll:ae,expandAll:G,filterByLevel:s=>{t.expandedKeys=o(s)},setSearchValue:s=>{J(s)},getSearchValue:()=>f.searchText};function De(s){const{actionList:p}=e;if(!(!p||p.length===0))return p.map((L,K)=>{let C=!0;return Q(L.show)?C=L.show?.(s):ke(L.show)&&(C=L.show),C?S("span",{key:K,class:g("action")},[L.render(s)]):null})}const Fe=I(()=>{const s=te(n.value);return xt(s,(p,L)=>{const K=f.searchText,{highlight:C}=r(e),{title:A,key:j,children:F}=r(k),w=Ae(p,p.icon),T=Tt(p,A),B=K?T.indexOf(K):-1,Me=f.startSearch&&!Lt(K)&&C&&B!==-1,$e=`color: ${ke(C)?"#f50":C}`,Oe=Me?S("span",{class:r(a)?.blockNode?`${g("content")}`:""},[S("span",null,[T.slice(0,B)]),S("span",{style:$e},[K]),S("span",null,[T.slice(B+K.length)])]):T;return p[A]=S("span",{class:`${g("title")} pl-2`,onClick:Ne.bind(null,p[j],p[F])},[d?.title?_t(d,"title",p):S(W,null,[w&&S(Ut,{icon:w},null),Oe,S("span",{class:g("actions")},[De(p)])])]),p}),s});return _(Ie),()=>{let s;const{title:p,helpMessage:L,toolbar:K,search:C,checkable:A,showStrictlyButton:j}=e,F=p||K||C||d.headerTitle,w={height:"calc(100% - 38px)"};return S("div",{class:[g(),"h-full",l.class]},[F&&S(Pt,{checkable:A,checkAll:ae,expandAll:G,title:p,search:C,toolbar:K,showStrictlyButton:j,helpMessage:L,onStrictlyChange:Be,onSearch:J,searchText:f.searchText},zt(s=bt(d))?s:{default:()=>[s]}),S(vt,{wrapperClassName:r(e.treeWrapperClassName),spinning:r(e.loading),tip:"加载中..."},{default:()=>[fe(S(Ct,{style:w},{default:()=>[S(Et,Kt(r(a),{showIcon:!1,treeData:Fe.value}),null)]}),[[ye,!r(c)]]),fe(S(pe,{image:pe.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ye,r(c)]])]})])}}});export{en as _,Bt as b};
