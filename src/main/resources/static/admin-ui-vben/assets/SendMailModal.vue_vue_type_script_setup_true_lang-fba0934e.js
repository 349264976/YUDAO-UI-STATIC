import{a as x,B as k}from"./index-40f1f97e.js";import{u as P,_ as R}from"./useForm-f7dccb87.js";import"./BasicForm.vue_vue_type_style_index_0_lang-42e5fba8.js";import{a as C,o as $,j as v,w as V,n as K,k as t,ag as L,x as O}from"./index-8b526734.js";import{b as j,k as l,s as E}from"./template.data-bc687248.js";const A=C({name:"SendMailModal",__name:"SendMailModal",setup(I){const[d,{setFieldsValue:m,getFieldsValue:p,validateFields:u,resetFields:f,clearValidate:h,appendSchemaByField:g,removeSchemaByField:y}]=P({labelWidth:120,schemas:j,baseColProps:{span:24},showSubmitButton:!1,showResetButton:!1});let o=[];const[w,{changeLoading:_,changeOkLoading:M,closeModal:F}]=x(async e=>{await r();const s=[];e.params.forEach(a=>{const n=l+a,i={field:n,label:`参数{${a}} `,component:"Input",componentProps:{placeholder:`输入{${a}}`},required:!0};s.push(i),o.push(n)}),m(e),g(s,void 0)});function c(e){M(e),_(e)}async function S(){await y(o),o=[]}const{createMessage:b}=O(),B=async()=>{try{c(!0),await u();const e=p(),s={mail:e.mail,templateCode:e.code,templateParams:{}};Object.keys(e).forEach(a=>{if(["mail","code","content"].includes(a))return;const i=a.split(l)[1];s.templateParams[i]=e[a]}),await E(s),b.success(`发送邮件到[${e.mail}]成功`),F()}catch{}finally{c(!1)}};async function r(){await S(),await f(),await h()}return(e,s)=>($(),v(t(k),L(e.$attrs,{title:"发送邮件",onRegister:t(w),onOk:B,onCancel:r,width:"600px"}),{default:V(()=>[K(t(R),{onRegister:t(d)},null,8,["onRegister"])]),_:1},16,["onRegister"]))}});export{A as _};
